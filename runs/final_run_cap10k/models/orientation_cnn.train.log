[logging] tee enabled log_file=/Users/helios/rotation-detection/runs/final_run_cap10k/models/orientation_cnn.train.log
[train] checkpoint=/Users/helios/rotation-detection/runs/final_run_cap10k/models/orientation_cnn.pt
[train] start memory {'rss_mb': 47.359375, 'ru_maxrss_mb': 47.375, 'py_current_mb': 0.0, 'py_peak_mb': 0.0, 'torch_allocated_mb': None, 'torch_reserved_mb': None, 'torch_mps_driver_mb': None}
[train] data_sampling class_balance=uniform split_strategy=document_page_weighted min_val_docs=8 min_test_docs=8
[train] rows train=10797 val=1239
[train] init memory rss_mb=418.8 ru_maxrss_mb=418.8 py_current_mb=122.6 py_peak_mb=122.9 torch_allocated_mb=2.9 torch_mps_driver_mb=48.5
[train] epoch=001:   0%|          | 0/43 [00:00<?, ?batch/s][train] epoch=001:   0%|          | 0/43 [00:12<?, ?batch/s, acc=0.2344, loss=1.4117][train] epoch=001:   2%|▏         | 1/43 [00:12<08:36, 12.31s/batch, acc=0.2344, loss=1.4117][train] epoch=001:   2%|▏         | 1/43 [00:21<08:36, 12.31s/batch, acc=0.2969, loss=1.4000][train] epoch=001:   5%|▍         | 2/43 [00:21<07:14, 10.59s/batch, acc=0.2969, loss=1.4000][train] epoch=001:   5%|▍         | 2/43 [00:32<07:14, 10.59s/batch, acc=0.3854, loss=1.3231][train] epoch=001:   7%|▋         | 3/43 [00:32<06:58, 10.46s/batch, acc=0.3854, loss=1.3231][train] epoch=001:   7%|▋         | 3/43 [00:45<06:58, 10.46s/batch, acc=0.4131, loss=1.2727][train] epoch=001:   9%|▉         | 4/43 [00:45<07:37, 11.73s/batch, acc=0.4131, loss=1.2727][train] epoch=001:   9%|▉         | 4/43 [00:58<07:37, 11.73s/batch, acc=0.4367, loss=1.2238][train] epoch=001 batch=5/43 loss=1.2238 acc=0.4367 rss_mb=1596.3 ru_maxrss_mb=1596.3 py_current_mb=122.8 py_peak_mb=316.4 torch_allocated_mb=232.3 torch_mps_driver_mb=4676.1
[train] epoch=001:  12%|█▏        | 5/43 [00:58<07:45, 12.24s/batch, acc=0.4367, loss=1.2238][train] epoch=001:  12%|█▏        | 5/43 [01:10<07:45, 12.24s/batch, acc=0.4505, loss=1.1890][train] epoch=001:  14%|█▍        | 6/43 [01:10<07:27, 12.08s/batch, acc=0.4505, loss=1.1890][train] epoch=001:  14%|█▍        | 6/43 [01:22<07:27, 12.08s/batch, acc=0.4682, loss=1.1504][train] epoch=001:  16%|█▋        | 7/43 [01:22<07:12, 12.03s/batch, acc=0.4682, loss=1.1504][train] epoch=001:  16%|█▋        | 7/43 [01:33<07:12, 12.03s/batch, acc=0.4810, loss=1.1324][train] epoch=001:  19%|█▊        | 8/43 [01:33<06:47, 11.65s/batch, acc=0.4810, loss=1.1324][train] epoch=001:  19%|█▊        | 8/43 [01:45<06:47, 11.65s/batch, acc=0.4896, loss=1.1113][train] epoch=001:  21%|██        | 9/43 [01:45<06:37, 11.70s/batch, acc=0.4896, loss=1.1113][train] epoch=001:  21%|██        | 9/43 [01:57<06:37, 11.70s/batch, acc=0.4898, loss=1.0977][train] epoch=001 batch=10/43 loss=1.0977 acc=0.4898 rss_mb=1596.6 ru_maxrss_mb=1596.6 py_current_mb=122.8 py_peak_mb=316.4 torch_allocated_mb=232.3 torch_mps_driver_mb=4676.1
[train] epoch=001:  23%|██▎       | 10/43 [01:57<06:37, 12.03s/batch, acc=0.4898, loss=1.0977][train] epoch=001:  23%|██▎       | 10/43 [02:11<06:37, 12.03s/batch, acc=0.4996, loss=1.0843][train] epoch=001:  26%|██▌       | 11/43 [02:11<06:35, 12.37s/batch, acc=0.4996, loss=1.0843][train] epoch=001:  26%|██▌       | 11/43 [02:23<06:35, 12.37s/batch, acc=0.5029, loss=1.0696][train] epoch=001:  28%|██▊       | 12/43 [02:23<06:19, 12.24s/batch, acc=0.5029, loss=1.0696][train] epoch=001:  28%|██▊       | 12/43 [02:36<06:19, 12.24s/batch, acc=0.5120, loss=1.0550][train] epoch=001:  30%|███       | 13/43 [02:36<06:19, 12.66s/batch, acc=0.5120, loss=1.0550][train] epoch=001:  30%|███       | 13/43 [02:46<06:19, 12.66s/batch, acc=0.5193, loss=1.0453][train] epoch=001:  33%|███▎      | 14/43 [02:46<05:42, 11.80s/batch, acc=0.5193, loss=1.0453][train] epoch=001:  33%|███▎      | 14/43 [02:57<05:42, 11.80s/batch, acc=0.5289, loss=1.0359][train] epoch=001 batch=15/43 loss=1.0359 acc=0.5289 rss_mb=1604.7 ru_maxrss_mb=1604.7 py_current_mb=122.8 py_peak_mb=316.4 torch_allocated_mb=232.3 torch_mps_driver_mb=4676.1
[train] epoch=001:  35%|███▍      | 15/43 [02:57<05:27, 11.70s/batch, acc=0.5289, loss=1.0359][train] epoch=001:  35%|███▍      | 15/43 [03:09<05:27, 11.70s/batch, acc=0.5381, loss=1.0250][train] epoch=001:  37%|███▋      | 16/43 [03:09<05:11, 11.55s/batch, acc=0.5381, loss=1.0250][train] epoch=001:  37%|███▋      | 16/43 [03:22<05:11, 11.55s/batch, acc=0.5434, loss=1.0161][train] epoch=001:  40%|███▉      | 17/43 [03:22<05:11, 11.99s/batch, acc=0.5434, loss=1.0161][train] epoch=001:  40%|███▉      | 17/43 [03:33<05:11, 11.99s/batch, acc=0.5506, loss=1.0088][train] epoch=001:  42%|████▏     | 18/43 [03:33<04:58, 11.93s/batch, acc=0.5506, loss=1.0088][train] epoch=001:  42%|████▏     | 18/43 [03:44<04:58, 11.93s/batch, acc=0.5580, loss=1.0026][train] epoch=001:  44%|████▍     | 19/43 [03:44<04:33, 11.38s/batch, acc=0.5580, loss=1.0026][train] epoch=001:  44%|████▍     | 19/43 [03:55<04:33, 11.38s/batch, acc=0.5652, loss=0.9944][train] epoch=001 batch=20/43 loss=0.9944 acc=0.5652 rss_mb=1607.2 ru_maxrss_mb=1607.2 py_current_mb=122.8 py_peak_mb=316.4 torch_allocated_mb=232.3 torch_mps_driver_mb=4676.1
[train] epoch=001:  47%|████▋     | 20/43 [03:55<04:19, 11.28s/batch, acc=0.5652, loss=0.9944][train] epoch=001:  47%|████▋     | 20/43 [04:08<04:19, 11.28s/batch, acc=0.5720, loss=0.9859][train] epoch=001:  49%|████▉     | 21/43 [04:08<04:20, 11.86s/batch, acc=0.5720, loss=0.9859][train] epoch=001:  49%|████▉     | 21/43 [04:20<04:20, 11.86s/batch, acc=0.5772, loss=0.9823][train] epoch=001:  51%|█████     | 22/43 [04:20<04:11, 11.98s/batch, acc=0.5772, loss=0.9823][train] epoch=001:  51%|█████     | 22/43 [04:30<04:11, 11.98s/batch, acc=0.5827, loss=0.9751][train] epoch=001:  53%|█████▎    | 23/43 [04:30<03:45, 11.26s/batch, acc=0.5827, loss=0.9751][train] epoch=001:  53%|█████▎    | 23/43 [04:42<03:45, 11.26s/batch, acc=0.5887, loss=0.9676][train] epoch=001:  56%|█████▌    | 24/43 [04:42<03:39, 11.58s/batch, acc=0.5887, loss=0.9676][train] epoch=001:  56%|█████▌    | 24/43 [04:54<03:39, 11.58s/batch, acc=0.5933, loss=0.9628][train] epoch=001 batch=25/43 loss=0.9628 acc=0.5933 rss_mb=1607.2 ru_maxrss_mb=1607.2 py_current_mb=122.8 py_peak_mb=316.4 torch_allocated_mb=232.3 torch_mps_driver_mb=4676.1
[train] epoch=001:  58%|█████▊    | 25/43 [04:54<03:31, 11.77s/batch, acc=0.5933, loss=0.9628][train] epoch=001:  58%|█████▊    | 25/43 [05:07<03:31, 11.77s/batch, acc=0.5986, loss=0.9567][train] epoch=001:  60%|██████    | 26/43 [05:07<03:24, 12.03s/batch, acc=0.5986, loss=0.9567][train] epoch=001:  60%|██████    | 26/43 [05:19<03:24, 12.03s/batch, acc=0.6052, loss=0.9496][train] epoch=001:  63%|██████▎   | 27/43 [05:19<03:14, 12.17s/batch, acc=0.6052, loss=0.9496][train] epoch=001:  63%|██████▎   | 27/43 [05:31<03:14, 12.17s/batch, acc=0.6090, loss=0.9442][train] epoch=001:  65%|██████▌   | 28/43 [05:31<03:02, 12.15s/batch, acc=0.6090, loss=0.9442][train] epoch=001:  65%|██████▌   | 28/43 [05:45<03:02, 12.15s/batch, acc=0.6121, loss=0.9392][train] epoch=001:  67%|██████▋   | 29/43 [05:45<02:54, 12.48s/batch, acc=0.6121, loss=0.9392][train] epoch=001:  67%|██████▋   | 29/43 [05:59<02:54, 12.48s/batch, acc=0.6173, loss=0.9335][train] epoch=001 batch=30/43 loss=0.9335 acc=0.6173 rss_mb=1627.2 ru_maxrss_mb=1627.2 py_current_mb=122.8 py_peak_mb=316.4 torch_allocated_mb=232.3 torch_mps_driver_mb=4676.1
[train] epoch=001:  70%|██████▉   | 30/43 [05:59<02:48, 12.93s/batch, acc=0.6173, loss=0.9335][train] epoch=001:  70%|██████▉   | 30/43 [06:11<02:48, 12.93s/batch, acc=0.6222, loss=0.9280][train] epoch=001:  72%|███████▏  | 31/43 [06:11<02:32, 12.74s/batch, acc=0.6222, loss=0.9280][train] epoch=001:  72%|███████▏  | 31/43 [06:22<02:32, 12.74s/batch, acc=0.6271, loss=0.9225][train] epoch=001:  74%|███████▍  | 32/43 [06:22<02:13, 12.17s/batch, acc=0.6271, loss=0.9225][train] epoch=001:  74%|███████▍  | 32/43 [06:36<02:13, 12.17s/batch, acc=0.6314, loss=0.9179][train] epoch=001:  77%|███████▋  | 33/43 [06:36<02:06, 12.65s/batch, acc=0.6314, loss=0.9179][train] epoch=001:  77%|███████▋  | 33/43 [06:49<02:06, 12.65s/batch, acc=0.6371, loss=0.9109][train] epoch=001:  79%|███████▉  | 34/43 [06:49<01:56, 12.94s/batch, acc=0.6371, loss=0.9109][train] epoch=001:  79%|███████▉  | 34/43 [07:04<01:56, 12.94s/batch, acc=0.6433, loss=0.9039][train] epoch=001 batch=35/43 loss=0.9039 acc=0.6433 rss_mb=1627.2 ru_maxrss_mb=1627.2 py_current_mb=122.8 py_peak_mb=316.4 torch_allocated_mb=232.3 torch_mps_driver_mb=4676.1
[train] epoch=001:  81%|████████▏ | 35/43 [07:04<01:48, 13.55s/batch, acc=0.6433, loss=0.9039][train] epoch=001:  81%|████████▏ | 35/43 [07:16<01:48, 13.55s/batch, acc=0.6477, loss=0.8999][train] epoch=001:  84%|████████▎ | 36/43 [07:16<01:30, 12.93s/batch, acc=0.6477, loss=0.8999][train] epoch=001:  84%|████████▎ | 36/43 [07:29<01:30, 12.93s/batch, acc=0.6538, loss=0.8926][train] epoch=001:  86%|████████▌ | 37/43 [07:29<01:18, 13.06s/batch, acc=0.6538, loss=0.8926][train] epoch=001:  86%|████████▌ | 37/43 [07:41<01:18, 13.06s/batch, acc=0.6590, loss=0.8866][train] epoch=001:  88%|████████▊ | 38/43 [07:41<01:03, 12.69s/batch, acc=0.6590, loss=0.8866][train] epoch=001:  88%|████████▊ | 38/43 [07:53<01:03, 12.69s/batch, acc=0.6643, loss=0.8800][train] epoch=001:  91%|█████████ | 39/43 [07:53<00:49, 12.42s/batch, acc=0.6643, loss=0.8800][train] epoch=001:  91%|█████████ | 39/43 [08:06<00:49, 12.42s/batch, acc=0.6699, loss=0.8725][train] epoch=001 batch=40/43 loss=0.8725 acc=0.6699 rss_mb=1627.3 ru_maxrss_mb=1627.3 py_current_mb=122.8 py_peak_mb=316.4 torch_allocated_mb=232.3 torch_mps_driver_mb=4676.1
[train] epoch=001:  93%|█████████▎| 40/43 [08:06<00:37, 12.60s/batch, acc=0.6699, loss=0.8725][train] epoch=001:  93%|█████████▎| 40/43 [08:19<00:37, 12.60s/batch, acc=0.6741, loss=0.8665][train] epoch=001:  95%|█████████▌| 41/43 [08:19<00:25, 12.69s/batch, acc=0.6741, loss=0.8665][train] epoch=001:  95%|█████████▌| 41/43 [08:30<00:25, 12.69s/batch, acc=0.6783, loss=0.8608][train] epoch=001:  98%|█████████▊| 42/43 [08:30<00:12, 12.27s/batch, acc=0.6783, loss=0.8608][train] epoch=001:  98%|█████████▊| 42/43 [08:33<00:12, 12.27s/batch, acc=0.6791, loss=0.8597][train] epoch=001 batch=43/43 loss=0.8597 acc=0.6791 rss_mb=1704.3 ru_maxrss_mb=1704.3 py_current_mb=122.4 py_peak_mb=316.4 torch_allocated_mb=88.3 torch_mps_driver_mb=4766.5
[train] epoch=001: 100%|██████████| 43/43 [08:33<00:00,  9.52s/batch, acc=0.6791, loss=0.8597]                                                                                              [val] epoch=001:   0%|          | 0/5 [00:00<?, ?batch/s][val] epoch=001:   0%|          | 0/5 [00:06<?, ?batch/s, acc=0.8242, loss=0.7601][val] epoch=001:  20%|██        | 1/5 [00:06<00:25,  6.28s/batch, acc=0.8242, loss=0.7601][val] epoch=001:  20%|██        | 1/5 [00:13<00:25,  6.28s/batch, acc=0.8223, loss=0.7621][val] epoch=001:  40%|████      | 2/5 [00:13<00:20,  6.98s/batch, acc=0.8223, loss=0.7621][val] epoch=001:  40%|████      | 2/5 [00:23<00:20,  6.98s/batch, acc=0.8112, loss=0.7679][val] epoch=001:  60%|██████    | 3/5 [00:23<00:16,  8.07s/batch, acc=0.8112, loss=0.7679][val] epoch=001:  60%|██████    | 3/5 [00:34<00:16,  8.07s/batch, acc=0.8252, loss=0.7432][val] epoch=001:  80%|████████  | 4/5 [00:34<00:09,  9.47s/batch, acc=0.8252, loss=0.7432][val] epoch=001:  80%|████████  | 4/5 [00:39<00:09,  9.47s/batch, acc=0.8111, loss=0.7612][val] epoch=001 batch=5/5 loss=0.7612 acc=0.8111 rss_mb=1725.0 ru_maxrss_mb=1725.0 py_current_mb=122.4 py_peak_mb=316.4 torch_allocated_mb=232.6 torch_mps_driver_mb=4164.5
[val] epoch=001: 100%|██████████| 5/5 [00:39<00:00,  7.79s/batch, acc=0.8111, loss=0.7612]                                                                                          epoch=001 train_loss=0.8597 train_acc=0.6791 val_loss=0.7612 val_acc=0.8111
[train] epoch=001 rss_mb=1725.0 ru_maxrss_mb=1725.0 py_current_mb=122.4 py_peak_mb=316.4 torch_allocated_mb=40.3 torch_mps_driver_mb=4164.5
[train] epoch=002:   0%|          | 0/43 [00:00<?, ?batch/s][train] epoch=002:   0%|          | 0/43 [00:12<?, ?batch/s, acc=0.8789, loss=0.5926][train] epoch=002:   2%|▏         | 1/43 [00:12<08:31, 12.17s/batch, acc=0.8789, loss=0.5926][train] epoch=002:   2%|▏         | 1/43 [00:23<08:31, 12.17s/batch, acc=0.8770, loss=0.5881][train] epoch=002:   5%|▍         | 2/43 [00:23<08:06, 11.87s/batch, acc=0.8770, loss=0.5881][train] epoch=002:   5%|▍         | 2/43 [00:34<08:06, 11.87s/batch, acc=0.8828, loss=0.5855][train] epoch=002:   7%|▋         | 3/43 [00:34<07:36, 11.41s/batch, acc=0.8828, loss=0.5855][train] epoch=002:   7%|▋         | 3/43 [00:44<07:36, 11.41s/batch, acc=0.8877, loss=0.5807][train] epoch=002:   9%|▉         | 4/43 [00:44<07:02, 10.83s/batch, acc=0.8877, loss=0.5807][train] epoch=002:   9%|▉         | 4/43 [00:56<07:02, 10.83s/batch, acc=0.8930, loss=0.5765][train] epoch=002 batch=5/43 loss=0.5765 acc=0.8930 rss_mb=1728.7 ru_maxrss_mb=1728.7 py_current_mb=122.8 py_peak_mb=316.4 torch_allocated_mb=232.3 torch_mps_driver_mb=6212.5
[train] epoch=002:  12%|█▏        | 5/43 [00:56<07:03, 11.15s/batch, acc=0.8930, loss=0.5765][train] epoch=002:  12%|█▏        | 5/43 [01:09<07:03, 11.15s/batch, acc=0.8952, loss=0.5689][train] epoch=002:  14%|█▍        | 6/43 [01:09<07:23, 11.98s/batch, acc=0.8952, loss=0.5689][train] epoch=002:  14%|█▍        | 6/43 [01:21<07:23, 11.98s/batch, acc=0.8929, loss=0.5688][train] epoch=002:  16%|█▋        | 7/43 [01:21<07:11, 12.00s/batch, acc=0.8929, loss=0.5688][train] epoch=002:  16%|█▋        | 7/43 [01:35<07:11, 12.00s/batch, acc=0.8979, loss=0.5633][train] epoch=002:  19%|█▊        | 8/43 [01:35<07:19, 12.54s/batch, acc=0.8979, loss=0.5633][train] epoch=002:  19%|█▊        | 8/43 [01:47<07:19, 12.54s/batch, acc=0.9019, loss=0.5546][train] epoch=002:  21%|██        | 9/43 [01:47<06:58, 12.32s/batch, acc=0.9019, loss=0.5546][train] epoch=002:  21%|██        | 9/43 [01:58<06:58, 12.32s/batch, acc=0.9066, loss=0.5462][train] epoch=002 batch=10/43 loss=0.5462 acc=0.9066 rss_mb=1728.7 ru_maxrss_mb=1728.7 py_current_mb=122.8 py_peak_mb=316.4 torch_allocated_mb=232.3 torch_mps_driver_mb=6212.5
[train] epoch=002:  23%|██▎       | 10/43 [01:58<06:33, 11.93s/batch, acc=0.9066, loss=0.5462][train] epoch=002:  23%|██▎       | 10/43 [02:12<06:33, 11.93s/batch, acc=0.9070, loss=0.5430][train] epoch=002:  26%|██▌       | 11/43 [02:12<06:37, 12.41s/batch, acc=0.9070, loss=0.5430][train] epoch=002:  26%|██▌       | 11/43 [02:25<06:37, 12.41s/batch, acc=0.9072, loss=0.5392][train] epoch=002:  28%|██▊       | 12/43 [02:25<06:31, 12.64s/batch, acc=0.9072, loss=0.5392][train] epoch=002:  28%|██▊       | 12/43 [02:37<06:31, 12.64s/batch, acc=0.9062, loss=0.5376][train] epoch=002:  30%|███       | 13/43 [02:37<06:11, 12.38s/batch, acc=0.9062, loss=0.5376][train] epoch=002:  30%|███       | 13/43 [02:48<06:11, 12.38s/batch, acc=0.9049, loss=0.5357][train] epoch=002:  33%|███▎      | 14/43 [02:48<05:54, 12.21s/batch, acc=0.9049, loss=0.5357][train] epoch=002:  33%|███▎      | 14/43 [03:01<05:54, 12.21s/batch, acc=0.9068, loss=0.5322][train] epoch=002 batch=15/43 loss=0.5322 acc=0.9068 rss_mb=1729.6 ru_maxrss_mb=1729.6 py_current_mb=122.8 py_peak_mb=316.4 torch_allocated_mb=232.3 torch_mps_driver_mb=6212.5
[train] epoch=002:  35%|███▍      | 15/43 [03:01<05:46, 12.39s/batch, acc=0.9068, loss=0.5322][train] epoch=002:  35%|███▍      | 15/43 [03:13<05:46, 12.39s/batch, acc=0.9072, loss=0.5304][train] epoch=002:  37%|███▋      | 16/43 [03:13<05:27, 12.14s/batch, acc=0.9072, loss=0.5304][train] epoch=002:  37%|███▋      | 16/43 [03:24<05:27, 12.14s/batch, acc=0.9076, loss=0.5274][train] epoch=002:  40%|███▉      | 17/43 [03:24<05:08, 11.88s/batch, acc=0.9076, loss=0.5274][train] epoch=002:  40%|███▉      | 17/43 [03:36<05:08, 11.88s/batch, acc=0.9082, loss=0.5239][train] epoch=002:  42%|████▏     | 18/43 [03:36<04:59, 11.97s/batch, acc=0.9082, loss=0.5239][train] epoch=002:  42%|████▏     | 18/43 [03:47<04:59, 11.97s/batch, acc=0.9097, loss=0.5203][train] epoch=002:  44%|████▍     | 19/43 [03:47<04:40, 11.69s/batch, acc=0.9097, loss=0.5203][train] epoch=002:  44%|████▍     | 19/43 [03:59<04:40, 11.69s/batch, acc=0.9107, loss=0.5186][train] epoch=002 batch=20/43 loss=0.5186 acc=0.9107 rss_mb=1729.6 ru_maxrss_mb=1729.6 py_current_mb=122.8 py_peak_mb=316.5 torch_allocated_mb=232.3 torch_mps_driver_mb=6212.5
[train] epoch=002:  47%|████▋     | 20/43 [03:59<04:31, 11.82s/batch, acc=0.9107, loss=0.5186][train] epoch=002:  47%|████▋     | 20/43 [04:11<04:31, 11.82s/batch, acc=0.9131, loss=0.5134][train] epoch=002:  49%|████▉     | 21/43 [04:11<04:16, 11.67s/batch, acc=0.9131, loss=0.5134][train] epoch=002:  49%|████▉     | 21/43 [04:23<04:16, 11.67s/batch, acc=0.9142, loss=0.5102][train] epoch=002:  51%|█████     | 22/43 [04:23<04:12, 12.02s/batch, acc=0.9142, loss=0.5102][train] epoch=002:  51%|█████     | 22/43 [04:34<04:12, 12.02s/batch, acc=0.9130, loss=0.5105][train] epoch=002:  53%|█████▎    | 23/43 [04:34<03:51, 11.57s/batch, acc=0.9130, loss=0.5105][train] epoch=002:  53%|█████▎    | 23/43 [04:46<03:51, 11.57s/batch, acc=0.9146, loss=0.5073][train] epoch=002:  56%|█████▌    | 24/43 [04:46<03:40, 11.58s/batch, acc=0.9146, loss=0.5073][train] epoch=002:  56%|█████▌    | 24/43 [04:58<03:40, 11.58s/batch, acc=0.9150, loss=0.5054][train] epoch=002 batch=25/43 loss=0.5054 acc=0.9150 rss_mb=1729.6 ru_maxrss_mb=1729.6 py_current_mb=122.8 py_peak_mb=316.5 torch_allocated_mb=232.3 torch_mps_driver_mb=6212.5
[train] epoch=002:  58%|█████▊    | 25/43 [04:58<03:34, 11.92s/batch, acc=0.9150, loss=0.5054][train] epoch=002:  58%|█████▊    | 25/43 [05:11<03:34, 11.92s/batch, acc=0.9153, loss=0.5032][train] epoch=002:  60%|██████    | 26/43 [05:11<03:25, 12.12s/batch, acc=0.9153, loss=0.5032][train] epoch=002:  60%|██████    | 26/43 [05:22<03:25, 12.12s/batch, acc=0.9158, loss=0.5009][train] epoch=002:  63%|██████▎   | 27/43 [05:22<03:11, 11.95s/batch, acc=0.9158, loss=0.5009][train] epoch=002:  63%|██████▎   | 27/43 [05:36<03:11, 11.95s/batch, acc=0.9160, loss=0.4986][train] epoch=002:  65%|██████▌   | 28/43 [05:36<03:06, 12.42s/batch, acc=0.9160, loss=0.4986][train] epoch=002:  65%|██████▌   | 28/43 [05:48<03:06, 12.42s/batch, acc=0.9180, loss=0.4952][train] epoch=002:  67%|██████▋   | 29/43 [05:48<02:51, 12.24s/batch, acc=0.9180, loss=0.4952][train] epoch=002:  67%|██████▋   | 29/43 [06:00<02:51, 12.24s/batch, acc=0.9177, loss=0.4930][train] epoch=002 batch=30/43 loss=0.4930 acc=0.9177 rss_mb=1729.7 ru_maxrss_mb=1729.7 py_current_mb=122.8 py_peak_mb=316.5 torch_allocated_mb=232.3 torch_mps_driver_mb=6212.5
[train] epoch=002:  70%|██████▉   | 30/43 [06:00<02:39, 12.25s/batch, acc=0.9177, loss=0.4930][train] epoch=002:  70%|██████▉   | 30/43 [06:14<02:39, 12.25s/batch, acc=0.9180, loss=0.4921][train] epoch=002:  72%|███████▏  | 31/43 [06:14<02:33, 12.79s/batch, acc=0.9180, loss=0.4921][train] epoch=002:  72%|███████▏  | 31/43 [06:24<02:33, 12.79s/batch, acc=0.9176, loss=0.4905][train] epoch=002:  74%|███████▍  | 32/43 [06:24<02:09, 11.79s/batch, acc=0.9176, loss=0.4905][train] epoch=002:  74%|███████▍  | 32/43 [06:35<02:09, 11.79s/batch, acc=0.9182, loss=0.4892][train] epoch=002:  77%|███████▋  | 33/43 [06:35<01:56, 11.67s/batch, acc=0.9182, loss=0.4892][train] epoch=002:  77%|███████▋  | 33/43 [06:48<01:56, 11.67s/batch, acc=0.9189, loss=0.4864][train] epoch=002:  79%|███████▉  | 34/43 [06:48<01:47, 11.99s/batch, acc=0.9189, loss=0.4864][train] epoch=002:  79%|███████▉  | 34/43 [07:00<01:47, 11.99s/batch, acc=0.9185, loss=0.4857][train] epoch=002 batch=35/43 loss=0.4857 acc=0.9185 rss_mb=1729.7 ru_maxrss_mb=1729.7 py_current_mb=122.8 py_peak_mb=316.5 torch_allocated_mb=232.3 torch_mps_driver_mb=6212.5
[train] epoch=002:  81%|████████▏ | 35/43 [07:00<01:36, 12.03s/batch, acc=0.9185, loss=0.4857][train] epoch=002:  81%|████████▏ | 35/43 [07:12<01:36, 12.03s/batch, acc=0.9192, loss=0.4837][train] epoch=002:  84%|████████▎ | 36/43 [07:12<01:24, 12.12s/batch, acc=0.9192, loss=0.4837][train] epoch=002:  84%|████████▎ | 36/43 [07:24<01:24, 12.12s/batch, acc=0.9194, loss=0.4816][train] epoch=002:  86%|████████▌ | 37/43 [07:24<01:12, 12.07s/batch, acc=0.9194, loss=0.4816][train] epoch=002:  86%|████████▌ | 37/43 [07:35<01:12, 12.07s/batch, acc=0.9207, loss=0.4790][train] epoch=002:  88%|████████▊ | 38/43 [07:35<00:58, 11.72s/batch, acc=0.9207, loss=0.4790][train] epoch=002:  88%|████████▊ | 38/43 [07:47<00:58, 11.72s/batch, acc=0.9218, loss=0.4762][train] epoch=002:  91%|█████████ | 39/43 [07:47<00:47, 11.92s/batch, acc=0.9218, loss=0.4762][train] epoch=002:  91%|█████████ | 39/43 [07:58<00:47, 11.92s/batch, acc=0.9218, loss=0.4749][train] epoch=002 batch=40/43 loss=0.4749 acc=0.9218 rss_mb=1729.8 ru_maxrss_mb=1729.8 py_current_mb=122.8 py_peak_mb=316.5 torch_allocated_mb=232.3 torch_mps_driver_mb=6212.5
[train] epoch=002:  93%|█████████▎| 40/43 [07:58<00:34, 11.59s/batch, acc=0.9218, loss=0.4749][train] epoch=002:  93%|█████████▎| 40/43 [08:11<00:34, 11.59s/batch, acc=0.9223, loss=0.4729][train] epoch=002:  95%|█████████▌| 41/43 [08:11<00:24, 12.00s/batch, acc=0.9223, loss=0.4729][train] epoch=002:  95%|█████████▌| 41/43 [08:22<00:24, 12.00s/batch, acc=0.9228, loss=0.4707][train] epoch=002:  98%|█████████▊| 42/43 [08:22<00:11, 11.72s/batch, acc=0.9228, loss=0.4707][train] epoch=002:  98%|█████████▊| 42/43 [08:24<00:11, 11.72s/batch, acc=0.9226, loss=0.4709][train] epoch=002 batch=43/43 loss=0.4709 acc=0.9226 rss_mb=1729.8 ru_maxrss_mb=1729.8 py_current_mb=122.4 py_peak_mb=316.5 torch_allocated_mb=85.3 torch_mps_driver_mb=6302.5
[train] epoch=002: 100%|██████████| 43/43 [08:24<00:00,  8.71s/batch, acc=0.9226, loss=0.4709]                                                                                              [val] epoch=002:   0%|          | 0/5 [00:00<?, ?batch/s][val] epoch=002:   0%|          | 0/5 [00:06<?, ?batch/s, acc=0.9531, loss=0.4167][val] epoch=002:  20%|██        | 1/5 [00:06<00:25,  6.32s/batch, acc=0.9531, loss=0.4167][val] epoch=002:  20%|██        | 1/5 [00:13<00:25,  6.32s/batch, acc=0.9277, loss=0.4456][val] epoch=002:  40%|████      | 2/5 [00:13<00:21,  7.03s/batch, acc=0.9277, loss=0.4456][val] epoch=002:  40%|████      | 2/5 [00:23<00:21,  7.03s/batch, acc=0.9297, loss=0.4453][val] epoch=002:  60%|██████    | 3/5 [00:23<00:16,  8.09s/batch, acc=0.9297, loss=0.4453][val] epoch=002:  60%|██████    | 3/5 [00:34<00:16,  8.09s/batch, acc=0.9307, loss=0.4370][val] epoch=002:  80%|████████  | 4/5 [00:34<00:09,  9.50s/batch, acc=0.9307, loss=0.4370][val] epoch=002:  80%|████████  | 4/5 [00:39<00:09,  9.50s/batch, acc=0.9136, loss=0.4563][val] epoch=002 batch=5/5 loss=0.4563 acc=0.9136 rss_mb=1730.3 ru_maxrss_mb=1730.3 py_current_mb=122.4 py_peak_mb=316.5 torch_allocated_mb=232.6 torch_mps_driver_mb=5700.5
[val] epoch=002: 100%|██████████| 5/5 [00:39<00:00,  7.80s/batch, acc=0.9136, loss=0.4563]                                                                                          epoch=002 train_loss=0.4709 train_acc=0.9226 val_loss=0.4563 val_acc=0.9136
[train] epoch=002 rss_mb=1730.3 ru_maxrss_mb=1730.3 py_current_mb=122.4 py_peak_mb=316.5 torch_allocated_mb=40.3 torch_mps_driver_mb=5700.5
[train] epoch=003:   0%|          | 0/43 [00:00<?, ?batch/s][train] epoch=003:   0%|          | 0/43 [00:12<?, ?batch/s, acc=0.9297, loss=0.4114][train] epoch=003:   2%|▏         | 1/43 [00:12<08:50, 12.64s/batch, acc=0.9297, loss=0.4114][train] epoch=003:   2%|▏         | 1/43 [00:24<08:50, 12.64s/batch, acc=0.9395, loss=0.3975][train] epoch=003:   5%|▍         | 2/43 [00:24<08:31, 12.47s/batch, acc=0.9395, loss=0.3975][train] epoch=003:   5%|▍         | 2/43 [00:36<08:31, 12.47s/batch, acc=0.9440, loss=0.3887][train] epoch=003:   7%|▋         | 3/43 [00:36<07:54, 11.87s/batch, acc=0.9440, loss=0.3887][train] epoch=003:   7%|▋         | 3/43 [00:49<07:54, 11.87s/batch, acc=0.9424, loss=0.3904][train] epoch=003:   9%|▉         | 4/43 [00:49<07:59, 12.29s/batch, acc=0.9424, loss=0.3904][train] epoch=003:   9%|▉         | 4/43 [01:00<07:59, 12.29s/batch, acc=0.9367, loss=0.3967][train] epoch=003 batch=5/43 loss=0.3967 acc=0.9367 rss_mb=1732.4 ru_maxrss_mb=1732.4 py_current_mb=122.8 py_peak_mb=316.5 torch_allocated_mb=232.3 torch_mps_driver_mb=7236.5
[train] epoch=003:  12%|█▏        | 5/43 [01:00<07:33, 11.95s/batch, acc=0.9367, loss=0.3967][train] epoch=003:  12%|█▏        | 5/43 [01:12<07:33, 11.95s/batch, acc=0.9414, loss=0.3898][train] epoch=003:  14%|█▍        | 6/43 [01:12<07:21, 11.93s/batch, acc=0.9414, loss=0.3898][train] epoch=003:  14%|█▍        | 6/43 [01:24<07:21, 11.93s/batch, acc=0.9425, loss=0.3890][train] epoch=003:  16%|█▋        | 7/43 [01:24<07:08, 11.89s/batch, acc=0.9425, loss=0.3890][train] epoch=003:  16%|█▋        | 7/43 [01:35<07:08, 11.89s/batch, acc=0.9414, loss=0.3919][train] epoch=003:  19%|█▊        | 8/43 [01:35<06:47, 11.64s/batch, acc=0.9414, loss=0.3919][train] epoch=003:  19%|█▊        | 8/43 [01:47<06:47, 11.64s/batch, acc=0.9414, loss=0.3913][train] epoch=003:  21%|██        | 9/43 [01:47<06:47, 11.98s/batch, acc=0.9414, loss=0.3913][train] epoch=003:  21%|██        | 9/43 [01:58<06:47, 11.98s/batch, acc=0.9418, loss=0.3892][train] epoch=003 batch=10/43 loss=0.3892 acc=0.9418 rss_mb=1733.1 ru_maxrss_mb=1733.1 py_current_mb=122.8 py_peak_mb=316.5 torch_allocated_mb=232.3 torch_mps_driver_mb=7236.5
[train] epoch=003:  23%|██▎       | 10/43 [01:58<06:22, 11.59s/batch, acc=0.9418, loss=0.3892][train] epoch=003:  23%|██▎       | 10/43 [02:09<06:22, 11.59s/batch, acc=0.9446, loss=0.3844][train] epoch=003:  26%|██▌       | 11/43 [02:09<06:04, 11.41s/batch, acc=0.9446, loss=0.3844][train] epoch=003:  26%|██▌       | 11/43 [02:22<06:04, 11.41s/batch, acc=0.9424, loss=0.3878][train] epoch=003:  28%|██▊       | 12/43 [02:22<06:04, 11.77s/batch, acc=0.9424, loss=0.3878][train] epoch=003:  28%|██▊       | 12/43 [02:35<06:04, 11.77s/batch, acc=0.9420, loss=0.3873][train] epoch=003:  30%|███       | 13/43 [02:35<06:01, 12.07s/batch, acc=0.9420, loss=0.3873][train] epoch=003:  30%|███       | 13/43 [02:45<06:01, 12.07s/batch, acc=0.9414, loss=0.3864][train] epoch=003:  33%|███▎      | 14/43 [02:45<05:39, 11.69s/batch, acc=0.9414, loss=0.3864][train] epoch=003:  33%|███▎      | 14/43 [02:56<05:39, 11.69s/batch, acc=0.9424, loss=0.3847][train] epoch=003 batch=15/43 loss=0.3847 acc=0.9424 rss_mb=1733.8 ru_maxrss_mb=1733.8 py_current_mb=122.8 py_peak_mb=316.5 torch_allocated_mb=232.3 torch_mps_driver_mb=7236.5
[train] epoch=003:  35%|███▍      | 15/43 [02:56<05:21, 11.47s/batch, acc=0.9424, loss=0.3847][train] epoch=003:  35%|███▍      | 15/43 [03:09<05:21, 11.47s/batch, acc=0.9424, loss=0.3847][train] epoch=003:  37%|███▋      | 16/43 [03:09<05:15, 11.70s/batch, acc=0.9424, loss=0.3847][train] epoch=003:  37%|███▋      | 16/43 [03:21<05:15, 11.70s/batch, acc=0.9414, loss=0.3845][train] epoch=003:  40%|███▉      | 17/43 [03:21<05:13, 12.07s/batch, acc=0.9414, loss=0.3845][train] epoch=003:  40%|███▉      | 17/43 [03:33<05:13, 12.07s/batch, acc=0.9416, loss=0.3836][train] epoch=003:  42%|████▏     | 18/43 [03:33<04:59, 11.97s/batch, acc=0.9416, loss=0.3836][train] epoch=003:  42%|████▏     | 18/43 [03:45<04:59, 11.97s/batch, acc=0.9428, loss=0.3823][train] epoch=003:  44%|████▍     | 19/43 [03:45<04:43, 11.83s/batch, acc=0.9428, loss=0.3823][train] epoch=003:  44%|████▍     | 19/43 [03:57<04:43, 11.83s/batch, acc=0.9439, loss=0.3804][train] epoch=003 batch=20/43 loss=0.3804 acc=0.9439 rss_mb=1733.8 ru_maxrss_mb=1733.8 py_current_mb=122.8 py_peak_mb=316.5 torch_allocated_mb=232.3 torch_mps_driver_mb=7236.5
[train] epoch=003:  47%|████▋     | 20/43 [03:57<04:32, 11.83s/batch, acc=0.9439, loss=0.3804][train] epoch=003:  47%|████▋     | 20/43 [04:09<04:32, 11.83s/batch, acc=0.9449, loss=0.3780][train] epoch=003:  49%|████▉     | 21/43 [04:09<04:23, 11.96s/batch, acc=0.9449, loss=0.3780][train] epoch=003:  49%|████▉     | 21/43 [04:19<04:23, 11.96s/batch, acc=0.9462, loss=0.3761][train] epoch=003:  51%|█████     | 22/43 [04:19<04:02, 11.53s/batch, acc=0.9462, loss=0.3761][train] epoch=003:  51%|█████     | 22/43 [04:30<04:02, 11.53s/batch, acc=0.9467, loss=0.3749][train] epoch=003:  53%|█████▎    | 23/43 [04:30<03:47, 11.38s/batch, acc=0.9467, loss=0.3749][train] epoch=003:  53%|█████▎    | 23/43 [04:44<03:47, 11.38s/batch, acc=0.9478, loss=0.3732][train] epoch=003:  56%|█████▌    | 24/43 [04:44<03:51, 12.20s/batch, acc=0.9478, loss=0.3732][train] epoch=003:  56%|█████▌    | 24/43 [04:57<03:51, 12.20s/batch, acc=0.9486, loss=0.3719][train] epoch=003 batch=25/43 loss=0.3719 acc=0.9486 rss_mb=1733.8 ru_maxrss_mb=1733.8 py_current_mb=122.8 py_peak_mb=316.5 torch_allocated_mb=232.3 torch_mps_driver_mb=7236.5
[train] epoch=003:  58%|█████▊    | 25/43 [04:57<03:42, 12.34s/batch, acc=0.9486, loss=0.3719][train] epoch=003:  58%|█████▊    | 25/43 [05:11<03:42, 12.34s/batch, acc=0.9486, loss=0.3716][train] epoch=003:  60%|██████    | 26/43 [05:11<03:37, 12.77s/batch, acc=0.9486, loss=0.3716][train] epoch=003:  60%|██████    | 26/43 [05:24<03:37, 12.77s/batch, acc=0.9494, loss=0.3699][train] epoch=003:  63%|██████▎   | 27/43 [05:24<03:27, 12.96s/batch, acc=0.9494, loss=0.3699][train] epoch=003:  63%|██████▎   | 27/43 [05:37<03:27, 12.96s/batch, acc=0.9498, loss=0.3688][train] epoch=003:  65%|██████▌   | 28/43 [05:37<03:12, 12.85s/batch, acc=0.9498, loss=0.3688][train] epoch=003:  65%|██████▌   | 28/43 [05:49<03:12, 12.85s/batch, acc=0.9504, loss=0.3680][train] epoch=003:  67%|██████▋   | 29/43 [05:49<02:57, 12.68s/batch, acc=0.9504, loss=0.3680][train] epoch=003:  67%|██████▋   | 29/43 [06:00<02:57, 12.68s/batch, acc=0.9508, loss=0.3669][train] epoch=003 batch=30/43 loss=0.3669 acc=0.9508 rss_mb=1733.8 ru_maxrss_mb=1733.9 py_current_mb=122.8 py_peak_mb=316.5 torch_allocated_mb=232.3 torch_mps_driver_mb=7236.5
[train] epoch=003:  70%|██████▉   | 30/43 [06:00<02:38, 12.22s/batch, acc=0.9508, loss=0.3669][train] epoch=003:  70%|██████▉   | 30/43 [06:12<02:38, 12.22s/batch, acc=0.9507, loss=0.3661][train] epoch=003:  72%|███████▏  | 31/43 [06:12<02:26, 12.21s/batch, acc=0.9507, loss=0.3661][train] epoch=003:  72%|███████▏  | 31/43 [06:25<02:26, 12.21s/batch, acc=0.9512, loss=0.3651][train] epoch=003:  74%|███████▍  | 32/43 [06:25<02:14, 12.24s/batch, acc=0.9512, loss=0.3651][train] epoch=003:  74%|███████▍  | 32/43 [06:38<02:14, 12.24s/batch, acc=0.9510, loss=0.3651][train] epoch=003:  77%|███████▋  | 33/43 [06:38<02:04, 12.46s/batch, acc=0.9510, loss=0.3651][train] epoch=003:  77%|███████▋  | 33/43 [06:48<02:04, 12.46s/batch, acc=0.9519, loss=0.3640][train] epoch=003:  79%|███████▉  | 34/43 [06:48<01:46, 11.78s/batch, acc=0.9519, loss=0.3640][train] epoch=003:  79%|███████▉  | 34/43 [07:00<01:46, 11.78s/batch, acc=0.9516, loss=0.3637][train] epoch=003 batch=35/43 loss=0.3637 acc=0.9516 rss_mb=1733.8 ru_maxrss_mb=1733.9 py_current_mb=122.8 py_peak_mb=316.5 torch_allocated_mb=232.3 torch_mps_driver_mb=7236.5
[train] epoch=003:  81%|████████▏ | 35/43 [07:00<01:33, 11.73s/batch, acc=0.9516, loss=0.3637][train] epoch=003:  81%|████████▏ | 35/43 [07:12<01:33, 11.73s/batch, acc=0.9519, loss=0.3626][train] epoch=003:  84%|████████▎ | 36/43 [07:12<01:23, 11.97s/batch, acc=0.9519, loss=0.3626][train] epoch=003:  84%|████████▎ | 36/43 [07:25<01:23, 11.97s/batch, acc=0.9520, loss=0.3622][train] epoch=003:  86%|████████▌ | 37/43 [07:25<01:14, 12.38s/batch, acc=0.9520, loss=0.3622][train] epoch=003:  86%|████████▌ | 37/43 [07:40<01:14, 12.38s/batch, acc=0.9522, loss=0.3617][train] epoch=003:  88%|████████▊ | 38/43 [07:40<01:04, 12.95s/batch, acc=0.9522, loss=0.3617][train] epoch=003:  88%|████████▊ | 38/43 [07:52<01:04, 12.95s/batch, acc=0.9521, loss=0.3615][train] epoch=003:  91%|█████████ | 39/43 [07:52<00:51, 12.81s/batch, acc=0.9521, loss=0.3615][train] epoch=003:  91%|█████████ | 39/43 [08:03<00:51, 12.81s/batch, acc=0.9525, loss=0.3606][train] epoch=003 batch=40/43 loss=0.3606 acc=0.9525 rss_mb=1747.7 ru_maxrss_mb=1747.7 py_current_mb=122.8 py_peak_mb=316.5 torch_allocated_mb=232.3 torch_mps_driver_mb=7236.5
[train] epoch=003:  93%|█████████▎| 40/43 [08:03<00:36, 12.18s/batch, acc=0.9525, loss=0.3606][train] epoch=003:  93%|█████████▎| 40/43 [08:16<00:36, 12.18s/batch, acc=0.9530, loss=0.3592][train] epoch=003:  95%|█████████▌| 41/43 [08:16<00:24, 12.48s/batch, acc=0.9530, loss=0.3592][train] epoch=003:  95%|█████████▌| 41/43 [08:28<00:24, 12.48s/batch, acc=0.9533, loss=0.3588][train] epoch=003:  98%|█████████▊| 42/43 [08:28<00:12, 12.43s/batch, acc=0.9533, loss=0.3588][train] epoch=003:  98%|█████████▊| 42/43 [08:30<00:12, 12.43s/batch, acc=0.9535, loss=0.3585][train] epoch=003 batch=43/43 loss=0.3585 acc=0.9535 rss_mb=1747.7 ru_maxrss_mb=1747.7 py_current_mb=122.4 py_peak_mb=316.5 torch_allocated_mb=85.3 torch_mps_driver_mb=7326.5
[train] epoch=003: 100%|██████████| 43/43 [08:30<00:00,  9.30s/batch, acc=0.9535, loss=0.3585]                                                                                              [val] epoch=003:   0%|          | 0/5 [00:00<?, ?batch/s][val] epoch=003:   0%|          | 0/5 [00:06<?, ?batch/s, acc=0.9180, loss=0.4268][val] epoch=003:  20%|██        | 1/5 [00:06<00:25,  6.34s/batch, acc=0.9180, loss=0.4268][val] epoch=003:  20%|██        | 1/5 [00:13<00:25,  6.34s/batch, acc=0.9004, loss=0.4525][val] epoch=003:  40%|████      | 2/5 [00:13<00:21,  7.02s/batch, acc=0.9004, loss=0.4525][val] epoch=003:  40%|████      | 2/5 [00:23<00:21,  7.02s/batch, acc=0.9023, loss=0.4420][val] epoch=003:  60%|██████    | 3/5 [00:23<00:16,  8.12s/batch, acc=0.9023, loss=0.4420][val] epoch=003:  60%|██████    | 3/5 [00:35<00:16,  8.12s/batch, acc=0.9053, loss=0.4367][val] epoch=003:  80%|████████  | 4/5 [00:35<00:09,  9.55s/batch, acc=0.9053, loss=0.4367][val] epoch=003:  80%|████████  | 4/5 [00:39<00:09,  9.55s/batch, acc=0.9040, loss=0.4454][val] epoch=003 batch=5/5 loss=0.4454 acc=0.9040 rss_mb=1747.7 ru_maxrss_mb=1747.7 py_current_mb=122.4 py_peak_mb=316.5 torch_allocated_mb=232.6 torch_mps_driver_mb=6724.5
[val] epoch=003: 100%|██████████| 5/5 [00:39<00:00,  7.84s/batch, acc=0.9040, loss=0.4454]                                                                                          epoch=003 train_loss=0.3585 train_acc=0.9535 val_loss=0.4454 val_acc=0.9040
[train] epoch=003 rss_mb=1747.7 ru_maxrss_mb=1747.7 py_current_mb=122.4 py_peak_mb=316.5 torch_allocated_mb=40.3 torch_mps_driver_mb=6724.5
[train] no improvement for 1 epoch(s); patience=2
[train] epoch=004:   0%|          | 0/43 [00:00<?, ?batch/s][train] epoch=004:   0%|          | 0/43 [00:12<?, ?batch/s, acc=0.9648, loss=0.3264][train] epoch=004:   2%|▏         | 1/43 [00:12<08:58, 12.83s/batch, acc=0.9648, loss=0.3264][train] epoch=004:   2%|▏         | 1/43 [00:23<08:58, 12.83s/batch, acc=0.9688, loss=0.3215][train] epoch=004:   5%|▍         | 2/43 [00:23<08:02, 11.77s/batch, acc=0.9688, loss=0.3215][train] epoch=004:   5%|▍         | 2/43 [00:35<08:02, 11.77s/batch, acc=0.9674, loss=0.3202][train] epoch=004:   7%|▋         | 3/43 [00:35<07:49, 11.75s/batch, acc=0.9674, loss=0.3202][train] epoch=004:   7%|▋         | 3/43 [00:45<07:49, 11.75s/batch, acc=0.9658, loss=0.3225][train] epoch=004:   9%|▉         | 4/43 [00:45<07:14, 11.15s/batch, acc=0.9658, loss=0.3225][train] epoch=004:   9%|▉         | 4/43 [00:59<07:14, 11.15s/batch, acc=0.9680, loss=0.3171][train] epoch=004 batch=5/43 loss=0.3171 acc=0.9680 rss_mb=1747.8 ru_maxrss_mb=1747.8 py_current_mb=122.8 py_peak_mb=316.5 torch_allocated_mb=232.3 torch_mps_driver_mb=7748.5
[train] epoch=004:  12%|█▏        | 5/43 [00:59<07:43, 12.21s/batch, acc=0.9680, loss=0.3171][train] epoch=004:  12%|█▏        | 5/43 [01:12<07:43, 12.21s/batch, acc=0.9668, loss=0.3174][train] epoch=004:  14%|█▍        | 6/43 [01:12<07:33, 12.25s/batch, acc=0.9668, loss=0.3174][train] epoch=004:  14%|█▍        | 6/43 [01:24<07:33, 12.25s/batch, acc=0.9654, loss=0.3219][train] epoch=004:  16%|█▋        | 7/43 [01:24<07:20, 12.23s/batch, acc=0.9654, loss=0.3219][train] epoch=004:  16%|█▋        | 7/43 [01:37<07:20, 12.23s/batch, acc=0.9678, loss=0.3177][train] epoch=004:  19%|█▊        | 8/43 [01:37<07:16, 12.46s/batch, acc=0.9678, loss=0.3177][train] epoch=004:  19%|█▊        | 8/43 [01:49<07:16, 12.46s/batch, acc=0.9670, loss=0.3182][train] epoch=004:  21%|██        | 9/43 [01:49<06:59, 12.33s/batch, acc=0.9670, loss=0.3182][train] epoch=004:  21%|██        | 9/43 [02:00<06:59, 12.33s/batch, acc=0.9676, loss=0.3175][train] epoch=004 batch=10/43 loss=0.3175 acc=0.9676 rss_mb=1747.8 ru_maxrss_mb=1747.8 py_current_mb=122.8 py_peak_mb=316.5 torch_allocated_mb=232.3 torch_mps_driver_mb=7748.5
[train] epoch=004:  23%|██▎       | 10/43 [02:00<06:37, 12.05s/batch, acc=0.9676, loss=0.3175][train] epoch=004:  23%|██▎       | 10/43 [02:13<06:37, 12.05s/batch, acc=0.9688, loss=0.3168][train] epoch=004:  26%|██▌       | 11/43 [02:13<06:28, 12.14s/batch, acc=0.9688, loss=0.3168][train] epoch=004:  26%|██▌       | 11/43 [02:25<06:28, 12.14s/batch, acc=0.9694, loss=0.3169][train] epoch=004:  28%|██▊       | 12/43 [02:25<06:14, 12.09s/batch, acc=0.9694, loss=0.3169][train] epoch=004:  28%|██▊       | 12/43 [02:37<06:14, 12.09s/batch, acc=0.9700, loss=0.3158][train] epoch=004:  30%|███       | 13/43 [02:37<06:08, 12.28s/batch, acc=0.9700, loss=0.3158][train] epoch=004:  30%|███       | 13/43 [02:51<06:08, 12.28s/batch, acc=0.9704, loss=0.3158][train] epoch=004:  33%|███▎      | 14/43 [02:51<06:04, 12.56s/batch, acc=0.9704, loss=0.3158][train] epoch=004:  33%|███▎      | 14/43 [03:03<06:04, 12.56s/batch, acc=0.9703, loss=0.3155][train] epoch=004 batch=15/43 loss=0.3155 acc=0.9703 rss_mb=1747.9 ru_maxrss_mb=1747.9 py_current_mb=122.8 py_peak_mb=316.5 torch_allocated_mb=232.3 torch_mps_driver_mb=7748.5
[train] epoch=004:  35%|███▍      | 15/43 [03:03<05:54, 12.66s/batch, acc=0.9703, loss=0.3155][train] epoch=004:  35%|███▍      | 15/43 [03:16<05:54, 12.66s/batch, acc=0.9709, loss=0.3142][train] epoch=004:  37%|███▋      | 16/43 [03:16<05:36, 12.47s/batch, acc=0.9709, loss=0.3142][train] epoch=004:  37%|███▋      | 16/43 [03:27<05:36, 12.47s/batch, acc=0.9715, loss=0.3129][train] epoch=004:  40%|███▉      | 17/43 [03:27<05:18, 12.24s/batch, acc=0.9715, loss=0.3129][train] epoch=004:  40%|███▉      | 17/43 [03:38<05:18, 12.24s/batch, acc=0.9709, loss=0.3134][train] epoch=004:  42%|████▏     | 18/43 [03:38<04:55, 11.82s/batch, acc=0.9709, loss=0.3134][train] epoch=004:  42%|████▏     | 18/43 [03:51<04:55, 11.82s/batch, acc=0.9710, loss=0.3130][train] epoch=004:  44%|████▍     | 19/43 [03:51<04:50, 12.12s/batch, acc=0.9710, loss=0.3130][train] epoch=004:  44%|████▍     | 19/43 [04:02<04:50, 12.12s/batch, acc=0.9705, loss=0.3134][train] epoch=004 batch=20/43 loss=0.3134 acc=0.9705 rss_mb=1747.9 ru_maxrss_mb=1747.9 py_current_mb=122.8 py_peak_mb=316.5 torch_allocated_mb=232.3 torch_mps_driver_mb=7748.5
[train] epoch=004:  47%|████▋     | 20/43 [04:02<04:34, 11.91s/batch, acc=0.9705, loss=0.3134][train] epoch=004:  47%|████▋     | 20/43 [04:15<04:34, 11.91s/batch, acc=0.9706, loss=0.3132][train] epoch=004:  49%|████▉     | 21/43 [04:15<04:27, 12.18s/batch, acc=0.9706, loss=0.3132][train] epoch=004:  49%|████▉     | 21/43 [04:28<04:27, 12.18s/batch, acc=0.9707, loss=0.3132][train] epoch=004:  51%|█████     | 22/43 [04:28<04:22, 12.52s/batch, acc=0.9707, loss=0.3132][train] epoch=004:  51%|█████     | 22/43 [04:41<04:22, 12.52s/batch, acc=0.9710, loss=0.3125][train] epoch=004:  53%|█████▎    | 23/43 [04:41<04:12, 12.61s/batch, acc=0.9710, loss=0.3125][train] epoch=004:  53%|█████▎    | 23/43 [04:53<04:12, 12.61s/batch, acc=0.9707, loss=0.3129][train] epoch=004:  56%|█████▌    | 24/43 [04:53<03:57, 12.49s/batch, acc=0.9707, loss=0.3129][train] epoch=004:  56%|█████▌    | 24/43 [05:06<03:57, 12.49s/batch, acc=0.9706, loss=0.3136][train] epoch=004 batch=25/43 loss=0.3136 acc=0.9706 rss_mb=1747.9 ru_maxrss_mb=1747.9 py_current_mb=122.8 py_peak_mb=316.5 torch_allocated_mb=232.3 torch_mps_driver_mb=7748.5
[train] epoch=004:  58%|█████▊    | 25/43 [05:06<03:46, 12.56s/batch, acc=0.9706, loss=0.3136][train] epoch=004:  58%|█████▊    | 25/43 [05:19<03:46, 12.56s/batch, acc=0.9709, loss=0.3129][train] epoch=004:  60%|██████    | 26/43 [05:19<03:36, 12.76s/batch, acc=0.9709, loss=0.3129][train] epoch=004:  60%|██████    | 26/43 [05:30<03:36, 12.76s/batch, acc=0.9709, loss=0.3128][train] epoch=004:  63%|██████▎   | 27/43 [05:30<03:13, 12.09s/batch, acc=0.9709, loss=0.3128][train] epoch=004:  63%|██████▎   | 27/43 [05:43<03:13, 12.09s/batch, acc=0.9707, loss=0.3129][train] epoch=004:  65%|██████▌   | 28/43 [05:43<03:05, 12.39s/batch, acc=0.9707, loss=0.3129][train] epoch=004:  65%|██████▌   | 28/43 [05:53<03:05, 12.39s/batch, acc=0.9710, loss=0.3119][train] epoch=004:  67%|██████▋   | 29/43 [05:53<02:44, 11.75s/batch, acc=0.9710, loss=0.3119][train] epoch=004:  67%|██████▋   | 29/43 [06:04<02:44, 11.75s/batch, acc=0.9708, loss=0.3122][train] epoch=004 batch=30/43 loss=0.3122 acc=0.9708 rss_mb=1748.0 ru_maxrss_mb=1748.0 py_current_mb=122.8 py_peak_mb=316.5 torch_allocated_mb=232.3 torch_mps_driver_mb=7748.5
[train] epoch=004:  70%|██████▉   | 30/43 [06:04<02:29, 11.51s/batch, acc=0.9708, loss=0.3122][train] epoch=004:  70%|██████▉   | 30/43 [06:15<02:29, 11.51s/batch, acc=0.9703, loss=0.3124][train] epoch=004:  72%|███████▏  | 31/43 [06:15<02:16, 11.41s/batch, acc=0.9703, loss=0.3124][train] epoch=004:  72%|███████▏  | 31/43 [06:26<02:16, 11.41s/batch, acc=0.9700, loss=0.3126][train] epoch=004:  74%|███████▍  | 32/43 [06:26<02:03, 11.27s/batch, acc=0.9700, loss=0.3126][train] epoch=004:  74%|███████▍  | 32/43 [06:37<02:03, 11.27s/batch, acc=0.9704, loss=0.3118][train] epoch=004:  77%|███████▋  | 33/43 [06:37<01:49, 11.00s/batch, acc=0.9704, loss=0.3118][train] epoch=004:  77%|███████▋  | 33/43 [06:49<01:49, 11.00s/batch, acc=0.9705, loss=0.3117][train] epoch=004:  79%|███████▉  | 34/43 [06:49<01:42, 11.41s/batch, acc=0.9705, loss=0.3117][train] epoch=004:  79%|███████▉  | 34/43 [07:02<01:42, 11.41s/batch, acc=0.9709, loss=0.3110][train] epoch=004 batch=35/43 loss=0.3110 acc=0.9709 rss_mb=1748.0 ru_maxrss_mb=1748.0 py_current_mb=122.8 py_peak_mb=316.5 torch_allocated_mb=232.3 torch_mps_driver_mb=7748.5
[train] epoch=004:  81%|████████▏ | 35/43 [07:02<01:35, 11.91s/batch, acc=0.9709, loss=0.3110][train] epoch=004:  81%|████████▏ | 35/43 [07:16<01:35, 11.91s/batch, acc=0.9709, loss=0.3107][train] epoch=004:  84%|████████▎ | 36/43 [07:16<01:27, 12.49s/batch, acc=0.9709, loss=0.3107][train] epoch=004:  84%|████████▎ | 36/43 [07:28<01:27, 12.49s/batch, acc=0.9712, loss=0.3102][train] epoch=004:  86%|████████▌ | 37/43 [07:28<01:13, 12.31s/batch, acc=0.9712, loss=0.3102][train] epoch=004:  86%|████████▌ | 37/43 [07:41<01:13, 12.31s/batch, acc=0.9713, loss=0.3098][train] epoch=004:  88%|████████▊ | 38/43 [07:41<01:02, 12.44s/batch, acc=0.9713, loss=0.3098][train] epoch=004:  88%|████████▊ | 38/43 [07:53<01:02, 12.44s/batch, acc=0.9714, loss=0.3097][train] epoch=004:  91%|█████████ | 39/43 [07:53<00:49, 12.30s/batch, acc=0.9714, loss=0.3097][train] epoch=004:  91%|█████████ | 39/43 [08:06<00:49, 12.30s/batch, acc=0.9711, loss=0.3095][train] epoch=004 batch=40/43 loss=0.3095 acc=0.9711 rss_mb=1748.0 ru_maxrss_mb=1748.0 py_current_mb=122.8 py_peak_mb=316.5 torch_allocated_mb=232.3 torch_mps_driver_mb=7748.5
[train] epoch=004:  93%|█████████▎| 40/43 [08:06<00:38, 12.76s/batch, acc=0.9711, loss=0.3095][train] epoch=004:  93%|█████████▎| 40/43 [08:18<00:38, 12.76s/batch, acc=0.9713, loss=0.3089][train] epoch=004:  95%|█████████▌| 41/43 [08:18<00:24, 12.44s/batch, acc=0.9713, loss=0.3089][train] epoch=004:  95%|█████████▌| 41/43 [08:30<00:24, 12.44s/batch, acc=0.9715, loss=0.3082][train] epoch=004:  98%|█████████▊| 42/43 [08:30<00:12, 12.18s/batch, acc=0.9715, loss=0.3082][train] epoch=004:  98%|█████████▊| 42/43 [08:32<00:12, 12.18s/batch, acc=0.9717, loss=0.3081][train] epoch=004 batch=43/43 loss=0.3081 acc=0.9717 rss_mb=1748.0 ru_maxrss_mb=1748.0 py_current_mb=122.4 py_peak_mb=316.5 torch_allocated_mb=85.3 torch_mps_driver_mb=7838.5
[train] epoch=004: 100%|██████████| 43/43 [08:32<00:00,  9.14s/batch, acc=0.9717, loss=0.3081]                                                                                              [val] epoch=004:   0%|          | 0/5 [00:00<?, ?batch/s][val] epoch=004:   0%|          | 0/5 [00:06<?, ?batch/s, acc=0.9180, loss=0.3627][val] epoch=004:  20%|██        | 1/5 [00:06<00:24,  6.23s/batch, acc=0.9180, loss=0.3627][val] epoch=004:  20%|██        | 1/5 [00:13<00:24,  6.23s/batch, acc=0.9102, loss=0.4083][val] epoch=004:  40%|████      | 2/5 [00:13<00:20,  6.95s/batch, acc=0.9102, loss=0.4083][val] epoch=004:  40%|████      | 2/5 [00:22<00:20,  6.95s/batch, acc=0.9036, loss=0.4141][val] epoch=004:  60%|██████    | 3/5 [00:22<00:16,  8.02s/batch, acc=0.9036, loss=0.4141][val] epoch=004:  60%|██████    | 3/5 [00:34<00:16,  8.02s/batch, acc=0.9082, loss=0.4091][val] epoch=004:  80%|████████  | 4/5 [00:34<00:09,  9.43s/batch, acc=0.9082, loss=0.4091][val] epoch=004:  80%|████████  | 4/5 [00:39<00:09,  9.43s/batch, acc=0.8951, loss=0.4376][val] epoch=004 batch=5/5 loss=0.4376 acc=0.8951 rss_mb=1748.0 ru_maxrss_mb=1748.0 py_current_mb=122.4 py_peak_mb=316.5 torch_allocated_mb=232.6 torch_mps_driver_mb=7236.5
[val] epoch=004: 100%|██████████| 5/5 [00:39<00:00,  7.72s/batch, acc=0.8951, loss=0.4376]                                                                                          epoch=004 train_loss=0.3081 train_acc=0.9717 val_loss=0.4376 val_acc=0.8951
[train] epoch=004 rss_mb=1748.0 ru_maxrss_mb=1748.0 py_current_mb=122.4 py_peak_mb=316.5 torch_allocated_mb=40.3 torch_mps_driver_mb=7236.5
[train] no improvement for 2 epoch(s); patience=2
[train] early stopping at epoch=004
best_val_accuracy=0.9136 checkpoint=/Users/helios/rotation-detection/runs/final_run_cap10k/models/orientation_cnn.pt
[train] done memory rss_mb=1748.0 ru_maxrss_mb=1748.0 py_current_mb=122.4 py_peak_mb=316.5 torch_allocated_mb=40.3 torch_mps_driver_mb=7236.5
Training report: /Users/helios/rotation-detection/runs/final_run_cap10k/models/orientation_cnn.report.json
[train] final memory rss_mb=1748.0 ru_maxrss_mb=1748.0 py_current_mb=122.3 py_peak_mb=316.5
[logging] tee enabled log_file=/Users/helios/rotation-detection/runs/final_run_cap10k/models/orientation_cnn.train.log
[train] checkpoint=/Users/helios/rotation-detection/runs/final_run_cap10k/models/orientation_cnn.pt
[train] start memory {'rss_mb': 47.25, 'ru_maxrss_mb': 47.25, 'py_current_mb': 0.0, 'py_peak_mb': 0.0, 'torch_allocated_mb': None, 'torch_reserved_mb': None, 'torch_mps_driver_mb': None}
[train] data_sampling class_balance=uniform split_strategy=document_page_weighted min_val_docs=8 min_test_docs=8
[train] rows train=10797 val=1239
[train] split_profile train angles=0:2695 90:2701 180:2699 270:2702 max_doc_share=0.093
[train] split_profile val angles=0:309 90:309 180:311 270:310 max_doc_share=0.450
[train] warning val split is document-dominated; validation may be noisy for hyperparameter selection
[train] init memory rss_mb=416.3 ru_maxrss_mb=416.3 py_current_mb=122.6 py_peak_mb=122.9 torch_allocated_mb=2.9 torch_mps_driver_mb=48.5
[train] epoch=001:   0%|          | 0/43 [00:00<?, ?batch/s][train] epoch=001:   0%|          | 0/43 [00:12<?, ?batch/s, acc=0.2344, loss=1.4117][train] epoch=001:   2%|▏         | 1/43 [00:12<08:31, 12.17s/batch, acc=0.2344, loss=1.4117][train] epoch=001:   2%|▏         | 1/43 [00:21<08:31, 12.17s/batch, acc=0.2969, loss=1.4000][train] epoch=001:   5%|▍         | 2/43 [00:21<07:11, 10.52s/batch, acc=0.2969, loss=1.4000][train] epoch=001:   5%|▍         | 2/43 [00:31<07:11, 10.52s/batch, acc=0.3854, loss=1.3231][train] epoch=001:   7%|▋         | 3/43 [00:31<06:56, 10.40s/batch, acc=0.3854, loss=1.3231][train] epoch=001:   7%|▋         | 3/43 [00:45<06:56, 10.40s/batch, acc=0.4131, loss=1.2727][train] epoch=001:   9%|▉         | 4/43 [00:45<07:37, 11.74s/batch, acc=0.4131, loss=1.2727][train] epoch=001:   9%|▉         | 4/43 [00:58<07:37, 11.74s/batch, acc=0.4367, loss=1.2238][train] epoch=001 batch=5/43 loss=1.2238 acc=0.4367 rss_mb=1580.5 ru_maxrss_mb=1580.5 py_current_mb=122.8 py_peak_mb=316.4 torch_allocated_mb=232.8 torch_mps_driver_mb=4676.1
[train] epoch=001:  12%|█▏        | 5/43 [00:58<07:43, 12.20s/batch, acc=0.4367, loss=1.2238][train] epoch=001:  12%|█▏        | 5/43 [01:10<07:43, 12.20s/batch, acc=0.4505, loss=1.1890][train] epoch=001:  14%|█▍        | 6/43 [01:10<07:24, 12.02s/batch, acc=0.4505, loss=1.1890][train] epoch=001:  14%|█▍        | 6/43 [01:23<07:24, 12.02s/batch, acc=0.4682, loss=1.1504][train] epoch=001:  16%|█▋        | 7/43 [01:23<07:24, 12.36s/batch, acc=0.4682, loss=1.1504][train] epoch=001:  16%|█▋        | 7/43 [01:34<07:24, 12.36s/batch, acc=0.4810, loss=1.1324][train] epoch=001:  19%|█▊        | 8/43 [01:34<06:54, 11.85s/batch, acc=0.4810, loss=1.1324][train] epoch=001:  19%|█▊        | 8/43 [01:45<06:54, 11.85s/batch, acc=0.4896, loss=1.1113][train] epoch=001:  21%|██        | 9/43 [01:45<06:39, 11.74s/batch, acc=0.4896, loss=1.1113][train] epoch=001:  21%|██        | 9/43 [01:58<06:39, 11.74s/batch, acc=0.4898, loss=1.0977][train] epoch=001 batch=10/43 loss=1.0977 acc=0.4898 rss_mb=1350.2 ru_maxrss_mb=1580.6 py_current_mb=122.8 py_peak_mb=316.4 torch_allocated_mb=232.8 torch_mps_driver_mb=4676.1
[train] epoch=001:  23%|██▎       | 10/43 [01:58<06:37, 12.06s/batch, acc=0.4898, loss=1.0977]                                                                                              