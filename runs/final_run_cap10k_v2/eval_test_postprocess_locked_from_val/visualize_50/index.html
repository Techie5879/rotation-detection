<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Rotation Prediction Viewer</title>
  <style>
    :root {
      --bg: #0b1020;
      --panel: #121a2f;
      --panel2: #18213a;
      --text: #e8edf8;
      --muted: #9fb0d0;
      --ok: #39d98a;
      --bad: #ff6b6b;
      --accent: #6ab3ff;
      --border: #2a3555;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at 20% 0%, #13203f 0%, var(--bg) 45%);
      color: var(--text);
    }
    .wrap { max-width: 1500px; margin: 0 auto; padding: 20px; }
    .head { background: var(--panel); border: 1px solid var(--border); border-radius: 14px; padding: 16px; }
    .head h1 { margin: 0 0 8px 0; font-size: 24px; }
    .meta { color: var(--muted); font-size: 14px; }
    .stats { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 12px; }
    .chip { background: var(--panel2); border: 1px solid var(--border); border-radius: 999px; padding: 6px 10px; font-size: 13px; }
    .grid { display: grid; grid-template-columns: 280px 1fr; gap: 16px; margin-top: 16px; }
    .sidebar, .main { background: var(--panel); border: 1px solid var(--border); border-radius: 14px; padding: 14px; }
    .section-title { margin: 6px 0 10px 0; color: var(--muted); font-size: 13px; text-transform: uppercase; letter-spacing: .06em; }
    .list { margin: 0; padding-left: 16px; font-size: 13px; color: var(--text); }
    .list li { margin: 6px 0; }
    .controls { display: grid; grid-template-columns: repeat(4, minmax(150px, 1fr)); gap: 8px; margin-bottom: 10px; }
    .controls label { display: grid; gap: 4px; font-size: 12px; color: var(--muted); }
    .controls input, .controls select {
      border: 1px solid var(--border);
      background: #0f1730;
      color: var(--text);
      border-radius: 8px;
      padding: 7px 8px;
    }
    .count { color: var(--muted); font-size: 13px; margin-bottom: 8px; }
    .cards { display: grid; gap: 10px; }
    .card { background: var(--panel2); border: 1px solid var(--border); border-radius: 12px; padding: 10px; }
    .card-head { display: flex; flex-wrap: wrap; gap: 8px 12px; align-items: center; margin-bottom: 8px; }
    .tag { padding: 3px 8px; border-radius: 999px; font-size: 12px; border: 1px solid var(--border); }
    .tag.ok { color: var(--ok); border-color: #2f7f57; background: #173625; }
    .tag.bad { color: var(--bad); border-color: #7f3636; background: #381919; }
    .k { color: var(--muted); font-size: 12px; }
    .v { font-size: 13px; }
    .imgs { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    .pane { background: #0f1730; border: 1px solid var(--border); border-radius: 10px; padding: 6px; }
    .pane h4 { margin: 2px 0 6px 0; font-size: 12px; color: var(--muted); font-weight: 600; }
    .pane img { width: 100%; height: auto; display: block; border-radius: 8px; }
    @media (max-width: 1100px) {
      .grid { grid-template-columns: 1fr; }
      .controls { grid-template-columns: repeat(2, minmax(140px, 1fr)); }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="head">
      <h1>Rotation Prediction Viewer</h1>
      <div class="meta">Before/after visualization for sampled test pages.</div>
      <div class="stats" id="topStats"></div>
    </div>

    <div class="grid">
      <aside class="sidebar">
        <div class="section-title">Worst Docs</div>
        <ul class="list" id="worstDocs"></ul>
        <div class="section-title">Best Docs</div>
        <ul class="list" id="bestDocs"></ul>
      </aside>

      <main class="main">
        <div class="controls">
          <label>Bucket
            <select id="bucket">
              <option value="all">all</option>
              <option value="worst_doc">worst_doc</option>
              <option value="best_doc">best_doc</option>
              <option value="global_fill">global_fill</option>
            </select>
          </label>
          <label>Correctness
            <select id="correct">
              <option value="all">all</option>
              <option value="correct">correct</option>
              <option value="wrong">wrong</option>
            </select>
          </label>
          <label>Doc Contains
            <input id="doc" placeholder="EW-2-..." />
          </label>
          <label>Min Confidence
            <input id="minConf" type="number" min="0" max="1" step="0.01" value="0" />
          </label>
        </div>
        <div class="count" id="count"></div>
        <div class="cards" id="cards"></div>
      </main>
    </div>
  </div>

  <script>
    const data = {"created_at_utc": "20260207T060428Z", "dataset_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2", "split": "test", "predictions_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/eval_test_postprocess_locked_from_val/predictions.jsonl", "prediction_field": "predicted_rotation_deg", "missing_label_matches": 0, "excluded_upright_inputs": 614, "excluded_zero_predictions": 2, "include_upright_inputs": false, "include_zero_predictions": false, "input_pages": 2466, "matched_pages": 1850, "selected_pages": 50, "sample_pages_requested": 50, "top_docs": ["EW-2-22765187-1212241-1-30bcaf7bba", "EW-2-22774058-1216031-1-ad9cd6f12f", "EW-2-22749717-1213901-2-dd17fec400"], "worst_docs": ["EW-2-22697155-5c367b1d0d", "EW-2-22696801-705c326024", "EW-2-22626634-bd3f678897", "EW-2-22749098-1210016-2-bc0f64f4b3", "EW-2-22714892-06e937c20d", "EW-2-22733576-1209605-1-1878fb1ffc", "EW-2-22783818-1214336-2-f1ca841e7c", "EW-2-22765157-1213045-2-1233915842", "EW-2-22772688-1214689-2-11c3317139", "EW-2-22744759-1212266-1-d8f40c6802"], "doc_stats": [{"doc_id": "EW-2-22697155-5c367b1d0d", "pages": 300, "correct": 297, "errors": 3, "accuracy": 0.99}, {"doc_id": "EW-2-22696801-705c326024", "pages": 300, "correct": 299, "errors": 1, "accuracy": 0.9966666666666667}, {"doc_id": "EW-2-22626634-bd3f678897", "pages": 299, "correct": 299, "errors": 0, "accuracy": 1.0}, {"doc_id": "EW-2-22749098-1210016-2-bc0f64f4b3", "pages": 201, "correct": 201, "errors": 0, "accuracy": 1.0}, {"doc_id": "EW-2-22714892-06e937c20d", "pages": 132, "correct": 132, "errors": 0, "accuracy": 1.0}, {"doc_id": "EW-2-22733576-1209605-1-1878fb1ffc", "pages": 121, "correct": 121, "errors": 0, "accuracy": 1.0}, {"doc_id": "EW-2-22783818-1214336-2-f1ca841e7c", "pages": 102, "correct": 102, "errors": 0, "accuracy": 1.0}, {"doc_id": "EW-2-22765157-1213045-2-1233915842", "pages": 97, "correct": 97, "errors": 0, "accuracy": 1.0}, {"doc_id": "EW-2-22772688-1214689-2-11c3317139", "pages": 77, "correct": 77, "errors": 0, "accuracy": 1.0}, {"doc_id": "EW-2-22744759-1212266-1-d8f40c6802", "pages": 69, "correct": 69, "errors": 0, "accuracy": 1.0}, {"doc_id": "EW-2-22765187-1212241-1-30bcaf7bba", "pages": 62, "correct": 62, "errors": 0, "accuracy": 1.0}, {"doc_id": "EW-2-22774058-1216031-1-ad9cd6f12f", "pages": 38, "correct": 38, "errors": 0, "accuracy": 1.0}, {"doc_id": "EW-2-22749717-1213901-2-dd17fec400", "pages": 36, "correct": 36, "errors": 0, "accuracy": 1.0}, {"doc_id": "EW-2-22765187-1212241-2-431c70469e", "pages": 16, "correct": 16, "errors": 0, "accuracy": 1.0}], "samples": [{"doc_id": "EW-2-22749717-1213901-2-dd17fec400", "page_index": 20, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.9948364496231079, "correct": true, "image_rel_path": "test/pages/EW-2-22749717-1213901-2-dd17fec400_p00021.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22749717-1213901-2-dd17fec400_p00021.png", "bucket": "best_doc", "before_rel_path": "assets/before/001_best_doc_EW-2-22749717-1213901-2-dd17fec400_p00021.png", "after_rel_path": "assets/after/001_best_doc_EW-2-22749717-1213901-2-dd17fec400_p00021.png", "panel_rel_path": "assets/panel/001_best_doc_EW-2-22749717-1213901-2-dd17fec400_p00021.png"}, {"doc_id": "EW-2-22749717-1213901-2-dd17fec400", "page_index": 21, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.9941232800483704, "correct": true, "image_rel_path": "test/pages/EW-2-22749717-1213901-2-dd17fec400_p00022.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22749717-1213901-2-dd17fec400_p00022.png", "bucket": "best_doc", "before_rel_path": "assets/before/002_best_doc_EW-2-22749717-1213901-2-dd17fec400_p00022.png", "after_rel_path": "assets/after/002_best_doc_EW-2-22749717-1213901-2-dd17fec400_p00022.png", "panel_rel_path": "assets/panel/002_best_doc_EW-2-22749717-1213901-2-dd17fec400_p00022.png"}, {"doc_id": "EW-2-22749717-1213901-2-dd17fec400", "page_index": 23, "true_rotation_deg": 270, "predicted_rotation_deg": 270, "confidence": 0.9949290752410889, "correct": true, "image_rel_path": "test/pages/EW-2-22749717-1213901-2-dd17fec400_p00024.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22749717-1213901-2-dd17fec400_p00024.png", "bucket": "best_doc", "before_rel_path": "assets/before/003_best_doc_EW-2-22749717-1213901-2-dd17fec400_p00024.png", "after_rel_path": "assets/after/003_best_doc_EW-2-22749717-1213901-2-dd17fec400_p00024.png", "panel_rel_path": "assets/panel/003_best_doc_EW-2-22749717-1213901-2-dd17fec400_p00024.png"}, {"doc_id": "EW-2-22765187-1212241-1-30bcaf7bba", "page_index": 27, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.9907413721084595, "correct": true, "image_rel_path": "test/pages/EW-2-22765187-1212241-1-30bcaf7bba_p00028.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22765187-1212241-1-30bcaf7bba_p00028.png", "bucket": "best_doc", "before_rel_path": "assets/before/004_best_doc_EW-2-22765187-1212241-1-30bcaf7bba_p00028.png", "after_rel_path": "assets/after/004_best_doc_EW-2-22765187-1212241-1-30bcaf7bba_p00028.png", "panel_rel_path": "assets/panel/004_best_doc_EW-2-22765187-1212241-1-30bcaf7bba_p00028.png"}, {"doc_id": "EW-2-22765187-1212241-1-30bcaf7bba", "page_index": 40, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.9884740710258484, "correct": true, "image_rel_path": "test/pages/EW-2-22765187-1212241-1-30bcaf7bba_p00041.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22765187-1212241-1-30bcaf7bba_p00041.png", "bucket": "best_doc", "before_rel_path": "assets/before/005_best_doc_EW-2-22765187-1212241-1-30bcaf7bba_p00041.png", "after_rel_path": "assets/after/005_best_doc_EW-2-22765187-1212241-1-30bcaf7bba_p00041.png", "panel_rel_path": "assets/panel/005_best_doc_EW-2-22765187-1212241-1-30bcaf7bba_p00041.png"}, {"doc_id": "EW-2-22765187-1212241-1-30bcaf7bba", "page_index": 66, "true_rotation_deg": 270, "predicted_rotation_deg": 270, "confidence": 0.9885159730911255, "correct": true, "image_rel_path": "test/pages/EW-2-22765187-1212241-1-30bcaf7bba_p00067.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22765187-1212241-1-30bcaf7bba_p00067.png", "bucket": "best_doc", "before_rel_path": "assets/before/006_best_doc_EW-2-22765187-1212241-1-30bcaf7bba_p00067.png", "after_rel_path": "assets/after/006_best_doc_EW-2-22765187-1212241-1-30bcaf7bba_p00067.png", "panel_rel_path": "assets/panel/006_best_doc_EW-2-22765187-1212241-1-30bcaf7bba_p00067.png"}, {"doc_id": "EW-2-22774058-1216031-1-ad9cd6f12f", "page_index": 1, "true_rotation_deg": 180, "predicted_rotation_deg": 180, "confidence": 0.9883589744567871, "correct": true, "image_rel_path": "test/pages/EW-2-22774058-1216031-1-ad9cd6f12f_p00002.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22774058-1216031-1-ad9cd6f12f_p00002.png", "bucket": "best_doc", "before_rel_path": "assets/before/007_best_doc_EW-2-22774058-1216031-1-ad9cd6f12f_p00002.png", "after_rel_path": "assets/after/007_best_doc_EW-2-22774058-1216031-1-ad9cd6f12f_p00002.png", "panel_rel_path": "assets/panel/007_best_doc_EW-2-22774058-1216031-1-ad9cd6f12f_p00002.png"}, {"doc_id": "EW-2-22774058-1216031-1-ad9cd6f12f", "page_index": 20, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.9900424480438232, "correct": true, "image_rel_path": "test/pages/EW-2-22774058-1216031-1-ad9cd6f12f_p00021.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22774058-1216031-1-ad9cd6f12f_p00021.png", "bucket": "best_doc", "before_rel_path": "assets/before/008_best_doc_EW-2-22774058-1216031-1-ad9cd6f12f_p00021.png", "after_rel_path": "assets/after/008_best_doc_EW-2-22774058-1216031-1-ad9cd6f12f_p00021.png", "panel_rel_path": "assets/panel/008_best_doc_EW-2-22774058-1216031-1-ad9cd6f12f_p00021.png"}, {"doc_id": "EW-2-22774058-1216031-1-ad9cd6f12f", "page_index": 28, "true_rotation_deg": 270, "predicted_rotation_deg": 270, "confidence": 0.9884973764419556, "correct": true, "image_rel_path": "test/pages/EW-2-22774058-1216031-1-ad9cd6f12f_p00029.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22774058-1216031-1-ad9cd6f12f_p00029.png", "bucket": "best_doc", "before_rel_path": "assets/before/009_best_doc_EW-2-22774058-1216031-1-ad9cd6f12f_p00029.png", "after_rel_path": "assets/after/009_best_doc_EW-2-22774058-1216031-1-ad9cd6f12f_p00029.png", "panel_rel_path": "assets/panel/009_best_doc_EW-2-22774058-1216031-1-ad9cd6f12f_p00029.png"}, {"doc_id": "EW-2-22696801-705c326024", "page_index": 63, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.9991806149482727, "correct": true, "image_rel_path": "test/pages/EW-2-22696801-705c326024_p00064.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22696801-705c326024_p00064.png", "bucket": "global_fill", "before_rel_path": "assets/before/010_global_fill_EW-2-22696801-705c326024_p00064.png", "after_rel_path": "assets/after/010_global_fill_EW-2-22696801-705c326024_p00064.png", "panel_rel_path": "assets/panel/010_global_fill_EW-2-22696801-705c326024_p00064.png"}, {"doc_id": "EW-2-22696801-705c326024", "page_index": 322, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.9991949200630188, "correct": true, "image_rel_path": "test/pages/EW-2-22696801-705c326024_p00323.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22696801-705c326024_p00323.png", "bucket": "global_fill", "before_rel_path": "assets/before/011_global_fill_EW-2-22696801-705c326024_p00323.png", "after_rel_path": "assets/after/011_global_fill_EW-2-22696801-705c326024_p00323.png", "panel_rel_path": "assets/panel/011_global_fill_EW-2-22696801-705c326024_p00323.png"}, {"doc_id": "EW-2-22697155-5c367b1d0d", "page_index": 18, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.999135434627533, "correct": true, "image_rel_path": "test/pages/EW-2-22697155-5c367b1d0d_p00019.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22697155-5c367b1d0d_p00019.png", "bucket": "global_fill", "before_rel_path": "assets/before/012_global_fill_EW-2-22697155-5c367b1d0d_p00019.png", "after_rel_path": "assets/after/012_global_fill_EW-2-22697155-5c367b1d0d_p00019.png", "panel_rel_path": "assets/panel/012_global_fill_EW-2-22697155-5c367b1d0d_p00019.png"}, {"doc_id": "EW-2-22697155-5c367b1d0d", "page_index": 103, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.9990273714065552, "correct": true, "image_rel_path": "test/pages/EW-2-22697155-5c367b1d0d_p00104.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22697155-5c367b1d0d_p00104.png", "bucket": "global_fill", "before_rel_path": "assets/before/013_global_fill_EW-2-22697155-5c367b1d0d_p00104.png", "after_rel_path": "assets/after/013_global_fill_EW-2-22697155-5c367b1d0d_p00104.png", "panel_rel_path": "assets/panel/013_global_fill_EW-2-22697155-5c367b1d0d_p00104.png"}, {"doc_id": "EW-2-22697155-5c367b1d0d", "page_index": 165, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.999182403087616, "correct": true, "image_rel_path": "test/pages/EW-2-22697155-5c367b1d0d_p00166.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22697155-5c367b1d0d_p00166.png", "bucket": "global_fill", "before_rel_path": "assets/before/014_global_fill_EW-2-22697155-5c367b1d0d_p00166.png", "after_rel_path": "assets/after/014_global_fill_EW-2-22697155-5c367b1d0d_p00166.png", "panel_rel_path": "assets/panel/014_global_fill_EW-2-22697155-5c367b1d0d_p00166.png"}, {"doc_id": "EW-2-22697155-5c367b1d0d", "page_index": 379, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.9988898634910583, "correct": true, "image_rel_path": "test/pages/EW-2-22697155-5c367b1d0d_p00380.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22697155-5c367b1d0d_p00380.png", "bucket": "global_fill", "before_rel_path": "assets/before/015_global_fill_EW-2-22697155-5c367b1d0d_p00380.png", "after_rel_path": "assets/after/015_global_fill_EW-2-22697155-5c367b1d0d_p00380.png", "panel_rel_path": "assets/panel/015_global_fill_EW-2-22697155-5c367b1d0d_p00380.png"}, {"doc_id": "EW-2-22749098-1210016-2-bc0f64f4b3", "page_index": 19, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.9993053674697876, "correct": true, "image_rel_path": "test/pages/EW-2-22749098-1210016-2-bc0f64f4b3_p00020.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22749098-1210016-2-bc0f64f4b3_p00020.png", "bucket": "global_fill", "before_rel_path": "assets/before/016_global_fill_EW-2-22749098-1210016-2-bc0f64f4b3_p00020.png", "after_rel_path": "assets/after/016_global_fill_EW-2-22749098-1210016-2-bc0f64f4b3_p00020.png", "panel_rel_path": "assets/panel/016_global_fill_EW-2-22749098-1210016-2-bc0f64f4b3_p00020.png"}, {"doc_id": "EW-2-22749098-1210016-2-bc0f64f4b3", "page_index": 33, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.9988462924957275, "correct": true, "image_rel_path": "test/pages/EW-2-22749098-1210016-2-bc0f64f4b3_p00034.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22749098-1210016-2-bc0f64f4b3_p00034.png", "bucket": "global_fill", "before_rel_path": "assets/before/017_global_fill_EW-2-22749098-1210016-2-bc0f64f4b3_p00034.png", "after_rel_path": "assets/after/017_global_fill_EW-2-22749098-1210016-2-bc0f64f4b3_p00034.png", "panel_rel_path": "assets/panel/017_global_fill_EW-2-22749098-1210016-2-bc0f64f4b3_p00034.png"}, {"doc_id": "EW-2-22749098-1210016-2-bc0f64f4b3", "page_index": 146, "true_rotation_deg": 270, "predicted_rotation_deg": 270, "confidence": 0.9989314675331116, "correct": true, "image_rel_path": "test/pages/EW-2-22749098-1210016-2-bc0f64f4b3_p00147.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22749098-1210016-2-bc0f64f4b3_p00147.png", "bucket": "global_fill", "before_rel_path": "assets/before/018_global_fill_EW-2-22749098-1210016-2-bc0f64f4b3_p00147.png", "after_rel_path": "assets/after/018_global_fill_EW-2-22749098-1210016-2-bc0f64f4b3_p00147.png", "panel_rel_path": "assets/panel/018_global_fill_EW-2-22749098-1210016-2-bc0f64f4b3_p00147.png"}, {"doc_id": "EW-2-22765157-1213045-2-1233915842", "page_index": 6, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.9992315769195557, "correct": true, "image_rel_path": "test/pages/EW-2-22765157-1213045-2-1233915842_p00007.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22765157-1213045-2-1233915842_p00007.png", "bucket": "global_fill", "before_rel_path": "assets/before/019_global_fill_EW-2-22765157-1213045-2-1233915842_p00007.png", "after_rel_path": "assets/after/019_global_fill_EW-2-22765157-1213045-2-1233915842_p00007.png", "panel_rel_path": "assets/panel/019_global_fill_EW-2-22765157-1213045-2-1233915842_p00007.png"}, {"doc_id": "EW-2-22765157-1213045-2-1233915842", "page_index": 59, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.999103844165802, "correct": true, "image_rel_path": "test/pages/EW-2-22765157-1213045-2-1233915842_p00060.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22765157-1213045-2-1233915842_p00060.png", "bucket": "global_fill", "before_rel_path": "assets/before/020_global_fill_EW-2-22765157-1213045-2-1233915842_p00060.png", "after_rel_path": "assets/after/020_global_fill_EW-2-22765157-1213045-2-1233915842_p00060.png", "panel_rel_path": "assets/panel/020_global_fill_EW-2-22765157-1213045-2-1233915842_p00060.png"}, {"doc_id": "EW-2-22626634-bd3f678897", "page_index": 3, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.9949813485145569, "correct": true, "image_rel_path": "test/pages/EW-2-22626634-bd3f678897_p00004.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22626634-bd3f678897_p00004.png", "bucket": "worst_doc", "before_rel_path": "assets/before/021_worst_doc_EW-2-22626634-bd3f678897_p00004.png", "after_rel_path": "assets/after/021_worst_doc_EW-2-22626634-bd3f678897_p00004.png", "panel_rel_path": "assets/panel/021_worst_doc_EW-2-22626634-bd3f678897_p00004.png"}, {"doc_id": "EW-2-22626634-bd3f678897", "page_index": 318, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.9940166473388672, "correct": true, "image_rel_path": "test/pages/EW-2-22626634-bd3f678897_p00319.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22626634-bd3f678897_p00319.png", "bucket": "worst_doc", "before_rel_path": "assets/before/022_worst_doc_EW-2-22626634-bd3f678897_p00319.png", "after_rel_path": "assets/after/022_worst_doc_EW-2-22626634-bd3f678897_p00319.png", "panel_rel_path": "assets/panel/022_worst_doc_EW-2-22626634-bd3f678897_p00319.png"}, {"doc_id": "EW-2-22626634-bd3f678897", "page_index": 369, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.9939179420471191, "correct": true, "image_rel_path": "test/pages/EW-2-22626634-bd3f678897_p00370.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22626634-bd3f678897_p00370.png", "bucket": "worst_doc", "before_rel_path": "assets/before/023_worst_doc_EW-2-22626634-bd3f678897_p00370.png", "after_rel_path": "assets/after/023_worst_doc_EW-2-22626634-bd3f678897_p00370.png", "panel_rel_path": "assets/panel/023_worst_doc_EW-2-22626634-bd3f678897_p00370.png"}, {"doc_id": "EW-2-22696801-705c326024", "page_index": 68, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.9992220401763916, "correct": true, "image_rel_path": "test/pages/EW-2-22696801-705c326024_p00069.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22696801-705c326024_p00069.png", "bucket": "worst_doc", "before_rel_path": "assets/before/024_worst_doc_EW-2-22696801-705c326024_p00069.png", "after_rel_path": "assets/after/024_worst_doc_EW-2-22696801-705c326024_p00069.png", "panel_rel_path": "assets/panel/024_worst_doc_EW-2-22696801-705c326024_p00069.png"}, {"doc_id": "EW-2-22696801-705c326024", "page_index": 260, "true_rotation_deg": 270, "predicted_rotation_deg": 90, "confidence": 0.8264777064323425, "correct": false, "image_rel_path": "test/pages/EW-2-22696801-705c326024_p00261.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22696801-705c326024_p00261.png", "bucket": "worst_doc", "before_rel_path": "assets/before/025_worst_doc_EW-2-22696801-705c326024_p00261.png", "after_rel_path": "assets/after/025_worst_doc_EW-2-22696801-705c326024_p00261.png", "panel_rel_path": "assets/panel/025_worst_doc_EW-2-22696801-705c326024_p00261.png"}, {"doc_id": "EW-2-22696801-705c326024", "page_index": 323, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.9996002316474915, "correct": true, "image_rel_path": "test/pages/EW-2-22696801-705c326024_p00324.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22696801-705c326024_p00324.png", "bucket": "worst_doc", "before_rel_path": "assets/before/026_worst_doc_EW-2-22696801-705c326024_p00324.png", "after_rel_path": "assets/after/026_worst_doc_EW-2-22696801-705c326024_p00324.png", "panel_rel_path": "assets/panel/026_worst_doc_EW-2-22696801-705c326024_p00324.png"}, {"doc_id": "EW-2-22697155-5c367b1d0d", "page_index": 59, "true_rotation_deg": 90, "predicted_rotation_deg": 270, "confidence": 0.3294405937194824, "correct": false, "image_rel_path": "test/pages/EW-2-22697155-5c367b1d0d_p00060.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22697155-5c367b1d0d_p00060.png", "bucket": "worst_doc", "before_rel_path": "assets/before/027_worst_doc_EW-2-22697155-5c367b1d0d_p00060.png", "after_rel_path": "assets/after/027_worst_doc_EW-2-22697155-5c367b1d0d_p00060.png", "panel_rel_path": "assets/panel/027_worst_doc_EW-2-22697155-5c367b1d0d_p00060.png"}, {"doc_id": "EW-2-22697155-5c367b1d0d", "page_index": 106, "true_rotation_deg": 180, "predicted_rotation_deg": 90, "confidence": 0.6514086127281189, "correct": false, "image_rel_path": "test/pages/EW-2-22697155-5c367b1d0d_p00107.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22697155-5c367b1d0d_p00107.png", "bucket": "worst_doc", "before_rel_path": "assets/before/028_worst_doc_EW-2-22697155-5c367b1d0d_p00107.png", "after_rel_path": "assets/after/028_worst_doc_EW-2-22697155-5c367b1d0d_p00107.png", "panel_rel_path": "assets/panel/028_worst_doc_EW-2-22697155-5c367b1d0d_p00107.png"}, {"doc_id": "EW-2-22697155-5c367b1d0d", "page_index": 396, "true_rotation_deg": 90, "predicted_rotation_deg": 180, "confidence": 0.45590731501579285, "correct": false, "image_rel_path": "test/pages/EW-2-22697155-5c367b1d0d_p00397.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22697155-5c367b1d0d_p00397.png", "bucket": "worst_doc", "before_rel_path": "assets/before/029_worst_doc_EW-2-22697155-5c367b1d0d_p00397.png", "after_rel_path": "assets/after/029_worst_doc_EW-2-22697155-5c367b1d0d_p00397.png", "panel_rel_path": "assets/panel/029_worst_doc_EW-2-22697155-5c367b1d0d_p00397.png"}, {"doc_id": "EW-2-22714892-06e937c20d", "page_index": 114, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.9986464381217957, "correct": true, "image_rel_path": "test/pages/EW-2-22714892-06e937c20d_p00115.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22714892-06e937c20d_p00115.png", "bucket": "worst_doc", "before_rel_path": "assets/before/030_worst_doc_EW-2-22714892-06e937c20d_p00115.png", "after_rel_path": "assets/after/030_worst_doc_EW-2-22714892-06e937c20d_p00115.png", "panel_rel_path": "assets/panel/030_worst_doc_EW-2-22714892-06e937c20d_p00115.png"}, {"doc_id": "EW-2-22714892-06e937c20d", "page_index": 151, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.9980995059013367, "correct": true, "image_rel_path": "test/pages/EW-2-22714892-06e937c20d_p00152.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22714892-06e937c20d_p00152.png", "bucket": "worst_doc", "before_rel_path": "assets/before/031_worst_doc_EW-2-22714892-06e937c20d_p00152.png", "after_rel_path": "assets/after/031_worst_doc_EW-2-22714892-06e937c20d_p00152.png", "panel_rel_path": "assets/panel/031_worst_doc_EW-2-22714892-06e937c20d_p00152.png"}, {"doc_id": "EW-2-22714892-06e937c20d", "page_index": 172, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.9984737038612366, "correct": true, "image_rel_path": "test/pages/EW-2-22714892-06e937c20d_p00173.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22714892-06e937c20d_p00173.png", "bucket": "worst_doc", "before_rel_path": "assets/before/032_worst_doc_EW-2-22714892-06e937c20d_p00173.png", "after_rel_path": "assets/after/032_worst_doc_EW-2-22714892-06e937c20d_p00173.png", "panel_rel_path": "assets/panel/032_worst_doc_EW-2-22714892-06e937c20d_p00173.png"}, {"doc_id": "EW-2-22733576-1209605-1-1878fb1ffc", "page_index": 41, "true_rotation_deg": 180, "predicted_rotation_deg": 180, "confidence": 0.997605562210083, "correct": true, "image_rel_path": "test/pages/EW-2-22733576-1209605-1-1878fb1ffc_p00042.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22733576-1209605-1-1878fb1ffc_p00042.png", "bucket": "worst_doc", "before_rel_path": "assets/before/033_worst_doc_EW-2-22733576-1209605-1-1878fb1ffc_p00042.png", "after_rel_path": "assets/after/033_worst_doc_EW-2-22733576-1209605-1-1878fb1ffc_p00042.png", "panel_rel_path": "assets/panel/033_worst_doc_EW-2-22733576-1209605-1-1878fb1ffc_p00042.png"}, {"doc_id": "EW-2-22733576-1209605-1-1878fb1ffc", "page_index": 52, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.9979673027992249, "correct": true, "image_rel_path": "test/pages/EW-2-22733576-1209605-1-1878fb1ffc_p00053.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22733576-1209605-1-1878fb1ffc_p00053.png", "bucket": "worst_doc", "before_rel_path": "assets/before/034_worst_doc_EW-2-22733576-1209605-1-1878fb1ffc_p00053.png", "after_rel_path": "assets/after/034_worst_doc_EW-2-22733576-1209605-1-1878fb1ffc_p00053.png", "panel_rel_path": "assets/panel/034_worst_doc_EW-2-22733576-1209605-1-1878fb1ffc_p00053.png"}, {"doc_id": "EW-2-22733576-1209605-1-1878fb1ffc", "page_index": 118, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.9983487129211426, "correct": true, "image_rel_path": "test/pages/EW-2-22733576-1209605-1-1878fb1ffc_p00119.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22733576-1209605-1-1878fb1ffc_p00119.png", "bucket": "worst_doc", "before_rel_path": "assets/before/035_worst_doc_EW-2-22733576-1209605-1-1878fb1ffc_p00119.png", "after_rel_path": "assets/after/035_worst_doc_EW-2-22733576-1209605-1-1878fb1ffc_p00119.png", "panel_rel_path": "assets/panel/035_worst_doc_EW-2-22733576-1209605-1-1878fb1ffc_p00119.png"}, {"doc_id": "EW-2-22744759-1212266-1-d8f40c6802", "page_index": 74, "true_rotation_deg": 270, "predicted_rotation_deg": 270, "confidence": 0.9987419247627258, "correct": true, "image_rel_path": "test/pages/EW-2-22744759-1212266-1-d8f40c6802_p00075.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22744759-1212266-1-d8f40c6802_p00075.png", "bucket": "worst_doc", "before_rel_path": "assets/before/036_worst_doc_EW-2-22744759-1212266-1-d8f40c6802_p00075.png", "after_rel_path": "assets/after/036_worst_doc_EW-2-22744759-1212266-1-d8f40c6802_p00075.png", "panel_rel_path": "assets/panel/036_worst_doc_EW-2-22744759-1212266-1-d8f40c6802_p00075.png"}, {"doc_id": "EW-2-22744759-1212266-1-d8f40c6802", "page_index": 75, "true_rotation_deg": 270, "predicted_rotation_deg": 270, "confidence": 0.9984706044197083, "correct": true, "image_rel_path": "test/pages/EW-2-22744759-1212266-1-d8f40c6802_p00076.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22744759-1212266-1-d8f40c6802_p00076.png", "bucket": "worst_doc", "before_rel_path": "assets/before/037_worst_doc_EW-2-22744759-1212266-1-d8f40c6802_p00076.png", "after_rel_path": "assets/after/037_worst_doc_EW-2-22744759-1212266-1-d8f40c6802_p00076.png", "panel_rel_path": "assets/panel/037_worst_doc_EW-2-22744759-1212266-1-d8f40c6802_p00076.png"}, {"doc_id": "EW-2-22744759-1212266-1-d8f40c6802", "page_index": 77, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.9982494115829468, "correct": true, "image_rel_path": "test/pages/EW-2-22744759-1212266-1-d8f40c6802_p00078.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22744759-1212266-1-d8f40c6802_p00078.png", "bucket": "worst_doc", "before_rel_path": "assets/before/038_worst_doc_EW-2-22744759-1212266-1-d8f40c6802_p00078.png", "after_rel_path": "assets/after/038_worst_doc_EW-2-22744759-1212266-1-d8f40c6802_p00078.png", "panel_rel_path": "assets/panel/038_worst_doc_EW-2-22744759-1212266-1-d8f40c6802_p00078.png"}, {"doc_id": "EW-2-22749098-1210016-2-bc0f64f4b3", "page_index": 17, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.9994718432426453, "correct": true, "image_rel_path": "test/pages/EW-2-22749098-1210016-2-bc0f64f4b3_p00018.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22749098-1210016-2-bc0f64f4b3_p00018.png", "bucket": "worst_doc", "before_rel_path": "assets/before/039_worst_doc_EW-2-22749098-1210016-2-bc0f64f4b3_p00018.png", "after_rel_path": "assets/after/039_worst_doc_EW-2-22749098-1210016-2-bc0f64f4b3_p00018.png", "panel_rel_path": "assets/panel/039_worst_doc_EW-2-22749098-1210016-2-bc0f64f4b3_p00018.png"}, {"doc_id": "EW-2-22749098-1210016-2-bc0f64f4b3", "page_index": 23, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.9993566870689392, "correct": true, "image_rel_path": "test/pages/EW-2-22749098-1210016-2-bc0f64f4b3_p00024.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22749098-1210016-2-bc0f64f4b3_p00024.png", "bucket": "worst_doc", "before_rel_path": "assets/before/040_worst_doc_EW-2-22749098-1210016-2-bc0f64f4b3_p00024.png", "after_rel_path": "assets/after/040_worst_doc_EW-2-22749098-1210016-2-bc0f64f4b3_p00024.png", "panel_rel_path": "assets/panel/040_worst_doc_EW-2-22749098-1210016-2-bc0f64f4b3_p00024.png"}, {"doc_id": "EW-2-22749098-1210016-2-bc0f64f4b3", "page_index": 149, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.9993246793746948, "correct": true, "image_rel_path": "test/pages/EW-2-22749098-1210016-2-bc0f64f4b3_p00150.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22749098-1210016-2-bc0f64f4b3_p00150.png", "bucket": "worst_doc", "before_rel_path": "assets/before/041_worst_doc_EW-2-22749098-1210016-2-bc0f64f4b3_p00150.png", "after_rel_path": "assets/after/041_worst_doc_EW-2-22749098-1210016-2-bc0f64f4b3_p00150.png", "panel_rel_path": "assets/panel/041_worst_doc_EW-2-22749098-1210016-2-bc0f64f4b3_p00150.png"}, {"doc_id": "EW-2-22765157-1213045-2-1233915842", "page_index": 42, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.9993419051170349, "correct": true, "image_rel_path": "test/pages/EW-2-22765157-1213045-2-1233915842_p00043.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22765157-1213045-2-1233915842_p00043.png", "bucket": "worst_doc", "before_rel_path": "assets/before/042_worst_doc_EW-2-22765157-1213045-2-1233915842_p00043.png", "after_rel_path": "assets/after/042_worst_doc_EW-2-22765157-1213045-2-1233915842_p00043.png", "panel_rel_path": "assets/panel/042_worst_doc_EW-2-22765157-1213045-2-1233915842_p00043.png"}, {"doc_id": "EW-2-22765157-1213045-2-1233915842", "page_index": 83, "true_rotation_deg": 270, "predicted_rotation_deg": 270, "confidence": 0.9993962049484253, "correct": true, "image_rel_path": "test/pages/EW-2-22765157-1213045-2-1233915842_p00084.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22765157-1213045-2-1233915842_p00084.png", "bucket": "worst_doc", "before_rel_path": "assets/before/043_worst_doc_EW-2-22765157-1213045-2-1233915842_p00084.png", "after_rel_path": "assets/after/043_worst_doc_EW-2-22765157-1213045-2-1233915842_p00084.png", "panel_rel_path": "assets/panel/043_worst_doc_EW-2-22765157-1213045-2-1233915842_p00084.png"}, {"doc_id": "EW-2-22765157-1213045-2-1233915842", "page_index": 87, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.9995580315589905, "correct": true, "image_rel_path": "test/pages/EW-2-22765157-1213045-2-1233915842_p00088.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22765157-1213045-2-1233915842_p00088.png", "bucket": "worst_doc", "before_rel_path": "assets/before/044_worst_doc_EW-2-22765157-1213045-2-1233915842_p00088.png", "after_rel_path": "assets/after/044_worst_doc_EW-2-22765157-1213045-2-1233915842_p00088.png", "panel_rel_path": "assets/panel/044_worst_doc_EW-2-22765157-1213045-2-1233915842_p00088.png"}, {"doc_id": "EW-2-22772688-1214689-2-11c3317139", "page_index": 18, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.9921149611473083, "correct": true, "image_rel_path": "test/pages/EW-2-22772688-1214689-2-11c3317139_p00019.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22772688-1214689-2-11c3317139_p00019.png", "bucket": "worst_doc", "before_rel_path": "assets/before/045_worst_doc_EW-2-22772688-1214689-2-11c3317139_p00019.png", "after_rel_path": "assets/after/045_worst_doc_EW-2-22772688-1214689-2-11c3317139_p00019.png", "panel_rel_path": "assets/panel/045_worst_doc_EW-2-22772688-1214689-2-11c3317139_p00019.png"}, {"doc_id": "EW-2-22772688-1214689-2-11c3317139", "page_index": 56, "true_rotation_deg": 270, "predicted_rotation_deg": 270, "confidence": 0.9887719750404358, "correct": true, "image_rel_path": "test/pages/EW-2-22772688-1214689-2-11c3317139_p00057.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22772688-1214689-2-11c3317139_p00057.png", "bucket": "worst_doc", "before_rel_path": "assets/before/046_worst_doc_EW-2-22772688-1214689-2-11c3317139_p00057.png", "after_rel_path": "assets/after/046_worst_doc_EW-2-22772688-1214689-2-11c3317139_p00057.png", "panel_rel_path": "assets/panel/046_worst_doc_EW-2-22772688-1214689-2-11c3317139_p00057.png"}, {"doc_id": "EW-2-22772688-1214689-2-11c3317139", "page_index": 70, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.9899482727050781, "correct": true, "image_rel_path": "test/pages/EW-2-22772688-1214689-2-11c3317139_p00071.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22772688-1214689-2-11c3317139_p00071.png", "bucket": "worst_doc", "before_rel_path": "assets/before/047_worst_doc_EW-2-22772688-1214689-2-11c3317139_p00071.png", "after_rel_path": "assets/after/047_worst_doc_EW-2-22772688-1214689-2-11c3317139_p00071.png", "panel_rel_path": "assets/panel/047_worst_doc_EW-2-22772688-1214689-2-11c3317139_p00071.png"}, {"doc_id": "EW-2-22783818-1214336-2-f1ca841e7c", "page_index": 39, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.9977558255195618, "correct": true, "image_rel_path": "test/pages/EW-2-22783818-1214336-2-f1ca841e7c_p00040.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22783818-1214336-2-f1ca841e7c_p00040.png", "bucket": "worst_doc", "before_rel_path": "assets/before/048_worst_doc_EW-2-22783818-1214336-2-f1ca841e7c_p00040.png", "after_rel_path": "assets/after/048_worst_doc_EW-2-22783818-1214336-2-f1ca841e7c_p00040.png", "panel_rel_path": "assets/panel/048_worst_doc_EW-2-22783818-1214336-2-f1ca841e7c_p00040.png"}, {"doc_id": "EW-2-22783818-1214336-2-f1ca841e7c", "page_index": 62, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.9977431297302246, "correct": true, "image_rel_path": "test/pages/EW-2-22783818-1214336-2-f1ca841e7c_p00063.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22783818-1214336-2-f1ca841e7c_p00063.png", "bucket": "worst_doc", "before_rel_path": "assets/before/049_worst_doc_EW-2-22783818-1214336-2-f1ca841e7c_p00063.png", "after_rel_path": "assets/after/049_worst_doc_EW-2-22783818-1214336-2-f1ca841e7c_p00063.png", "panel_rel_path": "assets/panel/049_worst_doc_EW-2-22783818-1214336-2-f1ca841e7c_p00063.png"}, {"doc_id": "EW-2-22783818-1214336-2-f1ca841e7c", "page_index": 78, "true_rotation_deg": 90, "predicted_rotation_deg": 90, "confidence": 0.9977739453315735, "correct": true, "image_rel_path": "test/pages/EW-2-22783818-1214336-2-f1ca841e7c_p00079.png", "image_abs_path": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/test/pages/EW-2-22783818-1214336-2-f1ca841e7c_p00079.png", "bucket": "worst_doc", "before_rel_path": "assets/before/050_worst_doc_EW-2-22783818-1214336-2-f1ca841e7c_p00079.png", "after_rel_path": "assets/after/050_worst_doc_EW-2-22783818-1214336-2-f1ca841e7c_p00079.png", "panel_rel_path": "assets/panel/050_worst_doc_EW-2-22783818-1214336-2-f1ca841e7c_p00079.png"}], "pages_dir": "/Users/helios/rotation-detection/runs/final_run_cap10k_v2/eval_test_postprocess_locked_from_val/visualize_50/assets/panel"};
    const samples = data.samples || [];
    const byDoc = new Map((data.doc_stats || []).map((d) => [d.doc_id, d]));

    const topStats = document.getElementById('topStats');
    const worstDocs = document.getElementById('worstDocs');
    const bestDocs = document.getElementById('bestDocs');
    const cards = document.getElementById('cards');
    const count = document.getElementById('count');

    function chip(text) {
      const span = document.createElement('span');
      span.className = 'chip';
      span.textContent = text;
      return span;
    }

    topStats.appendChild(chip(`split=${data.split}`));
    topStats.appendChild(chip(`samples=${samples.length}`));
    topStats.appendChild(chip(`prediction_field=${data.prediction_field}`));
    topStats.appendChild(chip(`matched_pages=${data.matched_pages}`));

    function renderDocList(container, docIds) {
      container.innerHTML = '';
      for (const docId of docIds) {
        const st = byDoc.get(docId);
        const li = document.createElement('li');
        if (st) {
          li.textContent = `${docId} (acc=${st.accuracy.toFixed(4)}, pages=${st.pages}, err=${st.errors})`;
        } else {
          li.textContent = docId;
        }
        container.appendChild(li);
      }
    }

    renderDocList(worstDocs, data.worst_docs || []);
    renderDocList(bestDocs, data.top_docs || []);

    const bucketEl = document.getElementById('bucket');
    const correctEl = document.getElementById('correct');
    const docEl = document.getElementById('doc');
    const minConfEl = document.getElementById('minConf');

    function passesFilter(s) {
      if (bucketEl.value !== 'all' && s.bucket !== bucketEl.value) return false;
      if (correctEl.value === 'correct' && !s.correct) return false;
      if (correctEl.value === 'wrong' && s.correct) return false;
      const q = docEl.value.trim().toLowerCase();
      if (q && !String(s.doc_id).toLowerCase().includes(q)) return false;
      const minConf = Number(minConfEl.value || 0);
      if (Number.isFinite(minConf) && s.confidence < minConf) return false;
      return true;
    }

    function render() {
      cards.innerHTML = '';
      const filtered = samples.filter(passesFilter);
      count.textContent = `showing ${filtered.length} / ${samples.length} samples`;

      for (const s of filtered) {
        const card = document.createElement('article');
        card.className = 'card';

        const head = document.createElement('div');
        head.className = 'card-head';

        const status = document.createElement('span');
        status.className = `tag ${s.correct ? 'ok' : 'bad'}`;
        status.textContent = s.correct ? 'correct' : 'wrong';
        head.appendChild(status);

        const bucket = document.createElement('span');
        bucket.className = 'tag';
        bucket.textContent = s.bucket;
        head.appendChild(bucket);

        const m1 = document.createElement('span');
        m1.innerHTML = `<span class="k">doc</span> <span class="v">${s.doc_id}</span>`;
        const m2 = document.createElement('span');
        m2.innerHTML = `<span class="k">page</span> <span class="v">${s.page_index}</span>`;
        const m3 = document.createElement('span');
        m3.innerHTML = `<span class="k">true/pred</span> <span class="v">${s.true_rotation_deg} / ${s.predicted_rotation_deg}</span>`;
        const m4 = document.createElement('span');
        m4.innerHTML = `<span class="k">confidence</span> <span class="v">${Number(s.confidence).toFixed(4)}</span>`;
        head.appendChild(m1);
        head.appendChild(m2);
        head.appendChild(m3);
        head.appendChild(m4);

        const imgs = document.createElement('div');
        imgs.className = 'imgs';

        const p1 = document.createElement('div');
        p1.className = 'pane';
        p1.innerHTML = `<h4>Input</h4><img loading="lazy" src="${s.before_rel_path}" alt="input" />`;

        const p2 = document.createElement('div');
        p2.className = 'pane';
        p2.innerHTML = `<h4>Predicted Upright</h4><img loading="lazy" src="${s.after_rel_path}" alt="corrected" />`;

        imgs.appendChild(p1);
        imgs.appendChild(p2);

        card.appendChild(head);
        card.appendChild(imgs);
        cards.appendChild(card);
      }
    }

    [bucketEl, correctEl, docEl, minConfEl].forEach((el) => el.addEventListener('input', render));
    [bucketEl, correctEl].forEach((el) => el.addEventListener('change', render));
    render();
  </script>
</body>
</html>
