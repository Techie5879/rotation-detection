[logging] tee enabled log_file=/Users/helios/rotation-detection/runs/final_run_subset_cap500/models/orientation_cnn.train.log
[train] checkpoint=/Users/helios/rotation-detection/runs/final_run_subset_cap500/models/orientation_cnn.pt
[train] start memory {'rss_mb': 47.328125, 'ru_maxrss_mb': 47.34375, 'py_current_mb': 0.0, 'py_peak_mb': 0.0, 'torch_allocated_mb': None, 'torch_reserved_mb': None, 'torch_mps_driver_mb': None}
[train] rows train=6780 val=639
[train] init memory rss_mb=357.4 ru_maxrss_mb=357.4 py_current_mb=112.5 py_peak_mb=112.7 torch_allocated_mb=2.9 torch_mps_driver_mb=48.5
[train] epoch=001:   0%|          | 0/27 [00:00<?, ?batch/s][train] epoch=001:   0%|          | 0/27 [00:16<?, ?batch/s, acc=0.2227, loss=1.4135][train] epoch=001:   4%|▎         | 1/27 [00:16<07:00, 16.18s/batch, acc=0.2227, loss=1.4135][train] epoch=001:   4%|▎         | 1/27 [00:26<07:00, 16.18s/batch, acc=0.2637, loss=1.3848][train] epoch=001:   7%|▋         | 2/27 [00:26<05:25, 13.01s/batch, acc=0.2637, loss=1.3848][train] epoch=001:   7%|▋         | 2/27 [00:39<05:25, 13.01s/batch, acc=0.3060, loss=1.3488][train] epoch=001:  11%|█         | 3/27 [00:39<05:04, 12.69s/batch, acc=0.3060, loss=1.3488][train] epoch=001:  11%|█         | 3/27 [00:51<05:04, 12.69s/batch, acc=0.3447, loss=1.3067][train] epoch=001:  15%|█▍        | 4/27 [00:51<04:46, 12.46s/batch, acc=0.3447, loss=1.3067][train] epoch=001:  15%|█▍        | 4/27 [01:02<04:46, 12.46s/batch, acc=0.3906, loss=1.2610][train] epoch=001:  19%|█▊        | 5/27 [01:02<04:24, 12.04s/batch, acc=0.3906, loss=1.2610][train] epoch=001:  19%|█▊        | 5/27 [01:14<04:24, 12.04s/batch, acc=0.4232, loss=1.2241][train] epoch=001:  22%|██▏       | 6/27 [01:14<04:14, 12.11s/batch, acc=0.4232, loss=1.2241][train] epoch=001:  22%|██▏       | 6/27 [01:27<04:14, 12.11s/batch, acc=0.4459, loss=1.1897][train] epoch=001:  26%|██▌       | 7/27 [01:27<04:06, 12.34s/batch, acc=0.4459, loss=1.1897][train] epoch=001:  26%|██▌       | 7/27 [01:38<04:06, 12.34s/batch, acc=0.4526, loss=1.1627][train] epoch=001:  30%|██▉       | 8/27 [01:38<03:44, 11.81s/batch, acc=0.4526, loss=1.1627][train] epoch=001:  30%|██▉       | 8/27 [01:49<03:44, 11.81s/batch, acc=0.4696, loss=1.1350][train] epoch=001:  33%|███▎      | 9/27 [01:49<03:28, 11.60s/batch, acc=0.4696, loss=1.1350][train] epoch=001:  33%|███▎      | 9/27 [02:00<03:28, 11.60s/batch, acc=0.4805, loss=1.1133][train] epoch=001 batch=10/27 loss=1.1133 acc=0.4805 rss_mb=1346.9 ru_maxrss_mb=1346.9 py_current_mb=112.5 py_peak_mb=306.1 torch_allocated_mb=232.3 torch_mps_driver_mb=4676.1
[train] epoch=001:  37%|███▋      | 10/27 [02:00<03:15, 11.53s/batch, acc=0.4805, loss=1.1133][train] epoch=001:  37%|███▋      | 10/27 [02:12<03:15, 11.53s/batch, acc=0.4869, loss=1.0950][train] epoch=001:  41%|████      | 11/27 [02:12<03:02, 11.41s/batch, acc=0.4869, loss=1.0950][train] epoch=001:  41%|████      | 11/27 [02:24<03:02, 11.41s/batch, acc=0.4951, loss=1.0788][train] epoch=001:  44%|████▍     | 12/27 [02:24<02:54, 11.63s/batch, acc=0.4951, loss=1.0788][train] epoch=001:  44%|████▍     | 12/27 [02:36<02:54, 11.63s/batch, acc=0.5051, loss=1.0654][train] epoch=001:  48%|████▊     | 13/27 [02:36<02:45, 11.84s/batch, acc=0.5051, loss=1.0654][train] epoch=001:  48%|████▊     | 13/27 [02:48<02:45, 11.84s/batch, acc=0.5100, loss=1.0555][train] epoch=001:  52%|█████▏    | 14/27 [02:48<02:34, 11.92s/batch, acc=0.5100, loss=1.0555][train] epoch=001:  52%|█████▏    | 14/27 [02:59<02:34, 11.92s/batch, acc=0.5224, loss=1.0401][train] epoch=001:  56%|█████▌    | 15/27 [02:59<02:18, 11.54s/batch, acc=0.5224, loss=1.0401][train] epoch=001:  56%|█████▌    | 15/27 [03:12<02:18, 11.54s/batch, acc=0.5303, loss=1.0290][train] epoch=001:  59%|█████▉    | 16/27 [03:12<02:11, 11.93s/batch, acc=0.5303, loss=1.0290][train] epoch=001:  59%|█████▉    | 16/27 [03:25<02:11, 11.93s/batch, acc=0.5349, loss=1.0187][train] epoch=001:  63%|██████▎   | 17/27 [03:25<02:04, 12.41s/batch, acc=0.5349, loss=1.0187][train] epoch=001:  63%|██████▎   | 17/27 [03:37<02:04, 12.41s/batch, acc=0.5391, loss=1.0098][train] epoch=001:  67%|██████▋   | 18/27 [03:37<01:49, 12.18s/batch, acc=0.5391, loss=1.0098][train] epoch=001:  67%|██████▋   | 18/27 [03:50<01:49, 12.18s/batch, acc=0.5458, loss=1.0019][train] epoch=001:  70%|███████   | 19/27 [03:50<01:39, 12.40s/batch, acc=0.5458, loss=1.0019][train] epoch=001:  70%|███████   | 19/27 [04:02<01:39, 12.40s/batch, acc=0.5529, loss=0.9940][train] epoch=001 batch=20/27 loss=0.9940 acc=0.5529 rss_mb=1381.7 ru_maxrss_mb=1381.7 py_current_mb=112.5 py_peak_mb=306.1 torch_allocated_mb=232.3 torch_mps_driver_mb=4676.1
[train] epoch=001:  74%|███████▍  | 20/27 [04:03<01:27, 12.53s/batch, acc=0.5529, loss=0.9940][train] epoch=001:  74%|███████▍  | 20/27 [04:14<01:27, 12.53s/batch, acc=0.5619, loss=0.9850][train] epoch=001:  78%|███████▊  | 21/27 [04:14<01:13, 12.30s/batch, acc=0.5619, loss=0.9850][train] epoch=001:  78%|███████▊  | 21/27 [04:27<01:13, 12.30s/batch, acc=0.5668, loss=0.9789][train] epoch=001:  81%|████████▏ | 22/27 [04:27<01:01, 12.35s/batch, acc=0.5668, loss=0.9789][train] epoch=001:  81%|████████▏ | 22/27 [04:40<01:01, 12.35s/batch, acc=0.5730, loss=0.9733][train] epoch=001:  85%|████████▌ | 23/27 [04:40<00:50, 12.69s/batch, acc=0.5730, loss=0.9733][train] epoch=001:  85%|████████▌ | 23/27 [04:52<00:50, 12.69s/batch, acc=0.5798, loss=0.9671][train] epoch=001:  89%|████████▉ | 24/27 [04:52<00:37, 12.37s/batch, acc=0.5798, loss=0.9671][train] epoch=001:  89%|████████▉ | 24/27 [05:04<00:37, 12.37s/batch, acc=0.5867, loss=0.9607][train] epoch=001:  93%|█████████▎| 25/27 [05:04<00:24, 12.34s/batch, acc=0.5867, loss=0.9607][train] epoch=001:  93%|█████████▎| 25/27 [05:17<00:24, 12.34s/batch, acc=0.5938, loss=0.9531][train] epoch=001:  96%|█████████▋| 26/27 [05:17<00:12, 12.37s/batch, acc=0.5938, loss=0.9531][train] epoch=001:  96%|█████████▋| 26/27 [05:23<00:12, 12.37s/batch, acc=0.5959, loss=0.9503][train] epoch=001 batch=27/27 loss=0.9503 acc=0.5959 rss_mb=1523.6 ru_maxrss_mb=1523.6 py_current_mb=112.3 py_peak_mb=306.1 torch_allocated_mb=133.3 torch_mps_driver_mb=4412.5
[train] epoch=001: 100%|██████████| 27/27 [05:23<00:00, 10.62s/batch, acc=0.5959, loss=0.9503]                                                                                              [val] epoch=001:   0%|          | 0/3 [00:00<?, ?batch/s][val] epoch=001:   0%|          | 0/3 [00:02<?, ?batch/s, acc=0.2266, loss=1.2937][val] epoch=001:  33%|███▎      | 1/3 [00:02<00:04,  2.00s/batch, acc=0.2266, loss=1.2937][val] epoch=001:  33%|███▎      | 1/3 [00:04<00:04,  2.00s/batch, acc=0.2500, loss=1.2065][val] epoch=001:  67%|██████▋   | 2/3 [00:04<00:02,  2.05s/batch, acc=0.2500, loss=1.2065][val] epoch=001:  67%|██████▋   | 2/3 [00:06<00:02,  2.05s/batch, acc=0.3083, loss=1.1751][val] epoch=001 batch=3/3 loss=1.1751 acc=0.3083 rss_mb=1640.8 ru_maxrss_mb=1640.8 py_current_mb=112.3 py_peak_mb=306.1 torch_allocated_mb=164.3 torch_mps_driver_mb=4164.5
[val] epoch=001: 100%|██████████| 3/3 [00:06<00:00,  2.35s/batch, acc=0.3083, loss=1.1751]                                                                                          epoch=001 train_loss=0.9503 train_acc=0.5959 val_loss=1.1751 val_acc=0.3083
[train] epoch=001 rss_mb=1640.8 ru_maxrss_mb=1640.8 py_current_mb=112.3 py_peak_mb=306.1 torch_allocated_mb=40.3 torch_mps_driver_mb=4164.5
[train] epoch=002:   0%|          | 0/27 [00:00<?, ?batch/s][train] epoch=002:   0%|          | 0/27 [00:12<?, ?batch/s, acc=0.7656, loss=0.7611][train] epoch=002:   4%|▎         | 1/27 [00:12<05:20, 12.34s/batch, acc=0.7656, loss=0.7611][train] epoch=002:   4%|▎         | 1/27 [00:23<05:20, 12.34s/batch, acc=0.7520, loss=0.7639][train] epoch=002:   7%|▋         | 2/27 [00:23<04:50, 11.63s/batch, acc=0.7520, loss=0.7639][train] epoch=002:   7%|▋         | 2/27 [00:35<04:50, 11.63s/batch, acc=0.7669, loss=0.7567][train] epoch=002:  11%|█         | 3/27 [00:35<04:41, 11.73s/batch, acc=0.7669, loss=0.7567][train] epoch=002:  11%|█         | 3/27 [00:46<04:41, 11.73s/batch, acc=0.7617, loss=0.7545][train] epoch=002:  15%|█▍        | 4/27 [00:46<04:25, 11.54s/batch, acc=0.7617, loss=0.7545][train] epoch=002:  15%|█▍        | 4/27 [00:59<04:25, 11.54s/batch, acc=0.7539, loss=0.7620][train] epoch=002:  19%|█▊        | 5/27 [00:59<04:21, 11.88s/batch, acc=0.7539, loss=0.7620][train] epoch=002:  19%|█▊        | 5/27 [01:11<04:21, 11.88s/batch, acc=0.7552, loss=0.7534][train] epoch=002:  22%|██▏       | 6/27 [01:11<04:13, 12.06s/batch, acc=0.7552, loss=0.7534][train] epoch=002:  22%|██▏       | 6/27 [01:23<04:13, 12.06s/batch, acc=0.7511, loss=0.7524][train] epoch=002:  26%|██▌       | 7/27 [01:23<04:02, 12.15s/batch, acc=0.7511, loss=0.7524][train] epoch=002:  26%|██▌       | 7/27 [01:36<04:02, 12.15s/batch, acc=0.7461, loss=0.7620][train] epoch=002:  30%|██▉       | 8/27 [01:36<03:56, 12.44s/batch, acc=0.7461, loss=0.7620][train] epoch=002:  30%|██▉       | 8/27 [01:50<03:56, 12.44s/batch, acc=0.7530, loss=0.7544][train] epoch=002:  33%|███▎      | 9/27 [01:50<03:48, 12.67s/batch, acc=0.7530, loss=0.7544][train] epoch=002:  33%|███▎      | 9/27 [02:02<03:48, 12.67s/batch, acc=0.7566, loss=0.7493][train] epoch=002 batch=10/27 loss=0.7493 acc=0.7566 rss_mb=1654.4 ru_maxrss_mb=1654.4 py_current_mb=112.6 py_peak_mb=306.2 torch_allocated_mb=232.3 torch_mps_driver_mb=5700.5
[train] epoch=002:  37%|███▋      | 10/27 [02:02<03:36, 12.73s/batch, acc=0.7566, loss=0.7493][train] epoch=002:  37%|███▋      | 10/27 [02:15<03:36, 12.73s/batch, acc=0.7656, loss=0.7409][train] epoch=002:  41%|████      | 11/27 [02:15<03:23, 12.71s/batch, acc=0.7656, loss=0.7409][train] epoch=002:  41%|████      | 11/27 [02:26<03:23, 12.71s/batch, acc=0.7650, loss=0.7386][train] epoch=002:  44%|████▍     | 12/27 [02:26<03:04, 12.32s/batch, acc=0.7650, loss=0.7386][train] epoch=002:  44%|████▍     | 12/27 [02:38<03:04, 12.32s/batch, acc=0.7686, loss=0.7343][train] epoch=002:  48%|████▊     | 13/27 [02:38<02:50, 12.20s/batch, acc=0.7686, loss=0.7343][train] epoch=002:  48%|████▊     | 13/27 [02:50<02:50, 12.20s/batch, acc=0.7737, loss=0.7302][train] epoch=002:  52%|█████▏    | 14/27 [02:50<02:37, 12.09s/batch, acc=0.7737, loss=0.7302][train] epoch=002:  52%|█████▏    | 14/27 [02:58<02:37, 12.09s/batch, acc=0.7773, loss=0.7268][train] epoch=002:  56%|█████▌    | 15/27 [02:58<02:11, 10.92s/batch, acc=0.7773, loss=0.7268][train] epoch=002:  56%|█████▌    | 15/27 [03:09<02:11, 10.92s/batch, acc=0.7825, loss=0.7203][train] epoch=002:  59%|█████▉    | 16/27 [03:09<01:59, 10.88s/batch, acc=0.7825, loss=0.7203][train] epoch=002:  59%|█████▉    | 16/27 [03:20<01:59, 10.88s/batch, acc=0.7870, loss=0.7172][train] epoch=002:  63%|██████▎   | 17/27 [03:20<01:49, 10.98s/batch, acc=0.7870, loss=0.7172][train] epoch=002:  63%|██████▎   | 17/27 [03:35<01:49, 10.98s/batch, acc=0.7908, loss=0.7126][train] epoch=002:  67%|██████▋   | 18/27 [03:35<01:48, 12.07s/batch, acc=0.7908, loss=0.7126][train] epoch=002:  67%|██████▋   | 18/27 [03:49<01:48, 12.07s/batch, acc=0.7932, loss=0.7092][train] epoch=002:  70%|███████   | 19/27 [03:49<01:40, 12.57s/batch, acc=0.7932, loss=0.7092][train] epoch=002:  70%|███████   | 19/27 [04:02<01:40, 12.57s/batch, acc=0.7984, loss=0.7029][train] epoch=002 batch=20/27 loss=0.7029 acc=0.7984 rss_mb=1655.5 ru_maxrss_mb=1655.5 py_current_mb=112.6 py_peak_mb=306.2 torch_allocated_mb=232.3 torch_mps_driver_mb=5700.5
[train] epoch=002:  74%|███████▍  | 20/27 [04:02<01:28, 12.62s/batch, acc=0.7984, loss=0.7029][train] epoch=002:  74%|███████▍  | 20/27 [04:14<01:28, 12.62s/batch, acc=0.8030, loss=0.6991][train] epoch=002:  78%|███████▊  | 21/27 [04:14<01:16, 12.70s/batch, acc=0.8030, loss=0.6991][train] epoch=002:  78%|███████▊  | 21/27 [04:29<01:16, 12.70s/batch, acc=0.8075, loss=0.6949][train] epoch=002:  81%|████████▏ | 22/27 [04:29<01:06, 13.27s/batch, acc=0.8075, loss=0.6949][train] epoch=002:  81%|████████▏ | 22/27 [04:40<01:06, 13.27s/batch, acc=0.8110, loss=0.6908][train] epoch=002:  85%|████████▌ | 23/27 [04:40<00:50, 12.65s/batch, acc=0.8110, loss=0.6908][train] epoch=002:  85%|████████▌ | 23/27 [04:53<00:50, 12.65s/batch, acc=0.8148, loss=0.6867][train] epoch=002:  89%|████████▉ | 24/27 [04:53<00:37, 12.55s/batch, acc=0.8148, loss=0.6867][train] epoch=002:  89%|████████▉ | 24/27 [05:04<00:37, 12.55s/batch, acc=0.8172, loss=0.6845][train] epoch=002:  93%|█████████▎| 25/27 [05:04<00:24, 12.14s/batch, acc=0.8172, loss=0.6845][train] epoch=002:  93%|█████████▎| 25/27 [05:16<00:24, 12.14s/batch, acc=0.8220, loss=0.6787][train] epoch=002:  96%|█████████▋| 26/27 [05:16<00:12, 12.14s/batch, acc=0.8220, loss=0.6787][train] epoch=002:  96%|█████████▋| 26/27 [05:21<00:12, 12.14s/batch, acc=0.8230, loss=0.6768][train] epoch=002 batch=27/27 loss=0.6768 acc=0.8230 rss_mb=1655.8 ru_maxrss_mb=1655.8 py_current_mb=112.3 py_peak_mb=306.2 torch_allocated_mb=133.3 torch_mps_driver_mb=5436.5
[train] epoch=002: 100%|██████████| 27/27 [05:21<00:00, 10.07s/batch, acc=0.8230, loss=0.6768]                                                                                              [val] epoch=002:   0%|          | 0/3 [00:00<?, ?batch/s][val] epoch=002:   0%|          | 0/3 [00:01<?, ?batch/s, acc=0.5078, loss=1.1853][val] epoch=002:  33%|███▎      | 1/3 [00:01<00:03,  1.92s/batch, acc=0.5078, loss=1.1853][val] epoch=002:  33%|███▎      | 1/3 [00:03<00:03,  1.92s/batch, acc=0.5664, loss=1.0167][val] epoch=002:  67%|██████▋   | 2/3 [00:03<00:02,  2.01s/batch, acc=0.5664, loss=1.0167][val] epoch=002:  67%|██████▋   | 2/3 [00:06<00:02,  2.01s/batch, acc=0.6416, loss=0.9145][val] epoch=002 batch=3/3 loss=0.9145 acc=0.6416 rss_mb=1662.0 ru_maxrss_mb=1662.0 py_current_mb=112.3 py_peak_mb=306.2 torch_allocated_mb=164.3 torch_mps_driver_mb=5188.5
[val] epoch=002: 100%|██████████| 3/3 [00:06<00:00,  2.31s/batch, acc=0.6416, loss=0.9145]                                                                                          epoch=002 train_loss=0.6768 train_acc=0.8230 val_loss=0.9145 val_acc=0.6416
[train] epoch=002 rss_mb=1662.0 ru_maxrss_mb=1662.0 py_current_mb=112.3 py_peak_mb=306.2 torch_allocated_mb=40.3 torch_mps_driver_mb=5188.5
[train] epoch=003:   0%|          | 0/27 [00:00<?, ?batch/s][train] epoch=003:   0%|          | 0/27 [00:12<?, ?batch/s, acc=0.9141, loss=0.5573][train] epoch=003:   4%|▎         | 1/27 [00:12<05:32, 12.79s/batch, acc=0.9141, loss=0.5573][train] epoch=003:   4%|▎         | 1/27 [00:24<05:32, 12.79s/batch, acc=0.9141, loss=0.5639][train] epoch=003:   7%|▋         | 2/27 [00:24<04:59, 11.99s/batch, acc=0.9141, loss=0.5639][train] epoch=003:   7%|▋         | 2/27 [00:35<04:59, 11.99s/batch, acc=0.9167, loss=0.5553][train] epoch=003:  11%|█         | 3/27 [00:35<04:41, 11.72s/batch, acc=0.9167, loss=0.5553][train] epoch=003:  11%|█         | 3/27 [00:47<04:41, 11.72s/batch, acc=0.9258, loss=0.5449][train] epoch=003:  15%|█▍        | 4/27 [00:47<04:26, 11.59s/batch, acc=0.9258, loss=0.5449][train] epoch=003:  15%|█▍        | 4/27 [00:57<04:26, 11.59s/batch, acc=0.9273, loss=0.5413][train] epoch=003:  19%|█▊        | 5/27 [00:57<04:09, 11.35s/batch, acc=0.9273, loss=0.5413][train] epoch=003:  19%|█▊        | 5/27 [01:09<04:09, 11.35s/batch, acc=0.9297, loss=0.5360][train] epoch=003:  22%|██▏       | 6/27 [01:09<04:02, 11.55s/batch, acc=0.9297, loss=0.5360][train] epoch=003:  22%|██▏       | 6/27 [01:21<04:02, 11.55s/batch, acc=0.9235, loss=0.5407][train] epoch=003:  26%|██▌       | 7/27 [01:21<03:48, 11.43s/batch, acc=0.9235, loss=0.5407][train] epoch=003:  26%|██▌       | 7/27 [01:33<03:48, 11.43s/batch, acc=0.9277, loss=0.5351][train] epoch=003:  30%|██▉       | 8/27 [01:33<03:44, 11.83s/batch, acc=0.9277, loss=0.5351][train] epoch=003:  30%|██▉       | 8/27 [01:46<03:44, 11.83s/batch, acc=0.9275, loss=0.5357][train] epoch=003:  33%|███▎      | 9/27 [01:46<03:39, 12.19s/batch, acc=0.9275, loss=0.5357][train] epoch=003:  33%|███▎      | 9/27 [01:57<03:39, 12.19s/batch, acc=0.9277, loss=0.5332][train] epoch=003 batch=10/27 loss=0.5332 acc=0.9277 rss_mb=1666.5 ru_maxrss_mb=1666.5 py_current_mb=112.6 py_peak_mb=306.2 torch_allocated_mb=232.3 torch_mps_driver_mb=5700.5
[train] epoch=003:  37%|███▋      | 10/27 [01:58<03:22, 11.91s/batch, acc=0.9277, loss=0.5332][train] epoch=003:  37%|███▋      | 10/27 [02:10<03:22, 11.91s/batch, acc=0.9265, loss=0.5319][train] epoch=003:  41%|████      | 11/27 [02:10<03:15, 12.21s/batch, acc=0.9265, loss=0.5319][train] epoch=003:  41%|████      | 11/27 [02:23<03:15, 12.21s/batch, acc=0.9290, loss=0.5272][train] epoch=003:  44%|████▍     | 12/27 [02:23<03:07, 12.47s/batch, acc=0.9290, loss=0.5272][train] epoch=003:  44%|████▍     | 12/27 [02:35<03:07, 12.47s/batch, acc=0.9291, loss=0.5247][train] epoch=003:  48%|████▊     | 13/27 [02:35<02:52, 12.33s/batch, acc=0.9291, loss=0.5247][train] epoch=003:  48%|████▊     | 13/27 [02:47<02:52, 12.33s/batch, acc=0.9314, loss=0.5200][train] epoch=003:  52%|█████▏    | 14/27 [02:47<02:36, 12.00s/batch, acc=0.9314, loss=0.5200][train] epoch=003:  52%|█████▏    | 14/27 [02:59<02:36, 12.00s/batch, acc=0.9313, loss=0.5173][train] epoch=003:  56%|█████▌    | 15/27 [02:59<02:23, 11.97s/batch, acc=0.9313, loss=0.5173][train] epoch=003:  56%|█████▌    | 15/27 [03:12<02:23, 11.97s/batch, acc=0.9312, loss=0.5162][train] epoch=003:  59%|█████▉    | 16/27 [03:12<02:17, 12.46s/batch, acc=0.9312, loss=0.5162][train] epoch=003:  59%|█████▉    | 16/27 [03:24<02:17, 12.46s/batch, acc=0.9318, loss=0.5135][train] epoch=003:  63%|██████▎   | 17/27 [03:24<02:02, 12.27s/batch, acc=0.9318, loss=0.5135][train] epoch=003:  63%|██████▎   | 17/27 [03:35<02:02, 12.27s/batch, acc=0.9321, loss=0.5120][train] epoch=003:  67%|██████▋   | 18/27 [03:35<01:47, 11.91s/batch, acc=0.9321, loss=0.5120][train] epoch=003:  67%|██████▋   | 18/27 [03:47<01:47, 11.91s/batch, acc=0.9330, loss=0.5094][train] epoch=003:  70%|███████   | 19/27 [03:47<01:34, 11.80s/batch, acc=0.9330, loss=0.5094][train] epoch=003:  70%|███████   | 19/27 [03:59<01:34, 11.80s/batch, acc=0.9336, loss=0.5067][train] epoch=003 batch=20/27 loss=0.5067 acc=0.9336 rss_mb=1666.5 ru_maxrss_mb=1666.5 py_current_mb=112.6 py_peak_mb=306.2 torch_allocated_mb=232.3 torch_mps_driver_mb=5700.5
[train] epoch=003:  74%|███████▍  | 20/27 [03:59<01:24, 12.02s/batch, acc=0.9336, loss=0.5067][train] epoch=003:  74%|███████▍  | 20/27 [04:12<01:24, 12.02s/batch, acc=0.9351, loss=0.5034][train] epoch=003:  78%|███████▊  | 21/27 [04:12<01:13, 12.26s/batch, acc=0.9351, loss=0.5034][train] epoch=003:  78%|███████▊  | 21/27 [04:24<01:13, 12.26s/batch, acc=0.9364, loss=0.5002][train] epoch=003:  81%|████████▏ | 22/27 [04:24<01:01, 12.28s/batch, acc=0.9364, loss=0.5002][train] epoch=003:  81%|████████▏ | 22/27 [04:36<01:01, 12.28s/batch, acc=0.9365, loss=0.4974][train] epoch=003:  85%|████████▌ | 23/27 [04:36<00:48, 12.11s/batch, acc=0.9365, loss=0.4974][train] epoch=003:  85%|████████▌ | 23/27 [04:50<00:48, 12.11s/batch, acc=0.9370, loss=0.4951][train] epoch=003:  89%|████████▉ | 24/27 [04:50<00:37, 12.64s/batch, acc=0.9370, loss=0.4951][train] epoch=003:  89%|████████▉ | 24/27 [05:02<00:37, 12.64s/batch, acc=0.9373, loss=0.4927][train] epoch=003:  93%|█████████▎| 25/27 [05:02<00:24, 12.36s/batch, acc=0.9373, loss=0.4927][train] epoch=003:  93%|█████████▎| 25/27 [05:14<00:24, 12.36s/batch, acc=0.9366, loss=0.4919][train] epoch=003:  96%|█████████▋| 26/27 [05:14<00:12, 12.32s/batch, acc=0.9366, loss=0.4919][train] epoch=003:  96%|█████████▋| 26/27 [05:20<00:12, 12.32s/batch, acc=0.9367, loss=0.4911][train] epoch=003 batch=27/27 loss=0.4911 acc=0.9367 rss_mb=1666.6 ru_maxrss_mb=1666.6 py_current_mb=112.3 py_peak_mb=306.2 torch_allocated_mb=133.3 torch_mps_driver_mb=5436.5
[train] epoch=003: 100%|██████████| 27/27 [05:20<00:00, 10.51s/batch, acc=0.9367, loss=0.4911]                                                                                              [val] epoch=003:   0%|          | 0/3 [00:00<?, ?batch/s][val] epoch=003:   0%|          | 0/3 [00:01<?, ?batch/s, acc=0.5195, loss=1.2229][val] epoch=003:  33%|███▎      | 1/3 [00:01<00:03,  1.97s/batch, acc=0.5195, loss=1.2229][val] epoch=003:  33%|███▎      | 1/3 [00:04<00:03,  1.97s/batch, acc=0.5469, loss=1.0455][val] epoch=003:  67%|██████▋   | 2/3 [00:04<00:02,  2.04s/batch, acc=0.5469, loss=1.0455][val] epoch=003:  67%|██████▋   | 2/3 [00:06<00:02,  2.04s/batch, acc=0.6260, loss=0.9077][val] epoch=003 batch=3/3 loss=0.9077 acc=0.6260 rss_mb=1666.6 ru_maxrss_mb=1666.6 py_current_mb=112.3 py_peak_mb=306.2 torch_allocated_mb=164.3 torch_mps_driver_mb=5188.5
[val] epoch=003: 100%|██████████| 3/3 [00:06<00:00,  2.34s/batch, acc=0.6260, loss=0.9077]                                                                                          epoch=003 train_loss=0.4911 train_acc=0.9367 val_loss=0.9077 val_acc=0.6260
[train] epoch=003 rss_mb=1666.6 ru_maxrss_mb=1666.6 py_current_mb=112.3 py_peak_mb=306.2 torch_allocated_mb=40.3 torch_mps_driver_mb=5188.5
[train] epoch=004:   0%|          | 0/27 [00:00<?, ?batch/s][train] epoch=004:   0%|          | 0/27 [00:12<?, ?batch/s, acc=0.9531, loss=0.4157][train] epoch=004:   4%|▎         | 1/27 [00:12<05:13, 12.04s/batch, acc=0.9531, loss=0.4157][train] epoch=004:   4%|▎         | 1/27 [00:24<05:13, 12.04s/batch, acc=0.9648, loss=0.4057][train] epoch=004:   7%|▋         | 2/27 [00:24<05:12, 12.51s/batch, acc=0.9648, loss=0.4057][train] epoch=004:   7%|▋         | 2/27 [00:38<05:12, 12.51s/batch, acc=0.9518, loss=0.4191][train] epoch=004:  11%|█         | 3/27 [00:38<05:12, 13.01s/batch, acc=0.9518, loss=0.4191][train] epoch=004:  11%|█         | 3/27 [00:50<05:12, 13.01s/batch, acc=0.9551, loss=0.4184][train] epoch=004:  15%|█▍        | 4/27 [00:50<04:50, 12.62s/batch, acc=0.9551, loss=0.4184][train] epoch=004:  15%|█▍        | 4/27 [01:02<04:50, 12.62s/batch, acc=0.9555, loss=0.4172][train] epoch=004:  19%|█▊        | 5/27 [01:02<04:31, 12.35s/batch, acc=0.9555, loss=0.4172][train] epoch=004:  19%|█▊        | 5/27 [01:15<04:31, 12.35s/batch, acc=0.9551, loss=0.4211][train] epoch=004:  22%|██▏       | 6/27 [01:15<04:21, 12.45s/batch, acc=0.9551, loss=0.4211][train] epoch=004:  22%|██▏       | 6/27 [01:29<04:21, 12.45s/batch, acc=0.9548, loss=0.4205][train] epoch=004:  26%|██▌       | 7/27 [01:29<04:22, 13.10s/batch, acc=0.9548, loss=0.4205][train] epoch=004:  26%|██▌       | 7/27 [01:43<04:22, 13.10s/batch, acc=0.9551, loss=0.4171][train] epoch=004:  30%|██▉       | 8/27 [01:43<04:15, 13.44s/batch, acc=0.9551, loss=0.4171][train] epoch=004:  30%|██▉       | 8/27 [01:54<04:15, 13.44s/batch, acc=0.9514, loss=0.4208][train] epoch=004:  33%|███▎      | 9/27 [01:54<03:46, 12.61s/batch, acc=0.9514, loss=0.4208][train] epoch=004:  33%|███▎      | 9/27 [02:04<03:46, 12.61s/batch, acc=0.9520, loss=0.4180][train] epoch=004 batch=10/27 loss=0.4180 acc=0.9520 rss_mb=1666.8 ru_maxrss_mb=1666.8 py_current_mb=112.6 py_peak_mb=306.2 torch_allocated_mb=232.3 torch_mps_driver_mb=5700.5
[train] epoch=004:  37%|███▋      | 10/27 [02:04<03:20, 11.80s/batch, acc=0.9520, loss=0.4180][train] epoch=004:  37%|███▋      | 10/27 [02:15<03:20, 11.80s/batch, acc=0.9528, loss=0.4146][train] epoch=004:  41%|████      | 11/27 [02:15<03:04, 11.53s/batch, acc=0.9528, loss=0.4146][train] epoch=004:  41%|████      | 11/27 [02:26<03:04, 11.53s/batch, acc=0.9528, loss=0.4133][train] epoch=004:  44%|████▍     | 12/27 [02:26<02:53, 11.55s/batch, acc=0.9528, loss=0.4133][train] epoch=004:  44%|████▍     | 12/27 [02:38<02:53, 11.55s/batch, acc=0.9516, loss=0.4136][train] epoch=004:  48%|████▊     | 13/27 [02:38<02:43, 11.68s/batch, acc=0.9516, loss=0.4136][train] epoch=004:  48%|████▊     | 13/27 [02:47<02:43, 11.68s/batch, acc=0.9531, loss=0.4124][train] epoch=004:  52%|█████▏    | 14/27 [02:47<02:20, 10.84s/batch, acc=0.9531, loss=0.4124][train] epoch=004:  52%|█████▏    | 14/27 [02:58<02:20, 10.84s/batch, acc=0.9526, loss=0.4110][train] epoch=004:  56%|█████▌    | 15/27 [02:58<02:10, 10.91s/batch, acc=0.9526, loss=0.4110][train] epoch=004:  56%|█████▌    | 15/27 [03:10<02:10, 10.91s/batch, acc=0.9536, loss=0.4111][train] epoch=004:  59%|█████▉    | 16/27 [03:10<02:03, 11.24s/batch, acc=0.9536, loss=0.4111][train] epoch=004:  59%|█████▉    | 16/27 [03:23<02:03, 11.24s/batch, acc=0.9524, loss=0.4118][train] epoch=004:  63%|██████▎   | 17/27 [03:23<01:57, 11.73s/batch, acc=0.9524, loss=0.4118][train] epoch=004:  63%|██████▎   | 17/27 [03:36<01:57, 11.73s/batch, acc=0.9533, loss=0.4093][train] epoch=004:  67%|██████▋   | 18/27 [03:36<01:49, 12.13s/batch, acc=0.9533, loss=0.4093][train] epoch=004:  67%|██████▋   | 18/27 [03:48<01:49, 12.13s/batch, acc=0.9523, loss=0.4092][train] epoch=004:  70%|███████   | 19/27 [03:48<01:37, 12.14s/batch, acc=0.9523, loss=0.4092][train] epoch=004:  70%|███████   | 19/27 [04:00<01:37, 12.14s/batch, acc=0.9525, loss=0.4088][train] epoch=004 batch=20/27 loss=0.4088 acc=0.9525 rss_mb=1668.0 ru_maxrss_mb=1668.0 py_current_mb=116.2 py_peak_mb=309.9 torch_allocated_mb=232.3 torch_mps_driver_mb=5700.5
[train] epoch=004:  74%|███████▍  | 20/27 [04:00<01:22, 11.85s/batch, acc=0.9525, loss=0.4088][train] epoch=004:  74%|███████▍  | 20/27 [04:13<01:22, 11.85s/batch, acc=0.9520, loss=0.4085][train] epoch=004:  78%|███████▊  | 21/27 [04:13<01:12, 12.16s/batch, acc=0.9520, loss=0.4085][train] epoch=004:  78%|███████▊  | 21/27 [04:23<01:12, 12.16s/batch, acc=0.9522, loss=0.4071][train] epoch=004:  81%|████████▏ | 22/27 [04:23<00:58, 11.68s/batch, acc=0.9522, loss=0.4071][train] epoch=004:  81%|████████▏ | 22/27 [04:38<00:58, 11.68s/batch, acc=0.9531, loss=0.4055][train] epoch=004:  85%|████████▌ | 23/27 [04:38<00:50, 12.68s/batch, acc=0.9531, loss=0.4055][train] epoch=004:  85%|████████▌ | 23/27 [04:50<00:50, 12.68s/batch, acc=0.9533, loss=0.4047][train] epoch=004:  89%|████████▉ | 24/27 [04:50<00:37, 12.50s/batch, acc=0.9533, loss=0.4047][train] epoch=004:  89%|████████▉ | 24/27 [05:02<00:37, 12.50s/batch, acc=0.9531, loss=0.4031][train] epoch=004:  93%|█████████▎| 25/27 [05:02<00:24, 12.29s/batch, acc=0.9531, loss=0.4031][train] epoch=004:  93%|█████████▎| 25/27 [05:14<00:24, 12.29s/batch, acc=0.9530, loss=0.4025][train] epoch=004:  96%|█████████▋| 26/27 [05:14<00:12, 12.27s/batch, acc=0.9530, loss=0.4025][train] epoch=004:  96%|█████████▋| 26/27 [05:22<00:12, 12.27s/batch, acc=0.9525, loss=0.4022][train] epoch=004 batch=27/27 loss=0.4022 acc=0.9525 rss_mb=1668.1 ru_maxrss_mb=1668.1 py_current_mb=116.0 py_peak_mb=309.9 torch_allocated_mb=133.3 torch_mps_driver_mb=5436.5
[train] epoch=004: 100%|██████████| 27/27 [05:22<00:00, 10.99s/batch, acc=0.9525, loss=0.4022]                                                                                              [val] epoch=004:   0%|          | 0/3 [00:00<?, ?batch/s][val] epoch=004:   0%|          | 0/3 [00:01<?, ?batch/s, acc=0.5625, loss=1.1714][val] epoch=004:  33%|███▎      | 1/3 [00:01<00:03,  1.96s/batch, acc=0.5625, loss=1.1714][val] epoch=004:  33%|███▎      | 1/3 [00:04<00:03,  1.96s/batch, acc=0.5625, loss=1.0136][val] epoch=004:  67%|██████▋   | 2/3 [00:04<00:02,  2.02s/batch, acc=0.5625, loss=1.0136][val] epoch=004:  67%|██████▋   | 2/3 [00:06<00:02,  2.02s/batch, acc=0.6495, loss=0.8731][val] epoch=004 batch=3/3 loss=0.8731 acc=0.6495 rss_mb=1668.1 ru_maxrss_mb=1668.1 py_current_mb=116.0 py_peak_mb=309.9 torch_allocated_mb=164.3 torch_mps_driver_mb=5188.5
[val] epoch=004: 100%|██████████| 3/3 [00:06<00:00,  2.33s/batch, acc=0.6495, loss=0.8731]                                                                                          epoch=004 train_loss=0.4022 train_acc=0.9525 val_loss=0.8731 val_acc=0.6495
[train] epoch=004 rss_mb=1668.1 ru_maxrss_mb=1668.1 py_current_mb=116.0 py_peak_mb=309.9 torch_allocated_mb=40.3 torch_mps_driver_mb=5188.5
[train] epoch=005:   0%|          | 0/27 [00:00<?, ?batch/s][train] epoch=005:   0%|          | 0/27 [00:12<?, ?batch/s, acc=0.9688, loss=0.3603][train] epoch=005:   4%|▎         | 1/27 [00:12<05:13, 12.06s/batch, acc=0.9688, loss=0.3603][train] epoch=005:   4%|▎         | 1/27 [00:24<05:13, 12.06s/batch, acc=0.9551, loss=0.3667][train] epoch=005:   7%|▋         | 2/27 [00:24<05:08, 12.34s/batch, acc=0.9551, loss=0.3667][train] epoch=005:   7%|▋         | 2/27 [00:37<05:08, 12.34s/batch, acc=0.9570, loss=0.3695][train] epoch=005:  11%|█         | 3/27 [00:37<05:05, 12.72s/batch, acc=0.9570, loss=0.3695][train] epoch=005:  11%|█         | 3/27 [00:50<05:05, 12.72s/batch, acc=0.9570, loss=0.3759][train] epoch=005:  15%|█▍        | 4/27 [00:50<04:49, 12.58s/batch, acc=0.9570, loss=0.3759][train] epoch=005:  15%|█▍        | 4/27 [01:02<04:49, 12.58s/batch, acc=0.9555, loss=0.3724][train] epoch=005:  19%|█▊        | 5/27 [01:02<04:37, 12.60s/batch, acc=0.9555, loss=0.3724][train] epoch=005:  19%|█▊        | 5/27 [01:13<04:37, 12.60s/batch, acc=0.9538, loss=0.3742][train] epoch=005:  22%|██▏       | 6/27 [01:13<04:14, 12.11s/batch, acc=0.9538, loss=0.3742][train] epoch=005:  22%|██▏       | 6/27 [01:25<04:14, 12.11s/batch, acc=0.9593, loss=0.3671][train] epoch=005:  26%|██▌       | 7/27 [01:25<03:56, 11.82s/batch, acc=0.9593, loss=0.3671][train] epoch=005:  26%|██▌       | 7/27 [01:36<03:56, 11.82s/batch, acc=0.9585, loss=0.3660][train] epoch=005:  30%|██▉       | 8/27 [01:36<03:43, 11.78s/batch, acc=0.9585, loss=0.3660][train] epoch=005:  30%|██▉       | 8/27 [01:48<03:43, 11.78s/batch, acc=0.9579, loss=0.3649][train] epoch=005:  33%|███▎      | 9/27 [01:48<03:31, 11.73s/batch, acc=0.9579, loss=0.3649][train] epoch=005:  33%|███▎      | 9/27 [02:00<03:31, 11.73s/batch, acc=0.9582, loss=0.3638][train] epoch=005 batch=10/27 loss=0.3638 acc=0.9582 rss_mb=1668.3 ru_maxrss_mb=1668.3 py_current_mb=116.2 py_peak_mb=309.9 torch_allocated_mb=232.3 torch_mps_driver_mb=5700.5
[train] epoch=005:  37%|███▋      | 10/27 [02:00<03:18, 11.71s/batch, acc=0.9582, loss=0.3638][train] epoch=005:  37%|███▋      | 10/27 [02:12<03:18, 11.71s/batch, acc=0.9574, loss=0.3654][train] epoch=005:  41%|████      | 11/27 [02:12<03:12, 12.05s/batch, acc=0.9574, loss=0.3654][train] epoch=005:  41%|████      | 11/27 [02:23<03:12, 12.05s/batch, acc=0.9577, loss=0.3641][train] epoch=005:  44%|████▍     | 12/27 [02:23<02:55, 11.73s/batch, acc=0.9577, loss=0.3641][train] epoch=005:  44%|████▍     | 12/27 [02:38<02:55, 11.73s/batch, acc=0.9585, loss=0.3631][train] epoch=005:  48%|████▊     | 13/27 [02:38<02:54, 12.48s/batch, acc=0.9585, loss=0.3631][train] epoch=005:  48%|████▊     | 13/27 [02:50<02:54, 12.48s/batch, acc=0.9590, loss=0.3627][train] epoch=005:  52%|█████▏    | 14/27 [02:50<02:42, 12.51s/batch, acc=0.9590, loss=0.3627][train] epoch=005:  52%|█████▏    | 14/27 [03:03<02:42, 12.51s/batch, acc=0.9596, loss=0.3603][train] epoch=005:  56%|█████▌    | 15/27 [03:03<02:30, 12.51s/batch, acc=0.9596, loss=0.3603][train] epoch=005:  56%|█████▌    | 15/27 [03:14<02:30, 12.51s/batch, acc=0.9597, loss=0.3598][train] epoch=005:  59%|█████▉    | 16/27 [03:14<02:15, 12.28s/batch, acc=0.9597, loss=0.3598][train] epoch=005:  59%|█████▉    | 16/27 [03:27<02:15, 12.28s/batch, acc=0.9609, loss=0.3594][train] epoch=005:  63%|██████▎   | 17/27 [03:27<02:02, 12.26s/batch, acc=0.9609, loss=0.3594][train] epoch=005:  63%|██████▎   | 17/27 [03:38<02:02, 12.26s/batch, acc=0.9618, loss=0.3582][train] epoch=005:  67%|██████▋   | 18/27 [03:38<01:48, 12.10s/batch, acc=0.9618, loss=0.3582][train] epoch=005:  67%|██████▋   | 18/27 [03:50<01:48, 12.10s/batch, acc=0.9616, loss=0.3587][train] epoch=005:  70%|███████   | 19/27 [03:50<01:36, 12.05s/batch, acc=0.9616, loss=0.3587][train] epoch=005:  70%|███████   | 19/27 [04:03<01:36, 12.05s/batch, acc=0.9611, loss=0.3584][train] epoch=005 batch=20/27 loss=0.3584 acc=0.9611 rss_mb=1668.4 ru_maxrss_mb=1668.4 py_current_mb=116.2 py_peak_mb=309.9 torch_allocated_mb=232.3 torch_mps_driver_mb=5700.5
[train] epoch=005:  74%|███████▍  | 20/27 [04:04<01:26, 12.38s/batch, acc=0.9611, loss=0.3584][train] epoch=005:  74%|███████▍  | 20/27 [04:16<01:26, 12.38s/batch, acc=0.9615, loss=0.3577][train] epoch=005:  78%|███████▊  | 21/27 [04:16<01:13, 12.32s/batch, acc=0.9615, loss=0.3577][train] epoch=005:  78%|███████▊  | 21/27 [04:28<01:13, 12.32s/batch, acc=0.9615, loss=0.3572][train] epoch=005:  81%|████████▏ | 22/27 [04:28<01:02, 12.44s/batch, acc=0.9615, loss=0.3572][train] epoch=005:  81%|████████▏ | 22/27 [04:42<01:02, 12.44s/batch, acc=0.9621, loss=0.3559][train] epoch=005:  85%|████████▌ | 23/27 [04:42<00:51, 12.83s/batch, acc=0.9621, loss=0.3559][train] epoch=005:  85%|████████▌ | 23/27 [04:55<00:51, 12.83s/batch, acc=0.9626, loss=0.3549][train] epoch=005:  89%|████████▉ | 24/27 [04:55<00:38, 12.80s/batch, acc=0.9626, loss=0.3549][train] epoch=005:  89%|████████▉ | 24/27 [05:08<00:38, 12.80s/batch, acc=0.9628, loss=0.3541][train] epoch=005:  93%|█████████▎| 25/27 [05:08<00:25, 12.93s/batch, acc=0.9628, loss=0.3541][train] epoch=005:  93%|█████████▎| 25/27 [05:22<00:25, 12.93s/batch, acc=0.9636, loss=0.3527][train] epoch=005:  96%|█████████▋| 26/27 [05:22<00:13, 13.30s/batch, acc=0.9636, loss=0.3527][train] epoch=005:  96%|█████████▋| 26/27 [05:28<00:13, 13.30s/batch, acc=0.9640, loss=0.3522][train] epoch=005 batch=27/27 loss=0.3522 acc=0.9640 rss_mb=1674.4 ru_maxrss_mb=1674.4 py_current_mb=116.0 py_peak_mb=309.9 torch_allocated_mb=133.3 torch_mps_driver_mb=5436.5
[train] epoch=005: 100%|██████████| 27/27 [05:28<00:00, 10.90s/batch, acc=0.9640, loss=0.3522]                                                                                              [val] epoch=005:   0%|          | 0/3 [00:00<?, ?batch/s][val] epoch=005:   0%|          | 0/3 [00:01<?, ?batch/s, acc=0.5508, loss=1.1418][val] epoch=005:  33%|███▎      | 1/3 [00:01<00:03,  1.93s/batch, acc=0.5508, loss=1.1418][val] epoch=005:  33%|███▎      | 1/3 [00:03<00:03,  1.93s/batch, acc=0.5957, loss=0.9896][val] epoch=005:  67%|██████▋   | 2/3 [00:03<00:01,  2.00s/batch, acc=0.5957, loss=0.9896][val] epoch=005:  67%|██████▋   | 2/3 [00:06<00:01,  2.00s/batch, acc=0.6745, loss=0.8523][val] epoch=005 batch=3/3 loss=0.8523 acc=0.6745 rss_mb=1674.4 ru_maxrss_mb=1674.4 py_current_mb=116.0 py_peak_mb=309.9 torch_allocated_mb=164.3 torch_mps_driver_mb=5188.5
[val] epoch=005: 100%|██████████| 3/3 [00:06<00:00,  2.30s/batch, acc=0.6745, loss=0.8523]                                                                                          epoch=005 train_loss=0.3522 train_acc=0.9640 val_loss=0.8523 val_acc=0.6745
[train] epoch=005 rss_mb=1674.4 ru_maxrss_mb=1674.4 py_current_mb=116.0 py_peak_mb=309.9 torch_allocated_mb=40.3 torch_mps_driver_mb=5188.5
[train] epoch=006:   0%|          | 0/27 [00:00<?, ?batch/s][train] epoch=006:   0%|          | 0/27 [00:13<?, ?batch/s, acc=0.9648, loss=0.3304][train] epoch=006:   4%|▎         | 1/27 [00:13<05:44, 13.25s/batch, acc=0.9648, loss=0.3304][train] epoch=006:   4%|▎         | 1/27 [00:25<05:44, 13.25s/batch, acc=0.9648, loss=0.3310][train] epoch=006:   7%|▋         | 2/27 [00:25<05:13, 12.55s/batch, acc=0.9648, loss=0.3310][train] epoch=006:   7%|▋         | 2/27 [00:36<05:13, 12.55s/batch, acc=0.9688, loss=0.3290][train] epoch=006:  11%|█         | 3/27 [00:36<04:46, 11.96s/batch, acc=0.9688, loss=0.3290][train] epoch=006:  11%|█         | 3/27 [00:48<04:46, 11.96s/batch, acc=0.9707, loss=0.3255][train] epoch=006:  15%|█▍        | 4/27 [00:48<04:32, 11.85s/batch, acc=0.9707, loss=0.3255][train] epoch=006:  15%|█▍        | 4/27 [00:59<04:32, 11.85s/batch, acc=0.9727, loss=0.3224][train] epoch=006:  19%|█▊        | 5/27 [00:59<04:19, 11.77s/batch, acc=0.9727, loss=0.3224][train] epoch=006:  19%|█▊        | 5/27 [01:13<04:19, 11.77s/batch, acc=0.9720, loss=0.3236][train] epoch=006:  22%|██▏       | 6/27 [01:13<04:19, 12.33s/batch, acc=0.9720, loss=0.3236][train] epoch=006:  22%|██▏       | 6/27 [01:26<04:19, 12.33s/batch, acc=0.9688, loss=0.3283][train] epoch=006:  26%|██▌       | 7/27 [01:26<04:09, 12.46s/batch, acc=0.9688, loss=0.3283][train] epoch=006:  26%|██▌       | 7/27 [01:38<04:09, 12.46s/batch, acc=0.9702, loss=0.3270][train] epoch=006:  30%|██▉       | 8/27 [01:38<03:58, 12.56s/batch, acc=0.9702, loss=0.3270][train] epoch=006:  30%|██▉       | 8/27 [01:52<03:58, 12.56s/batch, acc=0.9714, loss=0.3251][train] epoch=006:  33%|███▎      | 9/27 [01:52<03:52, 12.94s/batch, acc=0.9714, loss=0.3251][train] epoch=006:  33%|███▎      | 9/27 [02:04<03:52, 12.94s/batch, acc=0.9719, loss=0.3238][train] epoch=006 batch=10/27 loss=0.3238 acc=0.9719 rss_mb=1674.5 ru_maxrss_mb=1674.5 py_current_mb=116.2 py_peak_mb=309.9 torch_allocated_mb=232.3 torch_mps_driver_mb=5700.5
[train] epoch=006:  37%|███▋      | 10/27 [02:04<03:34, 12.61s/batch, acc=0.9719, loss=0.3238][train] epoch=006:  37%|███▋      | 10/27 [02:16<03:34, 12.61s/batch, acc=0.9719, loss=0.3234][train] epoch=006:  41%|████      | 11/27 [02:16<03:19, 12.44s/batch, acc=0.9719, loss=0.3234][train] epoch=006:  41%|████      | 11/27 [02:28<03:19, 12.44s/batch, acc=0.9701, loss=0.3255][train] epoch=006:  44%|████▍     | 12/27 [02:28<03:03, 12.25s/batch, acc=0.9701, loss=0.3255][train] epoch=006:  44%|████▍     | 12/27 [02:40<03:03, 12.25s/batch, acc=0.9678, loss=0.3270][train] epoch=006:  48%|████▊     | 13/27 [02:40<02:50, 12.15s/batch, acc=0.9678, loss=0.3270][train] epoch=006:  48%|████▊     | 13/27 [02:52<02:50, 12.15s/batch, acc=0.9679, loss=0.3266][train] epoch=006:  52%|█████▏    | 14/27 [02:52<02:39, 12.24s/batch, acc=0.9679, loss=0.3266][train] epoch=006:  52%|█████▏    | 14/27 [03:05<02:39, 12.24s/batch, acc=0.9688, loss=0.3257][train] epoch=006:  56%|█████▌    | 15/27 [03:05<02:30, 12.54s/batch, acc=0.9688, loss=0.3257][train] epoch=006:  56%|█████▌    | 15/27 [03:17<02:30, 12.54s/batch, acc=0.9690, loss=0.3261][train] epoch=006:  59%|█████▉    | 16/27 [03:17<02:16, 12.40s/batch, acc=0.9690, loss=0.3261][train] epoch=006:  59%|█████▉    | 16/27 [03:29<02:16, 12.40s/batch, acc=0.9694, loss=0.3262][train] epoch=006:  63%|██████▎   | 17/27 [03:29<02:00, 12.07s/batch, acc=0.9694, loss=0.3262][train] epoch=006:  63%|██████▎   | 17/27 [03:40<02:00, 12.07s/batch, acc=0.9698, loss=0.3262][train] epoch=006:  67%|██████▋   | 18/27 [03:40<01:46, 11.85s/batch, acc=0.9698, loss=0.3262][train] epoch=006:  67%|██████▋   | 18/27 [03:53<01:46, 11.85s/batch, acc=0.9690, loss=0.3271][train] epoch=006:  70%|███████   | 19/27 [03:53<01:36, 12.04s/batch, acc=0.9690, loss=0.3271][train] epoch=006:  70%|███████   | 19/27 [04:05<01:36, 12.04s/batch, acc=0.9691, loss=0.3264][train] epoch=006 batch=20/27 loss=0.3264 acc=0.9691 rss_mb=1674.6 ru_maxrss_mb=1674.6 py_current_mb=116.2 py_peak_mb=309.9 torch_allocated_mb=232.3 torch_mps_driver_mb=5700.5
[train] epoch=006:  74%|███████▍  | 20/27 [04:05<01:25, 12.20s/batch, acc=0.9691, loss=0.3264][train] epoch=006:  74%|███████▍  | 20/27 [04:18<01:25, 12.20s/batch, acc=0.9688, loss=0.3264][train] epoch=006:  78%|███████▊  | 21/27 [04:18<01:13, 12.32s/batch, acc=0.9688, loss=0.3264][train] epoch=006:  78%|███████▊  | 21/27 [04:30<01:13, 12.32s/batch, acc=0.9693, loss=0.3266][train] epoch=006:  81%|████████▏ | 22/27 [04:30<01:00, 12.14s/batch, acc=0.9693, loss=0.3266][train] epoch=006:  81%|████████▏ | 22/27 [04:41<01:00, 12.14s/batch, acc=0.9691, loss=0.3264][train] epoch=006:  85%|████████▌ | 23/27 [04:41<00:47, 11.90s/batch, acc=0.9691, loss=0.3264][train] epoch=006:  85%|████████▌ | 23/27 [04:51<00:47, 11.90s/batch, acc=0.9679, loss=0.3279][train] epoch=006:  89%|████████▉ | 24/27 [04:51<00:34, 11.43s/batch, acc=0.9679, loss=0.3279][train] epoch=006:  89%|████████▉ | 24/27 [05:04<00:34, 11.43s/batch, acc=0.9681, loss=0.3266][train] epoch=006:  93%|█████████▎| 25/27 [05:04<00:23, 11.71s/batch, acc=0.9681, loss=0.3266][train] epoch=006:  93%|█████████▎| 25/27 [05:18<00:23, 11.71s/batch, acc=0.9680, loss=0.3270][train] epoch=006:  96%|█████████▋| 26/27 [05:18<00:12, 12.60s/batch, acc=0.9680, loss=0.3270][train] epoch=006:  96%|█████████▋| 26/27 [05:24<00:12, 12.60s/batch, acc=0.9681, loss=0.3267][train] epoch=006 batch=27/27 loss=0.3267 acc=0.9681 rss_mb=1674.6 ru_maxrss_mb=1674.6 py_current_mb=116.0 py_peak_mb=309.9 torch_allocated_mb=133.3 torch_mps_driver_mb=5436.5
[train] epoch=006: 100%|██████████| 27/27 [05:24<00:00, 10.61s/batch, acc=0.9681, loss=0.3267]                                                                                              [val] epoch=006:   0%|          | 0/3 [00:00<?, ?batch/s][val] epoch=006:   0%|          | 0/3 [00:01<?, ?batch/s, acc=0.4453, loss=1.2351][val] epoch=006:  33%|███▎      | 1/3 [00:01<00:03,  1.95s/batch, acc=0.4453, loss=1.2351][val] epoch=006:  33%|███▎      | 1/3 [00:04<00:03,  1.95s/batch, acc=0.4707, loss=1.0986][val] epoch=006:  67%|██████▋   | 2/3 [00:04<00:02,  2.02s/batch, acc=0.4707, loss=1.0986][val] epoch=006:  67%|██████▋   | 2/3 [00:06<00:02,  2.02s/batch, acc=0.5681, loss=0.9397][val] epoch=006 batch=3/3 loss=0.9397 acc=0.5681 rss_mb=1674.6 ru_maxrss_mb=1674.6 py_current_mb=116.0 py_peak_mb=309.9 torch_allocated_mb=164.3 torch_mps_driver_mb=5188.5
[val] epoch=006: 100%|██████████| 3/3 [00:06<00:00,  2.32s/batch, acc=0.5681, loss=0.9397]                                                                                          epoch=006 train_loss=0.3267 train_acc=0.9681 val_loss=0.9397 val_acc=0.5681
[train] epoch=006 rss_mb=1674.6 ru_maxrss_mb=1674.6 py_current_mb=116.0 py_peak_mb=309.9 torch_allocated_mb=40.3 torch_mps_driver_mb=5188.5
[train] epoch=007:   0%|          | 0/27 [00:00<?, ?batch/s][train] epoch=007:   0%|          | 0/27 [00:14<?, ?batch/s, acc=0.9531, loss=0.3467][train] epoch=007:   4%|▎         | 1/27 [00:14<06:25, 14.84s/batch, acc=0.9531, loss=0.3467][train] epoch=007:   4%|▎         | 1/27 [00:27<06:25, 14.84s/batch, acc=0.9473, loss=0.3564][train] epoch=007:   7%|▋         | 2/27 [00:27<05:34, 13.38s/batch, acc=0.9473, loss=0.3564][train] epoch=007:   7%|▋         | 2/27 [00:40<05:34, 13.38s/batch, acc=0.9479, loss=0.3485][train] epoch=007:  11%|█         | 3/27 [00:40<05:18, 13.26s/batch, acc=0.9479, loss=0.3485][train] epoch=007:  11%|█         | 3/27 [00:52<05:18, 13.26s/batch, acc=0.9561, loss=0.3374][train] epoch=007:  15%|█▍        | 4/27 [00:52<04:57, 12.93s/batch, acc=0.9561, loss=0.3374][train] epoch=007:  15%|█▍        | 4/27 [01:05<04:57, 12.93s/batch, acc=0.9617, loss=0.3340][train] epoch=007:  19%|█▊        | 5/27 [01:05<04:43, 12.89s/batch, acc=0.9617, loss=0.3340][train] epoch=007:  19%|█▊        | 5/27 [01:15<04:43, 12.89s/batch, acc=0.9622, loss=0.3312][train] epoch=007:  22%|██▏       | 6/27 [01:15<04:10, 11.95s/batch, acc=0.9622, loss=0.3312][train] epoch=007:  22%|██▏       | 6/27 [01:27<04:10, 11.95s/batch, acc=0.9648, loss=0.3270][train] epoch=007:  26%|██▌       | 7/27 [01:27<04:01, 12.05s/batch, acc=0.9648, loss=0.3270][train] epoch=007:  26%|██▌       | 7/27 [01:40<04:01, 12.05s/batch, acc=0.9658, loss=0.3258][train] epoch=007:  30%|██▉       | 8/27 [01:40<03:53, 12.29s/batch, acc=0.9658, loss=0.3258][train] epoch=007:  30%|██▉       | 8/27 [01:53<03:53, 12.29s/batch, acc=0.9666, loss=0.3244][train] epoch=007:  33%|███▎      | 9/27 [01:53<03:44, 12.48s/batch, acc=0.9666, loss=0.3244][train] epoch=007:  33%|███▎      | 9/27 [02:07<03:44, 12.48s/batch, acc=0.9680, loss=0.3247][train] epoch=007 batch=10/27 loss=0.3247 acc=0.9680 rss_mb=1674.6 ru_maxrss_mb=1674.6 py_current_mb=116.2 py_peak_mb=309.9 torch_allocated_mb=232.3 torch_mps_driver_mb=5700.5
[train] epoch=007:  37%|███▋      | 10/27 [02:07<03:37, 12.80s/batch, acc=0.9680, loss=0.3247][train] epoch=007:  37%|███▋      | 10/27 [02:18<03:37, 12.80s/batch, acc=0.9659, loss=0.3265][train] epoch=007:  41%|████      | 11/27 [02:18<03:17, 12.37s/batch, acc=0.9659, loss=0.3265][train] epoch=007:  41%|████      | 11/27 [02:30<03:17, 12.37s/batch, acc=0.9668, loss=0.3239][train] epoch=007:  44%|████▍     | 12/27 [02:30<03:01, 12.10s/batch, acc=0.9668, loss=0.3239][train] epoch=007:  44%|████▍     | 12/27 [02:43<03:01, 12.10s/batch, acc=0.9669, loss=0.3241][train] epoch=007:  48%|████▊     | 13/27 [02:43<02:54, 12.49s/batch, acc=0.9669, loss=0.3241][train] epoch=007:  48%|████▊     | 13/27 [02:53<02:54, 12.49s/batch, acc=0.9671, loss=0.3237][train] epoch=007:  52%|█████▏    | 14/27 [02:53<02:31, 11.66s/batch, acc=0.9671, loss=0.3237][train] epoch=007:  52%|█████▏    | 14/27 [03:05<02:31, 11.66s/batch, acc=0.9682, loss=0.3209][train] epoch=007:  56%|█████▌    | 15/27 [03:05<02:23, 11.93s/batch, acc=0.9682, loss=0.3209][train] epoch=007:  56%|█████▌    | 15/27 [03:17<02:23, 11.93s/batch, acc=0.9685, loss=0.3198][train] epoch=007:  59%|█████▉    | 16/27 [03:17<02:10, 11.84s/batch, acc=0.9685, loss=0.3198][train] epoch=007:  59%|█████▉    | 16/27 [03:29<02:10, 11.84s/batch, acc=0.9688, loss=0.3184][train] epoch=007:  63%|██████▎   | 17/27 [03:29<01:58, 11.88s/batch, acc=0.9688, loss=0.3184][train] epoch=007:  63%|██████▎   | 17/27 [03:41<01:58, 11.88s/batch, acc=0.9696, loss=0.3167][train] epoch=007:  67%|██████▋   | 18/27 [03:41<01:48, 12.06s/batch, acc=0.9696, loss=0.3167][train] epoch=007:  67%|██████▋   | 18/27 [03:53<01:48, 12.06s/batch, acc=0.9700, loss=0.3169][train] epoch=007:  70%|███████   | 19/27 [03:53<01:36, 12.03s/batch, acc=0.9700, loss=0.3169][train] epoch=007:  70%|███████   | 19/27 [04:05<01:36, 12.03s/batch, acc=0.9697, loss=0.3161][train] epoch=007 batch=20/27 loss=0.3161 acc=0.9697 rss_mb=1688.5 ru_maxrss_mb=1688.5 py_current_mb=116.2 py_peak_mb=309.9 torch_allocated_mb=232.3 torch_mps_driver_mb=5700.5
[train] epoch=007:  74%|███████▍  | 20/27 [04:05<01:23, 11.98s/batch, acc=0.9697, loss=0.3161][train] epoch=007:  74%|███████▍  | 20/27 [04:16<01:23, 11.98s/batch, acc=0.9706, loss=0.3149][train] epoch=007:  78%|███████▊  | 21/27 [04:16<01:09, 11.66s/batch, acc=0.9706, loss=0.3149][train] epoch=007:  78%|███████▊  | 21/27 [04:28<01:09, 11.66s/batch, acc=0.9705, loss=0.3150][train] epoch=007:  81%|████████▏ | 22/27 [04:28<00:59, 11.82s/batch, acc=0.9705, loss=0.3150][train] epoch=007:  81%|████████▏ | 22/27 [04:42<00:59, 11.82s/batch, acc=0.9715, loss=0.3134][train] epoch=007:  85%|████████▌ | 23/27 [04:42<00:49, 12.45s/batch, acc=0.9715, loss=0.3134][train] epoch=007:  85%|████████▌ | 23/27 [04:54<00:49, 12.45s/batch, acc=0.9714, loss=0.3134][train] epoch=007:  89%|████████▉ | 24/27 [04:54<00:36, 12.14s/batch, acc=0.9714, loss=0.3134][train] epoch=007:  89%|████████▉ | 24/27 [05:06<00:36, 12.14s/batch, acc=0.9716, loss=0.3127][train] epoch=007:  93%|█████████▎| 25/27 [05:06<00:24, 12.09s/batch, acc=0.9716, loss=0.3127][train] epoch=007:  93%|█████████▎| 25/27 [05:16<00:24, 12.09s/batch, acc=0.9715, loss=0.3124][train] epoch=007:  96%|█████████▋| 26/27 [05:16<00:11, 11.69s/batch, acc=0.9715, loss=0.3124][train] epoch=007:  96%|█████████▋| 26/27 [05:23<00:11, 11.69s/batch, acc=0.9718, loss=0.3117][train] epoch=007 batch=27/27 loss=0.3117 acc=0.9718 rss_mb=1773.5 ru_maxrss_mb=1773.5 py_current_mb=116.0 py_peak_mb=309.9 torch_allocated_mb=133.3 torch_mps_driver_mb=5436.5
[train] epoch=007: 100%|██████████| 27/27 [05:23<00:00, 10.07s/batch, acc=0.9718, loss=0.3117]                                                                                              [val] epoch=007:   0%|          | 0/3 [00:00<?, ?batch/s][val] epoch=007:   0%|          | 0/3 [00:01<?, ?batch/s, acc=0.5781, loss=1.0753][val] epoch=007:  33%|███▎      | 1/3 [00:01<00:03,  1.88s/batch, acc=0.5781, loss=1.0753][val] epoch=007:  33%|███▎      | 1/3 [00:03<00:03,  1.88s/batch, acc=0.5605, loss=0.9920][val] epoch=007:  67%|██████▋   | 2/3 [00:03<00:01,  1.94s/batch, acc=0.5605, loss=0.9920][val] epoch=007:  67%|██████▋   | 2/3 [00:06<00:01,  1.94s/batch, acc=0.6479, loss=0.8509][val] epoch=007 batch=3/3 loss=0.8509 acc=0.6479 rss_mb=1805.1 ru_maxrss_mb=1805.1 py_current_mb=116.0 py_peak_mb=309.9 torch_allocated_mb=164.3 torch_mps_driver_mb=5188.5
[val] epoch=007: 100%|██████████| 3/3 [00:06<00:00,  2.26s/batch, acc=0.6479, loss=0.8509]                                                                                          epoch=007 train_loss=0.3117 train_acc=0.9718 val_loss=0.8509 val_acc=0.6479
[train] epoch=007 rss_mb=1805.1 ru_maxrss_mb=1805.1 py_current_mb=116.0 py_peak_mb=309.9 torch_allocated_mb=40.3 torch_mps_driver_mb=5188.5
[train] epoch=008:   0%|          | 0/27 [00:00<?, ?batch/s][train] epoch=008:   0%|          | 0/27 [00:11<?, ?batch/s, acc=0.9844, loss=0.3174][train] epoch=008:   4%|▎         | 1/27 [00:11<05:09, 11.89s/batch, acc=0.9844, loss=0.3174][train] epoch=008:   4%|▎         | 1/27 [00:24<05:09, 11.89s/batch, acc=0.9746, loss=0.3136][train] epoch=008:   7%|▋         | 2/27 [00:24<05:10, 12.43s/batch, acc=0.9746, loss=0.3136][train] epoch=008:   7%|▋         | 2/27 [00:34<05:10, 12.43s/batch, acc=0.9740, loss=0.3167][train] epoch=008:  11%|█         | 3/27 [00:34<04:33, 11.41s/batch, acc=0.9740, loss=0.3167][train] epoch=008:  11%|█         | 3/27 [00:47<04:33, 11.41s/batch, acc=0.9727, loss=0.3191][train] epoch=008:  15%|█▍        | 4/27 [00:47<04:30, 11.78s/batch, acc=0.9727, loss=0.3191][train] epoch=008:  15%|█▍        | 4/27 [00:59<04:30, 11.78s/batch, acc=0.9688, loss=0.3197][train] epoch=008:  19%|█▊        | 5/27 [00:59<04:21, 11.89s/batch, acc=0.9688, loss=0.3197][train] epoch=008:  19%|█▊        | 5/27 [01:10<04:21, 11.89s/batch, acc=0.9707, loss=0.3142][train] epoch=008:  22%|██▏       | 6/27 [01:10<04:05, 11.71s/batch, acc=0.9707, loss=0.3142][train] epoch=008:  22%|██▏       | 6/27 [01:23<04:05, 11.71s/batch, acc=0.9710, loss=0.3137][train] epoch=008:  26%|██▌       | 7/27 [01:23<03:58, 11.92s/batch, acc=0.9710, loss=0.3137]