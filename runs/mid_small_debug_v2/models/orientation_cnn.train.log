[logging] tee enabled log_file=/Users/helios/rotation-detection/runs/mid_small_debug_v2/models/orientation_cnn.train.log
[train] checkpoint=/Users/helios/rotation-detection/runs/mid_small_debug_v2/models/orientation_cnn.pt
[train] start memory {'rss_mb': 47.671875, 'ru_maxrss_mb': 47.671875, 'py_current_mb': 0.0, 'py_peak_mb': 0.0, 'torch_allocated_mb': None, 'torch_reserved_mb': None, 'torch_mps_driver_mb': None}
[train] data_sampling class_balance=uniform split_strategy=document_page_weighted min_val_docs=2 min_test_docs=2
[train] rows train=4236 val=350
[train] init memory rss_mb=358.4 ru_maxrss_mb=358.4 py_current_mb=110.1 py_peak_mb=110.4 torch_allocated_mb=2.9 torch_mps_driver_mb=48.5
[train] epoch=001:   0%|          | 0/17 [00:00<?, ?batch/s][train] epoch=001:   0%|          | 0/17 [00:11<?, ?batch/s, acc=0.2266, loss=1.4045][train] epoch=001:   6%|▌         | 1/17 [00:11<03:00, 11.25s/batch, acc=0.2266, loss=1.4045][train] epoch=001:   6%|▌         | 1/17 [00:25<03:00, 11.25s/batch, acc=0.3203, loss=1.4033][train] epoch=001:  12%|█▏        | 2/17 [00:25<03:15, 13.03s/batch, acc=0.3203, loss=1.4033][train] epoch=001:  12%|█▏        | 2/17 [00:38<03:15, 13.03s/batch, acc=0.3581, loss=1.3475][train] epoch=001:  18%|█▊        | 3/17 [00:38<03:04, 13.18s/batch, acc=0.3581, loss=1.3475][train] epoch=001:  18%|█▊        | 3/17 [00:49<03:04, 13.18s/batch, acc=0.4131, loss=1.2987][train] epoch=001:  24%|██▎       | 4/17 [00:49<02:36, 12.06s/batch, acc=0.4131, loss=1.2987][train] epoch=001:  24%|██▎       | 4/17 [01:02<02:36, 12.06s/batch, acc=0.4367, loss=1.2504][train] epoch=001 batch=5/17 loss=1.2504 acc=0.4367 rss_mb=1417.5 ru_maxrss_mb=1417.5 py_current_mb=110.1 py_peak_mb=303.7 torch_allocated_mb=232.3 torch_mps_driver_mb=4676.1
[train] epoch=001:  29%|██▉       | 5/17 [01:02<02:28, 12.36s/batch, acc=0.4367, loss=1.2504][train] epoch=001:  29%|██▉       | 5/17 [01:14<02:28, 12.36s/batch, acc=0.4531, loss=1.2082][train] epoch=001:  35%|███▌      | 6/17 [01:14<02:16, 12.44s/batch, acc=0.4531, loss=1.2082][train] epoch=001:  35%|███▌      | 6/17 [01:27<02:16, 12.44s/batch, acc=0.4587, loss=1.1883][train] epoch=001:  41%|████      | 7/17 [01:27<02:05, 12.55s/batch, acc=0.4587, loss=1.1883][train] epoch=001:  41%|████      | 7/17 [01:38<02:05, 12.55s/batch, acc=0.4717, loss=1.1583][train] epoch=001:  47%|████▋     | 8/17 [01:38<01:49, 12.19s/batch, acc=0.4717, loss=1.1583][train] epoch=001:  47%|████▋     | 8/17 [01:51<01:49, 12.19s/batch, acc=0.4835, loss=1.1328][train] epoch=001:  53%|█████▎    | 9/17 [01:51<01:39, 12.45s/batch, acc=0.4835, loss=1.1328][train] epoch=001:  53%|█████▎    | 9/17 [02:05<01:39, 12.45s/batch, acc=0.4988, loss=1.1146][train] epoch=001 batch=10/17 loss=1.1146 acc=0.4988 rss_mb=1444.6 ru_maxrss_mb=1444.6 py_current_mb=110.1 py_peak_mb=303.7 torch_allocated_mb=232.3 torch_mps_driver_mb=4676.1
[train] epoch=001:  59%|█████▉    | 10/17 [02:05<01:29, 12.79s/batch, acc=0.4988, loss=1.1146][train] epoch=001:  59%|█████▉    | 10/17 [02:17<01:29, 12.79s/batch, acc=0.5107, loss=1.0950][train] epoch=001:  65%|██████▍   | 11/17 [02:17<01:15, 12.66s/batch, acc=0.5107, loss=1.0950][train] epoch=001:  65%|██████▍   | 11/17 [02:27<01:15, 12.66s/batch, acc=0.5208, loss=1.0807][train] epoch=001:  71%|███████   | 12/17 [02:27<00:59, 11.81s/batch, acc=0.5208, loss=1.0807][train] epoch=001:  71%|███████   | 12/17 [02:40<00:59, 11.81s/batch, acc=0.5270, loss=1.0716][train] epoch=001:  76%|███████▋  | 13/17 [02:40<00:48, 12.07s/batch, acc=0.5270, loss=1.0716][train] epoch=001:  76%|███████▋  | 13/17 [02:53<00:48, 12.07s/batch, acc=0.5307, loss=1.0593][train] epoch=001:  82%|████████▏ | 14/17 [02:53<00:36, 12.27s/batch, acc=0.5307, loss=1.0593][train] epoch=001:  82%|████████▏ | 14/17 [03:02<00:36, 12.27s/batch, acc=0.5398, loss=1.0452][train] epoch=001 batch=15/17 loss=1.0452 acc=0.5398 rss_mb=1488.7 ru_maxrss_mb=1488.7 py_current_mb=110.1 py_peak_mb=303.7 torch_allocated_mb=232.3 torch_mps_driver_mb=4676.1
[train] epoch=001:  88%|████████▊ | 15/17 [03:03<00:23, 11.56s/batch, acc=0.5398, loss=1.0452][train] epoch=001:  88%|████████▊ | 15/17 [03:14<00:23, 11.56s/batch, acc=0.5496, loss=1.0328][train] epoch=001:  94%|█████████▍| 16/17 [03:14<00:11, 11.47s/batch, acc=0.5496, loss=1.0328][train] epoch=001:  94%|█████████▍| 16/17 [03:22<00:11, 11.47s/batch, acc=0.5538, loss=1.0269][train] epoch=001 batch=17/17 loss=1.0269 acc=0.5538 rss_mb=1530.9 ru_maxrss_mb=1530.9 py_current_mb=109.9 py_peak_mb=303.7 torch_allocated_mb=168.3 torch_mps_driver_mb=4444.5
[train] epoch=001: 100%|██████████| 17/17 [03:22<00:00, 10.60s/batch, acc=0.5538, loss=1.0269]                                                                                              [val] epoch=001:   0%|          | 0/2 [00:00<?, ?batch/s][val] epoch=001:   0%|          | 0/2 [00:07<?, ?batch/s, acc=0.2891, loss=1.3424][val] epoch=001:  50%|█████     | 1/2 [00:07<00:07,  7.11s/batch, acc=0.2891, loss=1.3424][val] epoch=001:  50%|█████     | 1/2 [00:07<00:07,  7.11s/batch, acc=0.2686, loss=1.3440][val] epoch=001 batch=2/2 loss=1.3440 acc=0.2686 rss_mb=1622.3 ru_maxrss_mb=1622.3 py_current_mb=109.9 py_peak_mb=303.7 torch_allocated_mb=110.8 torch_mps_driver_mb=5700.5
[val] epoch=001: 100%|██████████| 2/2 [00:07<00:00,  3.35s/batch, acc=0.2686, loss=1.3440]                                                                                          epoch=001 train_loss=1.0269 train_acc=0.5538 val_loss=1.3440 val_acc=0.2686
[train] epoch=001 rss_mb=1622.3 ru_maxrss_mb=1622.3 py_current_mb=109.9 py_peak_mb=303.7 torch_allocated_mb=40.3 torch_mps_driver_mb=5700.5
[train] epoch=002:   0%|          | 0/17 [00:00<?, ?batch/s][train] epoch=002:   0%|          | 0/17 [00:13<?, ?batch/s, acc=0.7070, loss=0.8286][train] epoch=002:   6%|▌         | 1/17 [00:13<03:33, 13.32s/batch, acc=0.7070, loss=0.8286][train] epoch=002:   6%|▌         | 1/17 [00:27<03:33, 13.32s/batch, acc=0.7207, loss=0.8328][train] epoch=002:  12%|█▏        | 2/17 [00:27<03:25, 13.69s/batch, acc=0.7207, loss=0.8328][train] epoch=002:  12%|█▏        | 2/17 [00:40<03:25, 13.69s/batch, acc=0.7266, loss=0.8243][train] epoch=002:  18%|█▊        | 3/17 [00:40<03:05, 13.27s/batch, acc=0.7266, loss=0.8243][train] epoch=002:  18%|█▊        | 3/17 [00:50<03:05, 13.27s/batch, acc=0.7295, loss=0.8197][train] epoch=002:  24%|██▎       | 4/17 [00:50<02:37, 12.11s/batch, acc=0.7295, loss=0.8197][train] epoch=002:  24%|██▎       | 4/17 [01:05<02:37, 12.11s/batch, acc=0.7305, loss=0.8267][train] epoch=002 batch=5/17 loss=0.8267 acc=0.7305 rss_mb=1625.7 ru_maxrss_mb=1625.7 py_current_mb=110.1 py_peak_mb=303.7 torch_allocated_mb=232.3 torch_mps_driver_mb=6724.5
[train] epoch=002:  29%|██▉       | 5/17 [01:05<02:36, 13.06s/batch, acc=0.7305, loss=0.8267][train] epoch=002:  29%|██▉       | 5/17 [01:17<02:36, 13.06s/batch, acc=0.7370, loss=0.8164][train] epoch=002:  35%|███▌      | 6/17 [01:17<02:21, 12.82s/batch, acc=0.7370, loss=0.8164][train] epoch=002:  35%|███▌      | 6/17 [01:29<02:21, 12.82s/batch, acc=0.7355, loss=0.8195][train] epoch=002:  41%|████      | 7/17 [01:29<02:05, 12.51s/batch, acc=0.7355, loss=0.8195][train] epoch=002:  41%|████      | 7/17 [01:40<02:05, 12.51s/batch, acc=0.7407, loss=0.8084][train] epoch=002:  47%|████▋     | 8/17 [01:40<01:48, 12.01s/batch, acc=0.7407, loss=0.8084][train] epoch=002:  47%|████▋     | 8/17 [01:52<01:48, 12.01s/batch, acc=0.7396, loss=0.8088][train] epoch=002:  53%|█████▎    | 9/17 [01:52<01:35, 11.92s/batch, acc=0.7396, loss=0.8088][train] epoch=002:  53%|█████▎    | 9/17 [02:03<01:35, 11.92s/batch, acc=0.7438, loss=0.8005][train] epoch=002 batch=10/17 loss=0.8005 acc=0.7438 rss_mb=1625.8 ru_maxrss_mb=1625.8 py_current_mb=110.1 py_peak_mb=303.7 torch_allocated_mb=232.3 torch_mps_driver_mb=6724.5
[train] epoch=002:  59%|█████▉    | 10/17 [02:03<01:22, 11.81s/batch, acc=0.7438, loss=0.8005][train] epoch=002:  59%|█████▉    | 10/17 [02:15<01:22, 11.81s/batch, acc=0.7450, loss=0.7929][train] epoch=002:  65%|██████▍   | 11/17 [02:15<01:10, 11.80s/batch, acc=0.7450, loss=0.7929][train] epoch=002:  65%|██████▍   | 11/17 [02:27<01:10, 11.80s/batch, acc=0.7484, loss=0.7855][train] epoch=002:  71%|███████   | 12/17 [02:27<00:59, 11.98s/batch, acc=0.7484, loss=0.7855][train] epoch=002:  71%|███████   | 12/17 [02:39<00:59, 11.98s/batch, acc=0.7584, loss=0.7756][train] epoch=002:  76%|███████▋  | 13/17 [02:39<00:47, 11.94s/batch, acc=0.7584, loss=0.7756][train] epoch=002:  76%|███████▋  | 13/17 [02:50<00:47, 11.94s/batch, acc=0.7623, loss=0.7678][train] epoch=002:  82%|████████▏ | 14/17 [02:50<00:35, 11.75s/batch, acc=0.7623, loss=0.7678][train] epoch=002:  82%|████████▏ | 14/17 [03:05<00:35, 11.75s/batch, acc=0.7643, loss=0.7624][train] epoch=002 batch=15/17 loss=0.7624 acc=0.7643 rss_mb=1683.3 ru_maxrss_mb=1683.3 py_current_mb=110.1 py_peak_mb=303.7 torch_allocated_mb=232.3 torch_mps_driver_mb=6724.5
[train] epoch=002:  88%|████████▊ | 15/17 [03:05<00:25, 12.52s/batch, acc=0.7643, loss=0.7624][train] epoch=002:  88%|████████▊ | 15/17 [03:17<00:25, 12.52s/batch, acc=0.7690, loss=0.7567][train] epoch=002:  94%|█████████▍| 16/17 [03:17<00:12, 12.52s/batch, acc=0.7690, loss=0.7567][train] epoch=002:  94%|█████████▍| 16/17 [03:24<00:12, 12.52s/batch, acc=0.7698, loss=0.7541][train] epoch=002 batch=17/17 loss=0.7541 acc=0.7698 rss_mb=1683.3 ru_maxrss_mb=1683.3 py_current_mb=110.0 py_peak_mb=303.7 torch_allocated_mb=168.3 torch_mps_driver_mb=6492.5
[train] epoch=002: 100%|██████████| 17/17 [03:24<00:00, 10.77s/batch, acc=0.7698, loss=0.7541]                                                                                              [val] epoch=002:   0%|          | 0/2 [00:00<?, ?batch/s][val] epoch=002:   0%|          | 0/2 [00:07<?, ?batch/s, acc=0.6211, loss=0.9828][val] epoch=002:  50%|█████     | 1/2 [00:07<00:07,  7.16s/batch, acc=0.6211, loss=0.9828][val] epoch=002:  50%|█████     | 1/2 [00:07<00:07,  7.16s/batch, acc=0.5943, loss=0.9935][val] epoch=002 batch=2/2 loss=0.9935 acc=0.5943 rss_mb=1683.3 ru_maxrss_mb=1683.3 py_current_mb=110.0 py_peak_mb=303.7 torch_allocated_mb=110.8 torch_mps_driver_mb=6212.5
[val] epoch=002: 100%|██████████| 2/2 [00:07<00:00,  3.37s/batch, acc=0.5943, loss=0.9935]                                                                                          epoch=002 train_loss=0.7541 train_acc=0.7698 val_loss=0.9935 val_acc=0.5943
[train] epoch=002 rss_mb=1683.3 ru_maxrss_mb=1683.3 py_current_mb=109.9 py_peak_mb=303.7 torch_allocated_mb=40.3 torch_mps_driver_mb=6212.5
[train] epoch=003:   0%|          | 0/17 [00:00<?, ?batch/s][train] epoch=003:   0%|          | 0/17 [00:13<?, ?batch/s, acc=0.8672, loss=0.6342][train] epoch=003:   6%|▌         | 1/17 [00:13<03:43, 13.96s/batch, acc=0.8672, loss=0.6342][train] epoch=003:   6%|▌         | 1/17 [00:26<03:43, 13.96s/batch, acc=0.8633, loss=0.6171][train] epoch=003:  12%|█▏        | 2/17 [00:26<03:20, 13.34s/batch, acc=0.8633, loss=0.6171][train] epoch=003:  12%|█▏        | 2/17 [00:40<03:20, 13.34s/batch, acc=0.8698, loss=0.6099][train] epoch=003:  18%|█▊        | 3/17 [00:40<03:08, 13.44s/batch, acc=0.8698, loss=0.6099][train] epoch=003:  18%|█▊        | 3/17 [00:52<03:08, 13.44s/batch, acc=0.8584, loss=0.6099][train] epoch=003:  24%|██▎       | 4/17 [00:52<02:48, 12.95s/batch, acc=0.8584, loss=0.6099][train] epoch=003:  24%|██▎       | 4/17 [01:03<02:48, 12.95s/batch, acc=0.8602, loss=0.6113][train] epoch=003 batch=5/17 loss=0.6113 acc=0.8602 rss_mb=1686.5 ru_maxrss_mb=1686.5 py_current_mb=110.1 py_peak_mb=303.7 torch_allocated_mb=232.3 torch_mps_driver_mb=6724.5
[train] epoch=003:  29%|██▉       | 5/17 [01:03<02:26, 12.22s/batch, acc=0.8602, loss=0.6113][train] epoch=003:  29%|██▉       | 5/17 [01:14<02:26, 12.22s/batch, acc=0.8594, loss=0.6061][train] epoch=003:  35%|███▌      | 6/17 [01:14<02:09, 11.79s/batch, acc=0.8594, loss=0.6061][train] epoch=003:  35%|███▌      | 6/17 [01:27<02:09, 11.79s/batch, acc=0.8571, loss=0.6102][train] epoch=003:  41%|████      | 7/17 [01:27<02:00, 12.08s/batch, acc=0.8571, loss=0.6102][train] epoch=003:  41%|████      | 7/17 [01:41<02:00, 12.08s/batch, acc=0.8608, loss=0.6054][train] epoch=003:  47%|████▋     | 8/17 [01:41<01:54, 12.74s/batch, acc=0.8608, loss=0.6054][train] epoch=003:  47%|████▋     | 8/17 [01:51<01:54, 12.74s/batch, acc=0.8641, loss=0.5983][train] epoch=003:  53%|█████▎    | 9/17 [01:51<01:36, 12.06s/batch, acc=0.8641, loss=0.5983][train] epoch=003:  53%|█████▎    | 9/17 [02:04<01:36, 12.06s/batch, acc=0.8637, loss=0.5980][train] epoch=003 batch=10/17 loss=0.5980 acc=0.8637 rss_mb=1686.6 ru_maxrss_mb=1686.6 py_current_mb=110.1 py_peak_mb=303.7 torch_allocated_mb=232.3 torch_mps_driver_mb=6724.5
[train] epoch=003:  59%|█████▉    | 10/17 [02:04<01:25, 12.28s/batch, acc=0.8637, loss=0.5980][train] epoch=003:  59%|█████▉    | 10/17 [02:16<01:25, 12.28s/batch, acc=0.8647, loss=0.5944][train] epoch=003:  65%|██████▍   | 11/17 [02:16<01:12, 12.06s/batch, acc=0.8647, loss=0.5944][train] epoch=003:  65%|██████▍   | 11/17 [02:29<01:12, 12.06s/batch, acc=0.8665, loss=0.5887][train] epoch=003:  71%|███████   | 12/17 [02:29<01:01, 12.28s/batch, acc=0.8665, loss=0.5887][train] epoch=003:  71%|███████   | 12/17 [02:41<01:01, 12.28s/batch, acc=0.8657, loss=0.5872][train] epoch=003:  76%|███████▋  | 13/17 [02:41<00:49, 12.44s/batch, acc=0.8657, loss=0.5872][train] epoch=003:  76%|███████▋  | 13/17 [02:54<00:49, 12.44s/batch, acc=0.8675, loss=0.5831][train] epoch=003:  82%|████████▏ | 14/17 [02:54<00:37, 12.55s/batch, acc=0.8675, loss=0.5831][train] epoch=003:  82%|████████▏ | 14/17 [03:05<00:37, 12.55s/batch, acc=0.8693, loss=0.5780][train] epoch=003 batch=15/17 loss=0.5780 acc=0.8693 rss_mb=1686.6 ru_maxrss_mb=1686.6 py_current_mb=110.1 py_peak_mb=303.7 torch_allocated_mb=232.3 torch_mps_driver_mb=6724.5
[train] epoch=003:  88%|████████▊ | 15/17 [03:05<00:24, 12.13s/batch, acc=0.8693, loss=0.5780][train] epoch=003:  88%|████████▊ | 15/17 [03:19<00:24, 12.13s/batch, acc=0.8687, loss=0.5754][train] epoch=003:  94%|█████████▍| 16/17 [03:19<00:12, 12.51s/batch, acc=0.8687, loss=0.5754][train] epoch=003:  94%|█████████▍| 16/17 [03:25<00:12, 12.51s/batch, acc=0.8685, loss=0.5743][train] epoch=003 batch=17/17 loss=0.5743 acc=0.8685 rss_mb=1686.6 ru_maxrss_mb=1686.6 py_current_mb=110.0 py_peak_mb=303.7 torch_allocated_mb=168.3 torch_mps_driver_mb=6492.5
[train] epoch=003: 100%|██████████| 17/17 [03:25<00:00, 10.56s/batch, acc=0.8685, loss=0.5743]                                                                                              [val] epoch=003:   0%|          | 0/2 [00:00<?, ?batch/s][val] epoch=003:   0%|          | 0/2 [00:07<?, ?batch/s, acc=0.8633, loss=0.5721][val] epoch=003:  50%|█████     | 1/2 [00:07<00:07,  7.16s/batch, acc=0.8633, loss=0.5721][val] epoch=003:  50%|█████     | 1/2 [00:07<00:07,  7.16s/batch, acc=0.8629, loss=0.5772][val] epoch=003 batch=2/2 loss=0.5772 acc=0.8629 rss_mb=1686.6 ru_maxrss_mb=1686.6 py_current_mb=110.0 py_peak_mb=303.7 torch_allocated_mb=110.8 torch_mps_driver_mb=6212.5
[val] epoch=003: 100%|██████████| 2/2 [00:07<00:00,  3.36s/batch, acc=0.8629, loss=0.5772]                                                                                          epoch=003 train_loss=0.5743 train_acc=0.8685 val_loss=0.5772 val_acc=0.8629
[train] epoch=003 rss_mb=1686.6 ru_maxrss_mb=1686.6 py_current_mb=110.0 py_peak_mb=303.7 torch_allocated_mb=40.3 torch_mps_driver_mb=6212.5
[train] epoch=004:   0%|          | 0/17 [00:00<?, ?batch/s][train] epoch=004:   0%|          | 0/17 [00:11<?, ?batch/s, acc=0.9141, loss=0.4915][train] epoch=004:   6%|▌         | 1/17 [00:11<03:03, 11.48s/batch, acc=0.9141, loss=0.4915][train] epoch=004:   6%|▌         | 1/17 [00:23<03:03, 11.48s/batch, acc=0.9199, loss=0.4856][train] epoch=004:  12%|█▏        | 2/17 [00:23<02:55, 11.73s/batch, acc=0.9199, loss=0.4856][train] epoch=004:  12%|█▏        | 2/17 [00:35<02:55, 11.73s/batch, acc=0.9154, loss=0.4909][train] epoch=004:  18%|█▊        | 3/17 [00:35<02:48, 12.03s/batch, acc=0.9154, loss=0.4909][train] epoch=004:  18%|█▊        | 3/17 [00:46<02:48, 12.03s/batch, acc=0.9189, loss=0.4880][train] epoch=004:  24%|██▎       | 4/17 [00:46<02:31, 11.67s/batch, acc=0.9189, loss=0.4880][train] epoch=004:  24%|██▎       | 4/17 [00:58<02:31, 11.67s/batch, acc=0.9180, loss=0.4882][train] epoch=004 batch=5/17 loss=0.4882 acc=0.9180 rss_mb=1693.6 ru_maxrss_mb=1693.6 py_current_mb=110.1 py_peak_mb=303.7 torch_allocated_mb=232.3 torch_mps_driver_mb=6724.5
[train] epoch=004:  29%|██▉       | 5/17 [00:59<02:21, 11.83s/batch, acc=0.9180, loss=0.4882][train] epoch=004:  29%|██▉       | 5/17 [01:12<02:21, 11.83s/batch, acc=0.9193, loss=0.4830][train] epoch=004:  35%|███▌      | 6/17 [01:12<02:14, 12.25s/batch, acc=0.9193, loss=0.4830][train] epoch=004:  35%|███▌      | 6/17 [01:25<02:14, 12.25s/batch, acc=0.9191, loss=0.4813][train] epoch=004:  41%|████      | 7/17 [01:25<02:05, 12.53s/batch, acc=0.9191, loss=0.4813][train] epoch=004:  41%|████      | 7/17 [01:39<02:05, 12.53s/batch, acc=0.9209, loss=0.4774][train] epoch=004:  47%|████▋     | 8/17 [01:39<01:56, 12.97s/batch, acc=0.9209, loss=0.4774][train] epoch=004:  47%|████▋     | 8/17 [01:50<01:56, 12.97s/batch, acc=0.9210, loss=0.4725][train] epoch=004:  53%|█████▎    | 9/17 [01:50<01:39, 12.50s/batch, acc=0.9210, loss=0.4725][train] epoch=004:  53%|█████▎    | 9/17 [02:01<01:39, 12.50s/batch, acc=0.9219, loss=0.4687][train] epoch=004 batch=10/17 loss=0.4687 acc=0.9219 rss_mb=1693.6 ru_maxrss_mb=1693.7 py_current_mb=110.1 py_peak_mb=303.7 torch_allocated_mb=232.3 torch_mps_driver_mb=6724.5
[train] epoch=004:  59%|█████▉    | 10/17 [02:01<01:23, 11.96s/batch, acc=0.9219, loss=0.4687][train] epoch=004:  59%|█████▉    | 10/17 [02:13<01:23, 11.96s/batch, acc=0.9219, loss=0.4676][train] epoch=004:  65%|██████▍   | 11/17 [02:13<01:11, 11.93s/batch, acc=0.9219, loss=0.4676][train] epoch=004:  65%|██████▍   | 11/17 [02:25<01:11, 11.93s/batch, acc=0.9232, loss=0.4636][train] epoch=004:  71%|███████   | 12/17 [02:25<00:59, 11.91s/batch, acc=0.9232, loss=0.4636][train] epoch=004:  71%|███████   | 12/17 [02:37<00:59, 11.91s/batch, acc=0.9246, loss=0.4612][train] epoch=004:  76%|███████▋  | 13/17 [02:37<00:48, 12.19s/batch, acc=0.9246, loss=0.4612][train] epoch=004:  76%|███████▋  | 13/17 [02:50<00:48, 12.19s/batch, acc=0.9252, loss=0.4585][train] epoch=004:  82%|████████▏ | 14/17 [02:50<00:36, 12.21s/batch, acc=0.9252, loss=0.4585][train] epoch=004:  82%|████████▏ | 14/17 [03:00<00:36, 12.21s/batch, acc=0.9255, loss=0.4561][train] epoch=004 batch=15/17 loss=0.4561 acc=0.9255 rss_mb=1693.6 ru_maxrss_mb=1693.7 py_current_mb=110.1 py_peak_mb=303.7 torch_allocated_mb=232.3 torch_mps_driver_mb=6724.5
[train] epoch=004:  88%|████████▊ | 15/17 [03:00<00:23, 11.55s/batch, acc=0.9255, loss=0.4561][train] epoch=004:  88%|████████▊ | 15/17 [03:13<00:23, 11.55s/batch, acc=0.9248, loss=0.4550][train] epoch=004:  94%|█████████▍| 16/17 [03:13<00:12, 12.02s/batch, acc=0.9248, loss=0.4550][train] epoch=004:  94%|█████████▍| 16/17 [03:19<00:12, 12.02s/batch, acc=0.9247, loss=0.4534][train] epoch=004 batch=17/17 loss=0.4534 acc=0.9247 rss_mb=1693.6 ru_maxrss_mb=1693.7 py_current_mb=110.0 py_peak_mb=303.7 torch_allocated_mb=168.3 torch_mps_driver_mb=6492.5
[train] epoch=004: 100%|██████████| 17/17 [03:19<00:00, 10.24s/batch, acc=0.9247, loss=0.4534]                                                                                              [val] epoch=004:   0%|          | 0/2 [00:00<?, ?batch/s][val] epoch=004:   0%|          | 0/2 [00:07<?, ?batch/s, acc=0.8945, loss=0.4435][val] epoch=004:  50%|█████     | 1/2 [00:07<00:07,  7.15s/batch, acc=0.8945, loss=0.4435][val] epoch=004:  50%|█████     | 1/2 [00:07<00:07,  7.15s/batch, acc=0.9000, loss=0.4453][val] epoch=004 batch=2/2 loss=0.4453 acc=0.9000 rss_mb=1693.6 ru_maxrss_mb=1693.7 py_current_mb=110.0 py_peak_mb=303.7 torch_allocated_mb=110.8 torch_mps_driver_mb=6212.5
[val] epoch=004: 100%|██████████| 2/2 [00:07<00:00,  3.33s/batch, acc=0.9000, loss=0.4453]                                                                                          epoch=004 train_loss=0.4534 train_acc=0.9247 val_loss=0.4453 val_acc=0.9000
[train] epoch=004 rss_mb=1693.6 ru_maxrss_mb=1693.7 py_current_mb=109.9 py_peak_mb=303.7 torch_allocated_mb=40.3 torch_mps_driver_mb=6212.5
[train] epoch=005:   0%|          | 0/17 [00:00<?, ?batch/s][train] epoch=005:   0%|          | 0/17 [00:12<?, ?batch/s, acc=0.9414, loss=0.4137][train] epoch=005:   6%|▌         | 1/17 [00:12<03:15, 12.20s/batch, acc=0.9414, loss=0.4137][train] epoch=005:   6%|▌         | 1/17 [00:23<03:15, 12.20s/batch, acc=0.9355, loss=0.4155][train] epoch=005:  12%|█▏        | 2/17 [00:23<02:57, 11.83s/batch, acc=0.9355, loss=0.4155][train] epoch=005:  12%|█▏        | 2/17 [00:34<02:57, 11.83s/batch, acc=0.9349, loss=0.4119][train] epoch=005:  18%|█▊        | 3/17 [00:34<02:39, 11.41s/batch, acc=0.9349, loss=0.4119][train] epoch=005:  18%|█▊        | 3/17 [00:45<02:39, 11.41s/batch, acc=0.9365, loss=0.4046][train] epoch=005:  24%|██▎       | 4/17 [00:45<02:25, 11.18s/batch, acc=0.9365, loss=0.4046][train] epoch=005:  24%|██▎       | 4/17 [00:57<02:25, 11.18s/batch, acc=0.9414, loss=0.3972][train] epoch=005 batch=5/17 loss=0.3972 acc=0.9414 rss_mb=1694.0 ru_maxrss_mb=1694.0 py_current_mb=110.1 py_peak_mb=303.7 torch_allocated_mb=232.3 torch_mps_driver_mb=6724.5
[train] epoch=005:  29%|██▉       | 5/17 [00:57<02:16, 11.35s/batch, acc=0.9414, loss=0.3972][train] epoch=005:  29%|██▉       | 5/17 [01:09<02:16, 11.35s/batch, acc=0.9408, loss=0.3982][train] epoch=005:  35%|███▌      | 6/17 [01:09<02:09, 11.79s/batch, acc=0.9408, loss=0.3982][train] epoch=005:  35%|███▌      | 6/17 [01:20<02:09, 11.79s/batch, acc=0.9397, loss=0.3993][train] epoch=005:  41%|████      | 7/17 [01:20<01:53, 11.30s/batch, acc=0.9397, loss=0.3993][train] epoch=005:  41%|████      | 7/17 [01:32<01:53, 11.30s/batch, acc=0.9385, loss=0.3986][train] epoch=005:  47%|████▋     | 8/17 [01:32<01:44, 11.57s/batch, acc=0.9385, loss=0.3986][train] epoch=005:  47%|████▋     | 8/17 [01:43<01:44, 11.57s/batch, acc=0.9375, loss=0.3967][train] epoch=005:  53%|█████▎    | 9/17 [01:43<01:31, 11.50s/batch, acc=0.9375, loss=0.3967][train] epoch=005:  53%|█████▎    | 9/17 [01:56<01:31, 11.50s/batch, acc=0.9371, loss=0.3976][train] epoch=005 batch=10/17 loss=0.3976 acc=0.9371 rss_mb=1694.0 ru_maxrss_mb=1694.0 py_current_mb=110.1 py_peak_mb=303.7 torch_allocated_mb=232.3 torch_mps_driver_mb=6724.5
[train] epoch=005:  59%|█████▉    | 10/17 [01:56<01:23, 11.92s/batch, acc=0.9371, loss=0.3976][train] epoch=005:  59%|█████▉    | 10/17 [02:08<01:23, 11.92s/batch, acc=0.9382, loss=0.3949][train] epoch=005:  65%|██████▍   | 11/17 [02:08<01:12, 12.11s/batch, acc=0.9382, loss=0.3949][train] epoch=005:  65%|██████▍   | 11/17 [02:22<01:12, 12.11s/batch, acc=0.9385, loss=0.3945][train] epoch=005:  71%|███████   | 12/17 [02:22<01:02, 12.55s/batch, acc=0.9385, loss=0.3945][train] epoch=005:  71%|███████   | 12/17 [02:34<01:02, 12.55s/batch, acc=0.9381, loss=0.3937][train] epoch=005:  76%|███████▋  | 13/17 [02:34<00:49, 12.46s/batch, acc=0.9381, loss=0.3937][train] epoch=005:  76%|███████▋  | 13/17 [02:47<00:49, 12.46s/batch, acc=0.9383, loss=0.3922][train] epoch=005:  82%|████████▏ | 14/17 [02:47<00:37, 12.46s/batch, acc=0.9383, loss=0.3922][train] epoch=005:  82%|████████▏ | 14/17 [02:57<00:37, 12.46s/batch, acc=0.9393, loss=0.3904][train] epoch=005 batch=15/17 loss=0.3904 acc=0.9393 rss_mb=1694.0 ru_maxrss_mb=1694.0 py_current_mb=110.1 py_peak_mb=303.7 torch_allocated_mb=232.3 torch_mps_driver_mb=6724.5
[train] epoch=005:  88%|████████▊ | 15/17 [02:57<00:23, 11.72s/batch, acc=0.9393, loss=0.3904][train] epoch=005:  88%|████████▊ | 15/17 [03:10<00:23, 11.72s/batch, acc=0.9399, loss=0.3891][train] epoch=005:  94%|█████████▍| 16/17 [03:10<00:12, 12.14s/batch, acc=0.9399, loss=0.3891][train] epoch=005:  94%|█████████▍| 16/17 [03:17<00:12, 12.14s/batch, acc=0.9407, loss=0.3881][train] epoch=005 batch=17/17 loss=0.3881 acc=0.9407 rss_mb=1694.0 ru_maxrss_mb=1694.0 py_current_mb=110.0 py_peak_mb=303.7 torch_allocated_mb=168.3 torch_mps_driver_mb=6492.5
[train] epoch=005: 100%|██████████| 17/17 [03:17<00:00, 10.59s/batch, acc=0.9407, loss=0.3881]                                                                                              [val] epoch=005:   0%|          | 0/2 [00:00<?, ?batch/s][val] epoch=005:   0%|          | 0/2 [00:07<?, ?batch/s, acc=0.9102, loss=0.3971][val] epoch=005:  50%|█████     | 1/2 [00:07<00:07,  7.04s/batch, acc=0.9102, loss=0.3971][val] epoch=005:  50%|█████     | 1/2 [00:07<00:07,  7.04s/batch, acc=0.9114, loss=0.4069][val] epoch=005 batch=2/2 loss=0.4069 acc=0.9114 rss_mb=1694.0 ru_maxrss_mb=1694.0 py_current_mb=110.0 py_peak_mb=303.7 torch_allocated_mb=110.8 torch_mps_driver_mb=6212.5
[val] epoch=005: 100%|██████████| 2/2 [00:07<00:00,  3.29s/batch, acc=0.9114, loss=0.4069]                                                                                          epoch=005 train_loss=0.3881 train_acc=0.9407 val_loss=0.4069 val_acc=0.9114
[train] epoch=005 rss_mb=1694.0 ru_maxrss_mb=1694.0 py_current_mb=110.0 py_peak_mb=303.7 torch_allocated_mb=40.3 torch_mps_driver_mb=6212.5
[train] epoch=006:   0%|          | 0/17 [00:00<?, ?batch/s][train] epoch=006:   0%|          | 0/17 [00:10<?, ?batch/s, acc=0.9531, loss=0.3801][train] epoch=006:   6%|▌         | 1/17 [00:10<02:51, 10.70s/batch, acc=0.9531, loss=0.3801][train] epoch=006:   6%|▌         | 1/17 [00:23<02:51, 10.70s/batch, acc=0.9355, loss=0.3929][train] epoch=006:  12%|█▏        | 2/17 [00:23<03:02, 12.15s/batch, acc=0.9355, loss=0.3929][train] epoch=006:  12%|█▏        | 2/17 [00:35<03:02, 12.15s/batch, acc=0.9453, loss=0.3825][train] epoch=006:  18%|█▊        | 3/17 [00:35<02:47, 11.98s/batch, acc=0.9453, loss=0.3825][train] epoch=006:  18%|█▊        | 3/17 [00:48<02:47, 11.98s/batch, acc=0.9482, loss=0.3795][train] epoch=006:  24%|██▎       | 4/17 [00:48<02:38, 12.22s/batch, acc=0.9482, loss=0.3795][train] epoch=006:  24%|██▎       | 4/17 [01:00<02:38, 12.22s/batch, acc=0.9492, loss=0.3783][train] epoch=006 batch=5/17 loss=0.3783 acc=0.9492 rss_mb=1694.1 ru_maxrss_mb=1694.1 py_current_mb=110.1 py_peak_mb=303.7 torch_allocated_mb=232.3 torch_mps_driver_mb=6724.5
[train] epoch=006:  29%|██▉       | 5/17 [01:00<02:26, 12.18s/batch, acc=0.9492, loss=0.3783][train] epoch=006:  29%|██▉       | 5/17 [01:12<02:26, 12.18s/batch, acc=0.9479, loss=0.3761][train] epoch=006:  35%|███▌      | 6/17 [01:12<02:15, 12.27s/batch, acc=0.9479, loss=0.3761][train] epoch=006:  35%|███▌      | 6/17 [01:26<02:15, 12.27s/batch, acc=0.9481, loss=0.3731][train] epoch=006:  41%|████      | 7/17 [01:26<02:06, 12.61s/batch, acc=0.9481, loss=0.3731][train] epoch=006:  41%|████      | 7/17 [01:40<02:06, 12.61s/batch, acc=0.9453, loss=0.3738][train] epoch=006:  47%|████▋     | 8/17 [01:40<01:57, 13.05s/batch, acc=0.9453, loss=0.3738][train] epoch=006:  47%|████▋     | 8/17 [01:52<01:57, 13.05s/batch, acc=0.9484, loss=0.3716][train] epoch=006:  53%|█████▎    | 9/17 [01:52<01:41, 12.72s/batch, acc=0.9484, loss=0.3716][train] epoch=006:  53%|█████▎    | 9/17 [02:03<01:41, 12.72s/batch, acc=0.9496, loss=0.3678][train] epoch=006 batch=10/17 loss=0.3678 acc=0.9496 rss_mb=1694.1 ru_maxrss_mb=1694.1 py_current_mb=110.1 py_peak_mb=303.7 torch_allocated_mb=232.3 torch_mps_driver_mb=6724.5
[train] epoch=006:  59%|█████▉    | 10/17 [02:03<01:26, 12.39s/batch, acc=0.9496, loss=0.3678][train] epoch=006:  59%|█████▉    | 10/17 [02:16<01:26, 12.39s/batch, acc=0.9499, loss=0.3671][train] epoch=006:  65%|██████▍   | 11/17 [02:16<01:15, 12.57s/batch, acc=0.9499, loss=0.3671][train] epoch=006:  65%|██████▍   | 11/17 [02:28<01:15, 12.57s/batch, acc=0.9492, loss=0.3668][train] epoch=006:  71%|███████   | 12/17 [02:28<01:02, 12.42s/batch, acc=0.9492, loss=0.3668][train] epoch=006:  71%|███████   | 12/17 [02:41<01:02, 12.42s/batch, acc=0.9492, loss=0.3654][train] epoch=006:  76%|███████▋  | 13/17 [02:41<00:49, 12.42s/batch, acc=0.9492, loss=0.3654][train] epoch=006:  76%|███████▋  | 13/17 [02:52<00:49, 12.42s/batch, acc=0.9509, loss=0.3641][train] epoch=006:  82%|████████▏ | 14/17 [02:52<00:36, 12.03s/batch, acc=0.9509, loss=0.3641][train] epoch=006:  82%|████████▏ | 14/17 [03:02<00:36, 12.03s/batch, acc=0.9521, loss=0.3624][train] epoch=006 batch=15/17 loss=0.3624 acc=0.9521 rss_mb=1694.2 ru_maxrss_mb=1694.2 py_current_mb=110.1 py_peak_mb=303.7 torch_allocated_mb=232.3 torch_mps_driver_mb=6724.5
[train] epoch=006:  88%|████████▊ | 15/17 [03:02<00:22, 11.47s/batch, acc=0.9521, loss=0.3624][train] epoch=006:  88%|████████▊ | 15/17 [03:12<00:22, 11.47s/batch, acc=0.9526, loss=0.3620][train] epoch=006:  94%|█████████▍| 16/17 [03:12<00:11, 11.10s/batch, acc=0.9526, loss=0.3620][train] epoch=006:  94%|█████████▍| 16/17 [03:20<00:11, 11.10s/batch, acc=0.9525, loss=0.3621][train] epoch=006 batch=17/17 loss=0.3621 acc=0.9525 rss_mb=1694.2 ru_maxrss_mb=1694.2 py_current_mb=110.0 py_peak_mb=303.7 torch_allocated_mb=168.3 torch_mps_driver_mb=6492.5
[train] epoch=006: 100%|██████████| 17/17 [03:20<00:00, 10.00s/batch, acc=0.9525, loss=0.3621]                                                                                              [val] epoch=006:   0%|          | 0/2 [00:00<?, ?batch/s][val] epoch=006:   0%|          | 0/2 [00:07<?, ?batch/s, acc=0.9219, loss=0.3596][val] epoch=006:  50%|█████     | 1/2 [00:07<00:07,  7.05s/batch, acc=0.9219, loss=0.3596][val] epoch=006:  50%|█████     | 1/2 [00:07<00:07,  7.05s/batch, acc=0.9229, loss=0.3605][val] epoch=006 batch=2/2 loss=0.3605 acc=0.9229 rss_mb=1694.2 ru_maxrss_mb=1694.2 py_current_mb=110.0 py_peak_mb=303.7 torch_allocated_mb=110.8 torch_mps_driver_mb=6212.5
[val] epoch=006: 100%|██████████| 2/2 [00:07<00:00,  3.30s/batch, acc=0.9229, loss=0.3605]                                                                                          epoch=006 train_loss=0.3621 train_acc=0.9525 val_loss=0.3605 val_acc=0.9229
[train] epoch=006 rss_mb=1694.2 ru_maxrss_mb=1694.2 py_current_mb=110.0 py_peak_mb=303.7 torch_allocated_mb=40.3 torch_mps_driver_mb=6212.5
[train] epoch=007:   0%|          | 0/17 [00:00<?, ?batch/s][train] epoch=007:   0%|          | 0/17 [00:11<?, ?batch/s, acc=0.9648, loss=0.3443][train] epoch=007:   6%|▌         | 1/17 [00:11<03:05, 11.59s/batch, acc=0.9648, loss=0.3443][train] epoch=007:   6%|▌         | 1/17 [00:24<03:05, 11.59s/batch, acc=0.9590, loss=0.3446][train] epoch=007:  12%|█▏        | 2/17 [00:24<03:06, 12.44s/batch, acc=0.9590, loss=0.3446][train] epoch=007:  12%|█▏        | 2/17 [00:36<03:06, 12.44s/batch, acc=0.9648, loss=0.3403][train] epoch=007:  18%|█▊        | 3/17 [00:36<02:51, 12.26s/batch, acc=0.9648, loss=0.3403][train] epoch=007:  18%|█▊        | 3/17 [00:48<02:51, 12.26s/batch, acc=0.9629, loss=0.3410][train] epoch=007:  24%|██▎       | 4/17 [00:48<02:35, 11.96s/batch, acc=0.9629, loss=0.3410][train] epoch=007:  24%|██▎       | 4/17 [00:59<02:35, 11.96s/batch, acc=0.9625, loss=0.3405][train] epoch=007 batch=5/17 loss=0.3405 acc=0.9625 rss_mb=1694.2 ru_maxrss_mb=1694.2 py_current_mb=110.1 py_peak_mb=303.7 torch_allocated_mb=232.3 torch_mps_driver_mb=6724.5
[train] epoch=007:  29%|██▉       | 5/17 [00:59<02:20, 11.73s/batch, acc=0.9625, loss=0.3405][train] epoch=007:  29%|██▉       | 5/17 [01:14<02:20, 11.73s/batch, acc=0.9629, loss=0.3388][train] epoch=007:  35%|███▌      | 6/17 [01:14<02:21, 12.88s/batch, acc=0.9629, loss=0.3388][train] epoch=007:  35%|███▌      | 6/17 [01:26<02:21, 12.88s/batch, acc=0.9643, loss=0.3403][train] epoch=007:  41%|████      | 7/17 [01:26<02:04, 12.42s/batch, acc=0.9643, loss=0.3403][train] epoch=007:  41%|████      | 7/17 [01:38<02:04, 12.42s/batch, acc=0.9629, loss=0.3437][train] epoch=007:  47%|████▋     | 8/17 [01:38<01:52, 12.53s/batch, acc=0.9629, loss=0.3437][train] epoch=007:  47%|████▋     | 8/17 [01:50<01:52, 12.53s/batch, acc=0.9618, loss=0.3431][train] epoch=007:  53%|█████▎    | 9/17 [01:50<01:38, 12.35s/batch, acc=0.9618, loss=0.3431][train] epoch=007:  53%|█████▎    | 9/17 [02:02<01:38, 12.35s/batch, acc=0.9605, loss=0.3423][train] epoch=007 batch=10/17 loss=0.3423 acc=0.9605 rss_mb=1694.2 ru_maxrss_mb=1694.2 py_current_mb=110.1 py_peak_mb=303.7 torch_allocated_mb=232.3 torch_mps_driver_mb=6724.5
[train] epoch=007:  59%|█████▉    | 10/17 [02:02<01:24, 12.06s/batch, acc=0.9605, loss=0.3423][train] epoch=007:  59%|█████▉    | 10/17 [02:13<01:24, 12.06s/batch, acc=0.9581, loss=0.3456][train] epoch=007:  65%|██████▍   | 11/17 [02:13<01:11, 11.95s/batch, acc=0.9581, loss=0.3456][train] epoch=007:  65%|██████▍   | 11/17 [02:25<01:11, 11.95s/batch, acc=0.9583, loss=0.3451][train] epoch=007:  71%|███████   | 12/17 [02:25<00:59, 11.92s/batch, acc=0.9583, loss=0.3451][train] epoch=007:  71%|███████   | 12/17 [02:37<00:59, 11.92s/batch, acc=0.9579, loss=0.3439][train] epoch=007:  76%|███████▋  | 13/17 [02:37<00:47, 11.82s/batch, acc=0.9579, loss=0.3439][train] epoch=007:  76%|███████▋  | 13/17 [02:46<00:47, 11.82s/batch, acc=0.9604, loss=0.3409][train] epoch=007:  82%|████████▏ | 14/17 [02:46<00:33, 11.03s/batch, acc=0.9604, loss=0.3409][train] epoch=007:  82%|████████▏ | 14/17 [02:57<00:33, 11.03s/batch, acc=0.9615, loss=0.3397][train] epoch=007 batch=15/17 loss=0.3397 acc=0.9615 rss_mb=1694.2 ru_maxrss_mb=1694.2 py_current_mb=110.1 py_peak_mb=303.7 torch_allocated_mb=232.3 torch_mps_driver_mb=6724.5
[train] epoch=007:  88%|████████▊ | 15/17 [02:57<00:21, 10.90s/batch, acc=0.9615, loss=0.3397][train] epoch=007:  88%|████████▊ | 15/17 [03:11<00:21, 10.90s/batch, acc=0.9624, loss=0.3376][train] epoch=007:  94%|█████████▍| 16/17 [03:11<00:11, 11.88s/batch, acc=0.9624, loss=0.3376][train] epoch=007:  94%|█████████▍| 16/17 [03:20<00:11, 11.88s/batch, acc=0.9627, loss=0.3372][train] epoch=007 batch=17/17 loss=0.3372 acc=0.9627 rss_mb=1694.2 ru_maxrss_mb=1694.2 py_current_mb=110.0 py_peak_mb=303.7 torch_allocated_mb=168.3 torch_mps_driver_mb=6492.5
[train] epoch=007: 100%|██████████| 17/17 [03:20<00:00, 11.04s/batch, acc=0.9627, loss=0.3372]                                                                                              [val] epoch=007:   0%|          | 0/2 [00:00<?, ?batch/s][val] epoch=007:   0%|          | 0/2 [00:07<?, ?batch/s, acc=0.9297, loss=0.3835][val] epoch=007:  50%|█████     | 1/2 [00:07<00:07,  7.06s/batch, acc=0.9297, loss=0.3835][val] epoch=007:  50%|█████     | 1/2 [00:07<00:07,  7.06s/batch, acc=0.9486, loss=0.3576][val] epoch=007 batch=2/2 loss=0.3576 acc=0.9486 rss_mb=1694.2 ru_maxrss_mb=1694.2 py_current_mb=110.0 py_peak_mb=303.7 torch_allocated_mb=110.8 torch_mps_driver_mb=6212.5
[val] epoch=007: 100%|██████████| 2/2 [00:07<00:00,  3.32s/batch, acc=0.9486, loss=0.3576]                                                                                          epoch=007 train_loss=0.3372 train_acc=0.9627 val_loss=0.3576 val_acc=0.9486
[train] epoch=007 rss_mb=1694.2 ru_maxrss_mb=1694.2 py_current_mb=110.0 py_peak_mb=303.7 torch_allocated_mb=40.3 torch_mps_driver_mb=6212.5
[train] epoch=008:   0%|          | 0/17 [00:00<?, ?batch/s][train] epoch=008:   0%|          | 0/17 [00:11<?, ?batch/s, acc=0.9648, loss=0.3274][train] epoch=008:   6%|▌         | 1/17 [00:11<03:09, 11.82s/batch, acc=0.9648, loss=0.3274][train] epoch=008:   6%|▌         | 1/17 [00:24<03:09, 11.82s/batch, acc=0.9707, loss=0.3230][train] epoch=008:  12%|█▏        | 2/17 [00:24<03:02, 12.14s/batch, acc=0.9707, loss=0.3230][train] epoch=008:  12%|█▏        | 2/17 [00:36<03:02, 12.14s/batch, acc=0.9727, loss=0.3148][train] epoch=008:  18%|█▊        | 3/17 [00:36<02:52, 12.29s/batch, acc=0.9727, loss=0.3148][train] epoch=008:  18%|█▊        | 3/17 [00:49<02:52, 12.29s/batch, acc=0.9727, loss=0.3175][train] epoch=008:  24%|██▎       | 4/17 [00:49<02:45, 12.70s/batch, acc=0.9727, loss=0.3175][train] epoch=008:  24%|██▎       | 4/17 [01:02<02:45, 12.70s/batch, acc=0.9727, loss=0.3161][train] epoch=008 batch=5/17 loss=0.3161 acc=0.9727 rss_mb=1694.4 ru_maxrss_mb=1694.4 py_current_mb=110.1 py_peak_mb=303.7 torch_allocated_mb=232.3 torch_mps_driver_mb=6724.5
[train] epoch=008:  29%|██▉       | 5/17 [01:02<02:31, 12.64s/batch, acc=0.9727, loss=0.3161][train] epoch=008:  29%|██▉       | 5/17 [01:15<02:31, 12.64s/batch, acc=0.9707, loss=0.3166][train] epoch=008:  35%|███▌      | 6/17 [01:15<02:19, 12.68s/batch, acc=0.9707, loss=0.3166][train] epoch=008:  35%|███▌      | 6/17 [01:26<02:19, 12.68s/batch, acc=0.9704, loss=0.3161][train] epoch=008:  41%|████      | 7/17 [01:26<02:01, 12.14s/batch, acc=0.9704, loss=0.3161][train] epoch=008:  41%|████      | 7/17 [01:37<02:01, 12.14s/batch, acc=0.9712, loss=0.3146][train] epoch=008:  47%|████▋     | 8/17 [01:37<01:45, 11.75s/batch, acc=0.9712, loss=0.3146][train] epoch=008:  47%|████▋     | 8/17 [01:50<01:45, 11.75s/batch, acc=0.9701, loss=0.3147][train] epoch=008:  53%|█████▎    | 9/17 [01:50<01:36, 12.08s/batch, acc=0.9701, loss=0.3147][train] epoch=008:  53%|█████▎    | 9/17 [02:01<01:36, 12.08s/batch, acc=0.9711, loss=0.3130][train] epoch=008 batch=10/17 loss=0.3130 acc=0.9711 rss_mb=1694.4 ru_maxrss_mb=1694.4 py_current_mb=110.1 py_peak_mb=303.7 torch_allocated_mb=232.3 torch_mps_driver_mb=6724.5
[train] epoch=008:  59%|█████▉    | 10/17 [02:01<01:23, 11.91s/batch, acc=0.9711, loss=0.3130][train] epoch=008:  59%|█████▉    | 10/17 [02:11<01:23, 11.91s/batch, acc=0.9723, loss=0.3114][train] epoch=008:  65%|██████▍   | 11/17 [02:11<01:08, 11.43s/batch, acc=0.9723, loss=0.3114][train] epoch=008:  65%|██████▍   | 11/17 [02:24<01:08, 11.43s/batch, acc=0.9694, loss=0.3136][train] epoch=008:  71%|███████   | 12/17 [02:24<00:58, 11.67s/batch, acc=0.9694, loss=0.3136][train] epoch=008:  71%|███████   | 12/17 [02:36<00:58, 11.67s/batch, acc=0.9700, loss=0.3156][train] epoch=008:  76%|███████▋  | 13/17 [02:36<00:47, 11.95s/batch, acc=0.9700, loss=0.3156][train] epoch=008:  76%|███████▋  | 13/17 [02:48<00:47, 11.95s/batch, acc=0.9690, loss=0.3174][train] epoch=008:  82%|████████▏ | 14/17 [02:48<00:35, 11.81s/batch, acc=0.9690, loss=0.3174][train] epoch=008:  82%|████████▏ | 14/17 [03:00<00:35, 11.81s/batch, acc=0.9674, loss=0.3185][train] epoch=008 batch=15/17 loss=0.3185 acc=0.9674 rss_mb=1694.4 ru_maxrss_mb=1694.4 py_current_mb=110.1 py_peak_mb=303.7 torch_allocated_mb=232.3 torch_mps_driver_mb=6724.5
[train] epoch=008:  88%|████████▊ | 15/17 [03:00<00:23, 11.83s/batch, acc=0.9674, loss=0.3185][train] epoch=008:  88%|████████▊ | 15/17 [03:12<00:23, 11.83s/batch, acc=0.9675, loss=0.3181][train] epoch=008:  94%|█████████▍| 16/17 [03:12<00:11, 11.95s/batch, acc=0.9675, loss=0.3181][train] epoch=008:  94%|█████████▍| 16/17 [03:18<00:11, 11.95s/batch, acc=0.9684, loss=0.3175][train] epoch=008 batch=17/17 loss=0.3175 acc=0.9684 rss_mb=1694.4 ru_maxrss_mb=1694.4 py_current_mb=110.0 py_peak_mb=303.7 torch_allocated_mb=168.3 torch_mps_driver_mb=6492.5
[train] epoch=008: 100%|██████████| 17/17 [03:18<00:00, 10.29s/batch, acc=0.9684, loss=0.3175]                                                                                              [val] epoch=008:   0%|          | 0/2 [00:00<?, ?batch/s][val] epoch=008:   0%|          | 0/2 [00:07<?, ?batch/s, acc=0.9297, loss=0.3595][val] epoch=008:  50%|█████     | 1/2 [00:07<00:07,  7.09s/batch, acc=0.9297, loss=0.3595][val] epoch=008:  50%|█████     | 1/2 [00:07<00:07,  7.09s/batch, acc=0.9486, loss=0.3388][val] epoch=008 batch=2/2 loss=0.3388 acc=0.9486 rss_mb=1694.4 ru_maxrss_mb=1694.4 py_current_mb=110.0 py_peak_mb=303.7 torch_allocated_mb=110.8 torch_mps_driver_mb=6212.5
[val] epoch=008: 100%|██████████| 2/2 [00:07<00:00,  3.32s/batch, acc=0.9486, loss=0.3388]                                                                                          epoch=008 train_loss=0.3175 train_acc=0.9684 val_loss=0.3388 val_acc=0.9486
[train] epoch=008 rss_mb=1694.4 ru_maxrss_mb=1694.4 py_current_mb=110.0 py_peak_mb=303.7 torch_allocated_mb=40.3 torch_mps_driver_mb=6212.5
[train] epoch=009:   0%|          | 0/17 [00:00<?, ?batch/s][train] epoch=009:   0%|          | 0/17 [00:11<?, ?batch/s, acc=0.9688, loss=0.3127][train] epoch=009:   6%|▌         | 1/17 [00:11<03:06, 11.64s/batch, acc=0.9688, loss=0.3127][train] epoch=009:   6%|▌         | 1/17 [00:22<03:06, 11.64s/batch, acc=0.9785, loss=0.3077][train] epoch=009:  12%|█▏        | 2/17 [00:22<02:47, 11.18s/batch, acc=0.9785, loss=0.3077][train] epoch=009:  12%|█▏        | 2/17 [00:34<02:47, 11.18s/batch, acc=0.9779, loss=0.3106][train] epoch=009:  18%|█▊        | 3/17 [00:34<02:41, 11.54s/batch, acc=0.9779, loss=0.3106][train] epoch=009:  18%|█▊        | 3/17 [00:46<02:41, 11.54s/batch, acc=0.9785, loss=0.3086][train] epoch=009:  24%|██▎       | 4/17 [00:46<02:31, 11.66s/batch, acc=0.9785, loss=0.3086][train] epoch=009:  24%|██▎       | 4/17 [00:57<02:31, 11.66s/batch, acc=0.9805, loss=0.3063][train] epoch=009 batch=5/17 loss=0.3063 acc=0.9805 rss_mb=1694.4 ru_maxrss_mb=1694.4 py_current_mb=110.1 py_peak_mb=303.8 torch_allocated_mb=232.3 torch_mps_driver_mb=6724.5
[train] epoch=009:  29%|██▉       | 5/17 [00:57<02:18, 11.57s/batch, acc=0.9805, loss=0.3063][train] epoch=009:  29%|██▉       | 5/17 [01:08<02:18, 11.57s/batch, acc=0.9818, loss=0.3022][train] epoch=009:  35%|███▌      | 6/17 [01:08<02:04, 11.28s/batch, acc=0.9818, loss=0.3022][train] epoch=009:  35%|███▌      | 6/17 [01:18<02:04, 11.28s/batch, acc=0.9816, loss=0.3027][train] epoch=009:  41%|████      | 7/17 [01:18<01:49, 10.96s/batch, acc=0.9816, loss=0.3027][train] epoch=009:  41%|████      | 7/17 [01:32<01:49, 10.96s/batch, acc=0.9790, loss=0.3040][train] epoch=009:  47%|████▋     | 8/17 [01:32<01:47, 11.99s/batch, acc=0.9790, loss=0.3040][train] epoch=009:  47%|████▋     | 8/17 [01:45<01:47, 11.99s/batch, acc=0.9770, loss=0.3057][train] epoch=009:  53%|█████▎    | 9/17 [01:45<01:37, 12.15s/batch, acc=0.9770, loss=0.3057][train] epoch=009:  53%|█████▎    | 9/17 [01:58<01:37, 12.15s/batch, acc=0.9773, loss=0.3045][train] epoch=009 batch=10/17 loss=0.3045 acc=0.9773 rss_mb=1694.4 ru_maxrss_mb=1694.4 py_current_mb=110.1 py_peak_mb=303.8 torch_allocated_mb=232.3 torch_mps_driver_mb=6724.5
[train] epoch=009:  59%|█████▉    | 10/17 [01:58<01:26, 12.37s/batch, acc=0.9773, loss=0.3045][train] epoch=009:  59%|█████▉    | 10/17 [02:08<01:26, 12.37s/batch, acc=0.9762, loss=0.3055][train] epoch=009:  65%|██████▍   | 11/17 [02:08<01:09, 11.62s/batch, acc=0.9762, loss=0.3055][train] epoch=009:  65%|██████▍   | 11/17 [02:21<01:09, 11.62s/batch, acc=0.9762, loss=0.3060][train] epoch=009:  71%|███████   | 12/17 [02:21<01:00, 12.05s/batch, acc=0.9762, loss=0.3060][train] epoch=009:  71%|███████   | 12/17 [02:35<01:00, 12.05s/batch, acc=0.9772, loss=0.3052][train] epoch=009:  76%|███████▋  | 13/17 [02:35<00:50, 12.68s/batch, acc=0.9772, loss=0.3052][train] epoch=009:  76%|███████▋  | 13/17 [02:49<00:50, 12.68s/batch, acc=0.9763, loss=0.3046][train] epoch=009:  82%|████████▏ | 14/17 [02:49<00:38, 12.98s/batch, acc=0.9763, loss=0.3046][train] epoch=009:  82%|████████▏ | 14/17 [03:00<00:38, 12.98s/batch, acc=0.9760, loss=0.3038][train] epoch=009 batch=15/17 loss=0.3038 acc=0.9760 rss_mb=1694.4 ru_maxrss_mb=1694.4 py_current_mb=110.1 py_peak_mb=303.8 torch_allocated_mb=232.3 torch_mps_driver_mb=6724.5
[train] epoch=009:  88%|████████▊ | 15/17 [03:00<00:25, 12.50s/batch, acc=0.9760, loss=0.3038][train] epoch=009:  88%|████████▊ | 15/17 [03:14<00:25, 12.50s/batch, acc=0.9761, loss=0.3031][train] epoch=009:  94%|█████████▍| 16/17 [03:14<00:13, 13.00s/batch, acc=0.9761, loss=0.3031][train] epoch=009:  94%|█████████▍| 16/17 [03:20<00:13, 13.00s/batch, acc=0.9762, loss=0.3029][train] epoch=009 batch=17/17 loss=0.3029 acc=0.9762 rss_mb=1694.4 ru_maxrss_mb=1694.4 py_current_mb=110.0 py_peak_mb=303.8 torch_allocated_mb=168.3 torch_mps_driver_mb=6492.5
[train] epoch=009: 100%|██████████| 17/17 [03:20<00:00, 10.96s/batch, acc=0.9762, loss=0.3029]                                                                                              [val] epoch=009:   0%|          | 0/2 [00:00<?, ?batch/s][val] epoch=009:   0%|          | 0/2 [00:07<?, ?batch/s, acc=0.9844, loss=0.2784][val] epoch=009:  50%|█████     | 1/2 [00:07<00:07,  7.07s/batch, acc=0.9844, loss=0.2784][val] epoch=009:  50%|█████     | 1/2 [00:07<00:07,  7.07s/batch, acc=0.9886, loss=0.2673][val] epoch=009 batch=2/2 loss=0.2673 acc=0.9886 rss_mb=1694.4 ru_maxrss_mb=1694.4 py_current_mb=110.0 py_peak_mb=303.8 torch_allocated_mb=110.8 torch_mps_driver_mb=6212.5
[val] epoch=009: 100%|██████████| 2/2 [00:07<00:00,  3.31s/batch, acc=0.9886, loss=0.2673]                                                                                          epoch=009 train_loss=0.3029 train_acc=0.9762 val_loss=0.2673 val_acc=0.9886
[train] epoch=009 rss_mb=1694.4 ru_maxrss_mb=1694.4 py_current_mb=110.0 py_peak_mb=303.8 torch_allocated_mb=40.3 torch_mps_driver_mb=6212.5
[train] epoch=010:   0%|          | 0/17 [00:00<?, ?batch/s][train] epoch=010:   0%|          | 0/17 [00:11<?, ?batch/s, acc=0.9844, loss=0.2762][train] epoch=010:   6%|▌         | 1/17 [00:11<03:08, 11.75s/batch, acc=0.9844, loss=0.2762][train] epoch=010:   6%|▌         | 1/17 [00:23<03:08, 11.75s/batch, acc=0.9785, loss=0.2875][train] epoch=010:  12%|█▏        | 2/17 [00:23<02:52, 11.48s/batch, acc=0.9785, loss=0.2875][train] epoch=010:  12%|█▏        | 2/17 [00:38<02:52, 11.48s/batch, acc=0.9818, loss=0.2864][train] epoch=010:  18%|█▊        | 3/17 [00:38<03:03, 13.11s/batch, acc=0.9818, loss=0.2864][train] epoch=010:  18%|█▊        | 3/17 [00:49<03:03, 13.11s/batch, acc=0.9854, loss=0.2871][train] epoch=010:  24%|██▎       | 4/17 [00:49<02:39, 12.25s/batch, acc=0.9854, loss=0.2871][train] epoch=010:  24%|██▎       | 4/17 [01:00<02:39, 12.25s/batch, acc=0.9836, loss=0.2887][train] epoch=010 batch=5/17 loss=0.2887 acc=0.9836 rss_mb=1694.5 ru_maxrss_mb=1694.5 py_current_mb=110.1 py_peak_mb=303.8 torch_allocated_mb=232.3 torch_mps_driver_mb=6724.5
[train] epoch=010:  29%|██▉       | 5/17 [01:00<02:24, 12.04s/batch, acc=0.9836, loss=0.2887][train] epoch=010:  29%|██▉       | 5/17 [01:10<02:24, 12.04s/batch, acc=0.9811, loss=0.2910][train] epoch=010:  35%|███▌      | 6/17 [01:10<02:05, 11.42s/batch, acc=0.9811, loss=0.2910][train] epoch=010:  35%|███▌      | 6/17 [01:21<02:05, 11.42s/batch, acc=0.9810, loss=0.2927][train] epoch=010:  41%|████      | 7/17 [01:21<01:52, 11.24s/batch, acc=0.9810, loss=0.2927][train] epoch=010:  41%|████      | 7/17 [01:35<01:52, 11.24s/batch, acc=0.9800, loss=0.2925][train] epoch=010:  47%|████▋     | 8/17 [01:35<01:48, 12.01s/batch, acc=0.9800, loss=0.2925][train] epoch=010:  47%|████▋     | 8/17 [01:47<01:48, 12.01s/batch, acc=0.9783, loss=0.2946][train] epoch=010:  53%|█████▎    | 9/17 [01:47<01:37, 12.17s/batch, acc=0.9783, loss=0.2946][train] epoch=010:  53%|█████▎    | 9/17 [02:01<01:37, 12.17s/batch, acc=0.9773, loss=0.2960][train] epoch=010 batch=10/17 loss=0.2960 acc=0.9773 rss_mb=1694.5 ru_maxrss_mb=1694.5 py_current_mb=110.1 py_peak_mb=303.8 torch_allocated_mb=232.3 torch_mps_driver_mb=6724.5
[train] epoch=010:  59%|█████▉    | 10/17 [02:01<01:27, 12.55s/batch, acc=0.9773, loss=0.2960][train] epoch=010:  59%|█████▉    | 10/17 [02:14<01:27, 12.55s/batch, acc=0.9780, loss=0.2950][train] epoch=010:  65%|██████▍   | 11/17 [02:14<01:15, 12.65s/batch, acc=0.9780, loss=0.2950][train] epoch=010:  65%|██████▍   | 11/17 [02:25<01:15, 12.65s/batch, acc=0.9782, loss=0.2949][train] epoch=010:  71%|███████   | 12/17 [02:25<01:01, 12.29s/batch, acc=0.9782, loss=0.2949][train] epoch=010:  71%|███████   | 12/17 [02:37<01:01, 12.29s/batch, acc=0.9778, loss=0.2945][train] epoch=010:  76%|███████▋  | 13/17 [02:37<00:48, 12.20s/batch, acc=0.9778, loss=0.2945][train] epoch=010:  76%|███████▋  | 13/17 [02:51<00:48, 12.20s/batch, acc=0.9774, loss=0.2945][train] epoch=010:  82%|████████▏ | 14/17 [02:51<00:37, 12.64s/batch, acc=0.9774, loss=0.2945][train] epoch=010:  82%|████████▏ | 14/17 [03:03<00:37, 12.64s/batch, acc=0.9776, loss=0.2944][train] epoch=010 batch=15/17 loss=0.2944 acc=0.9776 rss_mb=1694.6 ru_maxrss_mb=1694.6 py_current_mb=110.1 py_peak_mb=303.8 torch_allocated_mb=232.3 torch_mps_driver_mb=6724.5
[train] epoch=010:  88%|████████▊ | 15/17 [03:03<00:25, 12.63s/batch, acc=0.9776, loss=0.2944][train] epoch=010:  88%|████████▊ | 15/17 [03:15<00:25, 12.63s/batch, acc=0.9783, loss=0.2936][train] epoch=010:  94%|█████████▍| 16/17 [03:15<00:12, 12.34s/batch, acc=0.9783, loss=0.2936][train] epoch=010:  94%|█████████▍| 16/17 [03:21<00:12, 12.34s/batch, acc=0.9783, loss=0.2938][train] epoch=010 batch=17/17 loss=0.2938 acc=0.9783 rss_mb=1694.6 ru_maxrss_mb=1694.6 py_current_mb=110.0 py_peak_mb=303.8 torch_allocated_mb=168.3 torch_mps_driver_mb=6492.5
[train] epoch=010: 100%|██████████| 17/17 [03:21<00:00, 10.48s/batch, acc=0.9783, loss=0.2938]                                                                                              [val] epoch=010:   0%|          | 0/2 [00:00<?, ?batch/s][val] epoch=010:   0%|          | 0/2 [00:07<?, ?batch/s, acc=0.9766, loss=0.3042][val] epoch=010:  50%|█████     | 1/2 [00:07<00:07,  7.08s/batch, acc=0.9766, loss=0.3042][val] epoch=010:  50%|█████     | 1/2 [00:07<00:07,  7.08s/batch, acc=0.9829, loss=0.2925][val] epoch=010 batch=2/2 loss=0.2925 acc=0.9829 rss_mb=1694.6 ru_maxrss_mb=1694.6 py_current_mb=110.0 py_peak_mb=303.8 torch_allocated_mb=110.8 torch_mps_driver_mb=6212.5
[val] epoch=010: 100%|██████████| 2/2 [00:07<00:00,  3.32s/batch, acc=0.9829, loss=0.2925]                                                                                          epoch=010 train_loss=0.2938 train_acc=0.9783 val_loss=0.2925 val_acc=0.9829
[train] epoch=010 rss_mb=1694.6 ru_maxrss_mb=1694.6 py_current_mb=110.0 py_peak_mb=303.8 torch_allocated_mb=40.3 torch_mps_driver_mb=6212.5
[train] no improvement for 1 epoch(s); patience=2
best_val_accuracy=0.9886 checkpoint=/Users/helios/rotation-detection/runs/mid_small_debug_v2/models/orientation_cnn.pt
[train] done memory rss_mb=1694.6 ru_maxrss_mb=1694.6 py_current_mb=110.0 py_peak_mb=303.8 torch_allocated_mb=40.3 torch_mps_driver_mb=6212.5
Training report: /Users/helios/rotation-detection/runs/mid_small_debug_v2/models/orientation_cnn.report.json
[train] final memory rss_mb=1694.6 ru_maxrss_mb=1694.6 py_current_mb=109.9 py_peak_mb=303.8
