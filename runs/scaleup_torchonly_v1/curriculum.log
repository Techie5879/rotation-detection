[logging] tee enabled log_file=/Users/helios/rotation-detection/runs/scaleup_torchonly_v1/curriculum.log
[curriculum] run_dir=/Users/helios/rotation-detection/runs/scaleup_torchonly_v1
[curriculum] starting stage01_cap400 max_pages_per_doc=400
[logging] tee enabled log_file=/Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage01_cap400/run.log
[experiment] run_dir=/Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage01_cap400
[logging] tee enabled log_file=/Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage01_cap400/dataset/dataset.log
[dataset] run_dir=/Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage01_cap400/dataset
[dataset] start split=train doc_id=6c199e86-deaf-48f0-ab1a-c21b10a17c3e-073482be5d target_pages=400
[dataset] progress doc_id=6c199e86-deaf-48f0-ab1a-c21b10a17c3e-073482be5d split=train doc_pages=250/400 overall=250/2671 rate_pps=7.68
[dataset] done split=train doc_id=6c199e86-deaf-48f0-ab1a-c21b10a17c3e-073482be5d pages=400 elapsed_s=50.6
[dataset] start split=test doc_id=EW-2-22626634-bd3f678897 target_pages=400
[dataset] progress doc_id=EW-2-22626634-bd3f678897 split=test doc_pages=250/400 overall=650/2671 rate_pps=8.82
[dataset] done split=test doc_id=EW-2-22626634-bd3f678897 pages=400 elapsed_s=32.2
[dataset] start split=train doc_id=EW-2-22696801-705c326024 target_pages=400
[dataset] progress doc_id=EW-2-22696801-705c326024 split=train doc_pages=250/400 overall=1050/2671 rate_pps=9.55
[dataset] done split=train doc_id=EW-2-22696801-705c326024 pages=400 elapsed_s=40.7
[dataset] start split=train doc_id=EW-2-22697100-11c88f020b target_pages=52
[dataset] done split=train doc_id=EW-2-22697100-11c88f020b pages=52 elapsed_s=6.3
[dataset] start split=train doc_id=EW-2-22697155-5c367b1d0d target_pages=400
[dataset] progress doc_id=EW-2-22697155-5c367b1d0d split=train doc_pages=250/400 overall=1502/2671 rate_pps=7.90
[dataset] done split=train doc_id=EW-2-22697155-5c367b1d0d pages=400 elapsed_s=80.6
[dataset] start split=train doc_id=EW-2-22697411-e1a0161a7a target_pages=293
[dataset] progress doc_id=EW-2-22697411-e1a0161a7a split=train doc_pages=250/293 overall=1902/2671 rate_pps=8.01
[dataset] done split=train doc_id=EW-2-22697411-e1a0161a7a pages=293 elapsed_s=31.9
[dataset] start split=train doc_id=EW-2-22714892-06e937c20d target_pages=175
[dataset] done split=train doc_id=EW-2-22714892-06e937c20d pages=175 elapsed_s=25.1
[dataset] start split=val doc_id=BI-Serrano-medical-records-512b805074 target_pages=400
[dataset] progress doc_id=BI-Serrano-medical-records-512b805074 split=val doc_pages=250/400 overall=2370/2671 rate_pps=8.13
[dataset] done split=val doc_id=BI-Serrano-medical-records-512b805074 pages=400 elapsed_s=35.0
[dataset] start split=train doc_id=BI-Serrano-medical-records-_p0001-0060_p-41984ec981 target_pages=151
[dataset] done split=train doc_id=BI-Serrano-medical-records-_p0001-0060_p-41984ec981 pages=151 elapsed_s=13.5
[dataset] completed total_pages=2671 elapsed_s=316.0 avg_pps=8.45
Dataset created: /Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage01_cap400/dataset
Documents: 9
Split train: docs=7 pages=1871
Split val: docs=1 pages=400
Split test: docs=1 pages=400
All labels: /Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage01_cap400/dataset/labels.all.jsonl
Manifest: /Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage01_cap400/dataset/manifest.json
[logging] tee enabled log_file=/Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage01_cap400/models/orientation_cnn.train.log
[train] checkpoint=/Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage01_cap400/models/orientation_cnn.pt
[train] rows train=1871 val=400
[train] num_workers>0 requested but shared-memory workers are unstable in this environment; falling back to num_workers=0
[train] epoch=001 batch=20/20 loss=1.0577 acc=0.5719
[val] epoch=001 batch=5/5 loss=1.3509 acc=0.3750
epoch=001 train_loss=1.0577 train_acc=0.5719 val_loss=1.3509 val_acc=0.3750
[train] epoch=002 batch=20/20 loss=0.7661 acc=0.8081
[val] epoch=002 batch=5/5 loss=1.2239 acc=0.4600
epoch=002 train_loss=0.7661 train_acc=0.8081 val_loss=1.2239 val_acc=0.4600
[train] epoch=003 batch=20/20 loss=0.5763 acc=0.9038
[val] epoch=003 batch=5/5 loss=1.2196 acc=0.4425
epoch=003 train_loss=0.5763 train_acc=0.9038 val_loss=1.2196 val_acc=0.4425
[train] epoch=004 batch=20/20 loss=0.4596 acc=0.9337
[val] epoch=004 batch=5/5 loss=1.2092 acc=0.4500
epoch=004 train_loss=0.4596 train_acc=0.9337 val_loss=1.2092 val_acc=0.4500
best_val_accuracy=0.4600 checkpoint=/Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage01_cap400/models/orientation_cnn.pt
Training report: /Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage01_cap400/models/orientation_cnn.report.json
[logging] tee enabled log_file=/Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage01_cap400/predictions.torch.jsonl.log
[detect] output=/Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage01_cap400/predictions.torch.jsonl
[detect] start method=torch targets=1 total_pages=400
[detect] progress method=torch overall=250/400 rate_pps=105.17
detected doc_id=EW-2-22626634-bd3f678897 pages=400 elapsed_s=3.7 pdf=/Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage01_cap400/dataset/test/pdfs/EW-2-22626634-bd3f678897.pdf
[detect] completed method=torch pages=400 elapsed_s=3.7 avg_pps=106.93
Predictions written: /Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage01_cap400/predictions.torch.jsonl
[logging] tee enabled log_file=/Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage01_cap400/report.torch.eval.log
[eval] manifest=/Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage01_cap400/dataset/test/manifest.json
[eval] predictions=/Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage01_cap400/predictions.torch.jsonl
Evaluation report: /Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage01_cap400/report.torch.json
accuracy=0.8000 found=400/400 correct=320
Experiment summary: /Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage01_cap400/summary.json
[curriculum] completed stage01_cap400 torch_acc=0.8000
[curriculum] starting stage02_cap800 max_pages_per_doc=800
[logging] tee enabled log_file=/Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage02_cap800/run.log
[experiment] run_dir=/Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage02_cap800
[logging] tee enabled log_file=/Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage02_cap800/dataset/dataset.log
[dataset] run_dir=/Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage02_cap800/dataset
[dataset] start split=train doc_id=6c199e86-deaf-48f0-ab1a-c21b10a17c3e-073482be5d target_pages=800
[dataset] progress doc_id=6c199e86-deaf-48f0-ab1a-c21b10a17c3e-073482be5d split=train doc_pages=250/800 overall=250/4033 rate_pps=7.71
[dataset] progress doc_id=6c199e86-deaf-48f0-ab1a-c21b10a17c3e-073482be5d split=train doc_pages=500/800 overall=500/4033 rate_pps=7.84
[dataset] progress doc_id=6c199e86-deaf-48f0-ab1a-c21b10a17c3e-073482be5d split=train doc_pages=750/800 overall=750/4033 rate_pps=7.75
[dataset] done split=train doc_id=6c199e86-deaf-48f0-ab1a-c21b10a17c3e-073482be5d pages=800 elapsed_s=102.7
[dataset] start split=test doc_id=EW-2-22626634-bd3f678897 target_pages=800
[dataset] progress doc_id=EW-2-22626634-bd3f678897 split=test doc_pages=250/800 overall=1050/4033 rate_pps=8.32
[dataset] progress doc_id=EW-2-22626634-bd3f678897 split=test doc_pages=500/800 overall=1300/4033 rate_pps=8.91
[dataset] progress doc_id=EW-2-22626634-bd3f678897 split=test doc_pages=750/800 overall=1550/4033 rate_pps=9.06
[dataset] done split=test doc_id=EW-2-22626634-bd3f678897 pages=800 elapsed_s=72.0
[dataset] start split=train doc_id=EW-2-22696801-705c326024 target_pages=458
[dataset] progress doc_id=EW-2-22696801-705c326024 split=train doc_pages=250/458 overall=1850/4033 rate_pps=9.16
[dataset] done split=train doc_id=EW-2-22696801-705c326024 pages=458 elapsed_s=45.2
[dataset] start split=train doc_id=EW-2-22697100-11c88f020b target_pages=52
[dataset] done split=train doc_id=EW-2-22697100-11c88f020b pages=52 elapsed_s=6.4
[dataset] start split=train doc_id=EW-2-22697155-5c367b1d0d target_pages=504
[dataset] progress doc_id=EW-2-22697155-5c367b1d0d split=train doc_pages=250/504 overall=2360/4033 rate_pps=8.19
[dataset] progress doc_id=EW-2-22697155-5c367b1d0d split=train doc_pages=500/504 overall=2610/4033 rate_pps=8.23
[dataset] done split=train doc_id=EW-2-22697155-5c367b1d0d pages=504 elapsed_s=91.5
[dataset] start split=train doc_id=EW-2-22697411-e1a0161a7a target_pages=293
[dataset] progress doc_id=EW-2-22697411-e1a0161a7a split=train doc_pages=250/293 overall=2864/4033 rate_pps=8.31
[dataset] done split=train doc_id=EW-2-22697411-e1a0161a7a pages=293 elapsed_s=32.0
[dataset] start split=train doc_id=EW-2-22714892-06e937c20d target_pages=175
[dataset] done split=train doc_id=EW-2-22714892-06e937c20d pages=175 elapsed_s=25.3
[dataset] start split=val doc_id=BI-Serrano-medical-records-512b805074 target_pages=800
[dataset] progress doc_id=BI-Serrano-medical-records-512b805074 split=val doc_pages=250/800 overall=3332/4033 rate_pps=8.35
[dataset] progress doc_id=BI-Serrano-medical-records-512b805074 split=val doc_pages=500/800 overall=3582/4033 rate_pps=8.61
[dataset] progress doc_id=BI-Serrano-medical-records-512b805074 split=val doc_pages=750/800 overall=3832/4033 rate_pps=8.65
[dataset] done split=val doc_id=BI-Serrano-medical-records-512b805074 pages=800 elapsed_s=73.4
[dataset] start split=train doc_id=BI-Serrano-medical-records-_p0001-0060_p-41984ec981 target_pages=151
[dataset] done split=train doc_id=BI-Serrano-medical-records-_p0001-0060_p-41984ec981 pages=151 elapsed_s=13.6
[dataset] completed total_pages=4033 elapsed_s=462.1 avg_pps=8.73
Dataset created: /Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage02_cap800/dataset
Documents: 9
Split train: docs=7 pages=2433
Split val: docs=1 pages=800
Split test: docs=1 pages=800
All labels: /Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage02_cap800/dataset/labels.all.jsonl
Manifest: /Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage02_cap800/dataset/manifest.json
[logging] tee enabled log_file=/Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage02_cap800/models/orientation_cnn.train.log
[train] checkpoint=/Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage02_cap800/models/orientation_cnn.pt
[train] rows train=2433 val=800
[train] num_workers>0 requested but shared-memory workers are unstable in this environment; falling back to num_workers=0
[train] epoch=001 batch=20/26 loss=1.0784 acc=0.5437
[train] epoch=001 batch=26/26 loss=1.0258 acc=0.5956
[val] epoch=001 batch=9/9 loss=1.3184 acc=0.3450
epoch=001 train_loss=1.0258 train_acc=0.5956 val_loss=1.3184 val_acc=0.3450
[train] epoch=002 batch=20/26 loss=0.7036 acc=0.8464
[train] epoch=002 batch=26/26 loss=0.6856 acc=0.8578
[val] epoch=002 batch=9/9 loss=1.4644 acc=0.3187
epoch=002 train_loss=0.6856 train_acc=0.8578 val_loss=1.4644 val_acc=0.3187
[train] epoch=003 batch=20/26 loss=0.5023 acc=0.9333
[train] epoch=003 batch=26/26 loss=0.4916 acc=0.9342
[val] epoch=003 batch=9/9 loss=1.5279 acc=0.3050
epoch=003 train_loss=0.4916 train_acc=0.9342 val_loss=1.5279 val_acc=0.3050
[train] epoch=004 batch=20/26 loss=0.4100 acc=0.9521
[train] epoch=004 batch=26/26 loss=0.3980 acc=0.9560
[val] epoch=004 batch=9/9 loss=1.2821 acc=0.4138
epoch=004 train_loss=0.3980 train_acc=0.9560 val_loss=1.2821 val_acc=0.4138
best_val_accuracy=0.4138 checkpoint=/Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage02_cap800/models/orientation_cnn.pt
Training report: /Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage02_cap800/models/orientation_cnn.report.json
[logging] tee enabled log_file=/Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage02_cap800/predictions.torch.jsonl.log
[detect] output=/Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage02_cap800/predictions.torch.jsonl
[detect] start method=torch targets=1 total_pages=800
[detect] progress method=torch overall=250/800 rate_pps=104.62
[detect] progress method=torch overall=500/800 rate_pps=105.44
[detect] progress method=torch overall=750/800 rate_pps=105.14
detected doc_id=EW-2-22626634-bd3f678897 pages=800 elapsed_s=7.6 pdf=/Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage02_cap800/dataset/test/pdfs/EW-2-22626634-bd3f678897.pdf
[detect] completed method=torch pages=800 elapsed_s=7.6 avg_pps=105.26
Predictions written: /Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage02_cap800/predictions.torch.jsonl
[logging] tee enabled log_file=/Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage02_cap800/report.torch.eval.log
[eval] manifest=/Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage02_cap800/dataset/test/manifest.json
[eval] predictions=/Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage02_cap800/predictions.torch.jsonl
Evaluation report: /Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage02_cap800/report.torch.json
accuracy=0.9925 found=800/800 correct=794
Experiment summary: /Users/helios/rotation-detection/runs/scaleup_torchonly_v1/stage02_cap800/summary.json
[curriculum] completed stage02_cap800 torch_acc=0.9925
[curriculum] summary: /Users/helios/rotation-detection/runs/scaleup_torchonly_v1/curriculum_summary.json
