[logging] tee enabled log_file=/Users/helios/rotation-detection/runs/smoke_pagepool_1k/models/instrument_smoke.train.log
[train] checkpoint=/Users/helios/rotation-detection/runs/smoke_pagepool_1k/models/instrument_smoke.pt
[train] start memory {'rss_mb': 47.390625, 'ru_maxrss_mb': 47.40625, 'py_current_mb': 0.0, 'py_peak_mb': 0.0, 'torch_allocated_mb': None, 'torch_reserved_mb': None, 'torch_mps_driver_mb': None}
[train] data_sampling class_balance=uniform split_strategy=document_page_weighted min_val_docs=8 min_test_docs=8
[train] rows train=600 val=150
[train] init memory rss_mb=346.8 ru_maxrss_mb=346.8 py_current_mb=104.3 py_peak_mb=104.6 torch_allocated_mb=2.9 torch_mps_driver_mb=48.5
[train] epoch=001:   0%|          | 0/5 [00:00<?, ?batch/s][train] epoch=001:   0%|          | 0/5 [00:07<?, ?batch/s, acc=0.1953, loss=1.4114][train] epoch=001:  20%|██        | 1/5 [00:07<00:29,  7.33s/batch, acc=0.1953, loss=1.4114][train] epoch=001:  20%|██        | 1/5 [00:12<00:29,  7.33s/batch, acc=0.2773, loss=1.4482][train] epoch=001:  40%|████      | 2/5 [00:12<00:17,  5.95s/batch, acc=0.2773, loss=1.4482][train] epoch=001:  40%|████      | 2/5 [00:17<00:17,  5.95s/batch, acc=0.3151, loss=1.4214][train] epoch=001:  60%|██████    | 3/5 [00:17<00:11,  5.54s/batch, acc=0.3151, loss=1.4214][train] epoch=001:  60%|██████    | 3/5 [00:22<00:11,  5.54s/batch, acc=0.3555, loss=1.3531][train] epoch=001:  80%|████████  | 4/5 [00:22<00:05,  5.37s/batch, acc=0.3555, loss=1.3531][train] epoch=001:  80%|████████  | 4/5 [00:26<00:05,  5.37s/batch, acc=0.3867, loss=1.3037][train] epoch=001 batch=5/5 loss=1.3037 acc=0.3867 rss_mb=1124.2 ru_maxrss_mb=1124.2 py_current_mb=104.1 py_peak_mb=201.7 torch_allocated_mb=126.9 torch_mps_driver_mb=2364.5
[train] epoch=001: 100%|██████████| 5/5 [00:26<00:00,  4.93s/batch, acc=0.3867, loss=1.3037]                                                                                            [val] epoch=001:   0%|          | 0/2 [00:00<?, ?batch/s][val] epoch=001:   0%|          | 0/2 [00:02<?, ?batch/s, acc=0.2578, loss=1.3860][val] epoch=001:  50%|█████     | 1/2 [00:02<00:02,  2.27s/batch, acc=0.2578, loss=1.3860][val] epoch=001:  50%|█████     | 1/2 [00:02<00:02,  2.27s/batch, acc=0.2400, loss=1.3867][val] epoch=001 batch=2/2 loss=1.3867 acc=0.2400 rss_mb=1164.9 ru_maxrss_mb=1164.9 py_current_mb=104.1 py_peak_mb=201.7 torch_allocated_mb=54.7 torch_mps_driver_mb=3388.6
[val] epoch=001: 100%|██████████| 2/2 [00:02<00:00,  1.24s/batch, acc=0.2400, loss=1.3867]                                                                                          epoch=001 train_loss=1.3037 train_acc=0.3867 val_loss=1.3867 val_acc=0.2400
[train] epoch=001 gaps acc=0.1467 loss=0.0830
[train] epoch=001 train_per_angle 0:0.304(135) 90:0.389(157) 180:0.340(141) 270:0.491(167)
[train] epoch=001 val_per_angle 0:0.000(37) 90:1.000(36) 180:0.000(39) 270:0.000(38)
[train] epoch=001 val_top_confusions 180->90:39, 270->90:38, 0->90:37 avg_conf=0.2662 avg_entropy_nats=1.3853
[train] epoch=001 rss_mb=1164.9 ru_maxrss_mb=1164.9 py_current_mb=104.1 py_peak_mb=201.7 torch_allocated_mb=30.6 torch_mps_driver_mb=3388.6
[train] epoch=002:   0%|          | 0/5 [00:00<?, ?batch/s][train] epoch=002:   0%|          | 0/5 [00:06<?, ?batch/s, acc=0.5625, loss=0.9647][train] epoch=002:  20%|██        | 1/5 [00:06<00:25,  6.41s/batch, acc=0.5625, loss=0.9647][train] epoch=002:  20%|██        | 1/5 [00:11<00:25,  6.41s/batch, acc=0.5352, loss=1.0131][train] epoch=002:  40%|████      | 2/5 [00:11<00:17,  5.75s/batch, acc=0.5352, loss=1.0131][train] epoch=002:  40%|████      | 2/5 [00:16<00:17,  5.75s/batch, acc=0.5234, loss=0.9982][train] epoch=002:  60%|██████    | 3/5 [00:16<00:10,  5.19s/batch, acc=0.5234, loss=0.9982][train] epoch=002:  60%|██████    | 3/5 [00:21<00:10,  5.19s/batch, acc=0.5312, loss=0.9863][train] epoch=002:  80%|████████  | 4/5 [00:21<00:05,  5.36s/batch, acc=0.5312, loss=0.9863][train] epoch=002:  80%|████████  | 4/5 [00:24<00:05,  5.36s/batch, acc=0.5217, loss=0.9952][train] epoch=002 batch=5/5 loss=0.9952 acc=0.5217 rss_mb=1170.9 ru_maxrss_mb=1170.9 py_current_mb=104.2 py_peak_mb=201.8 torch_allocated_mb=118.9 torch_mps_driver_mb=4412.6
[train] epoch=002: 100%|██████████| 5/5 [00:24<00:00,  4.51s/batch, acc=0.5217, loss=0.9952]                                                                                            [val] epoch=002:   0%|          | 0/2 [00:00<?, ?batch/s][val] epoch=002:   0%|          | 0/2 [00:02<?, ?batch/s, acc=0.2812, loss=1.3748][val] epoch=002:  50%|█████     | 1/2 [00:02<00:02,  2.23s/batch, acc=0.2812, loss=1.3748][val] epoch=002:  50%|█████     | 1/2 [00:02<00:02,  2.23s/batch, acc=0.2933, loss=1.3717][val] epoch=002 batch=2/2 loss=1.3717 acc=0.2933 rss_mb=1200.8 ru_maxrss_mb=1200.8 py_current_mb=104.2 py_peak_mb=201.8 torch_allocated_mb=54.7 torch_mps_driver_mb=4412.6
                                                                                          epoch=002 train_loss=0.9952 train_acc=0.5217 val_loss=1.3717 val_acc=0.2933
[train] epoch=002 gaps acc=0.2283 loss=0.3765
[train] epoch=002 train_per_angle 0:0.340(141) 90:0.292(161) 180:0.623(146) 270:0.836(152)
[train] epoch=002 val_per_angle 0:0.000(37) 90:0.000(36) 180:1.000(39) 270:0.132(38)
[train] epoch=002 val_top_confusions 0->180:37, 90->180:35, 270->180:33, 90->270:1 avg_conf=0.2780 avg_entropy_nats=1.3833
[train] epoch=002 rss_mb=1200.8 ru_maxrss_mb=1200.8 py_current_mb=104.2 py_peak_mb=201.8 torch_allocated_mb=30.6 torch_mps_driver_mb=4412.6
best_val_accuracy=0.2933 checkpoint=/Users/helios/rotation-detection/runs/smoke_pagepool_1k/models/instrument_smoke.pt
[train] done memory rss_mb=1200.8 ru_maxrss_mb=1200.8 py_current_mb=104.2 py_peak_mb=201.8 torch_allocated_mb=30.6 torch_mps_driver_mb=4412.6
Training report: /Users/helios/rotation-detection/runs/smoke_pagepool_1k/models/instrument_smoke.report.json
[train] final memory rss_mb=1200.8 ru_maxrss_mb=1200.8 py_current_mb=104.1 py_peak_mb=201.8
